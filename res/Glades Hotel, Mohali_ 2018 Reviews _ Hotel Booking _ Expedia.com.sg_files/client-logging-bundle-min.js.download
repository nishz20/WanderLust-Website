// Version: Unknown
// Commit: Unknown
// Build date: 2018-09-27 13:12:31 UTC

/**
 * Client Logging
 *
 * Documentation available at http://go/fl0swg2n
 *
 * Settings (set them before loading the library):
 * - dctk.logging.pageStartTime (required)
 * - dctk.logging.pageName (required)
 * - dctk.logging.guid (required)
 * - dctk.logging.enabled
 * - dctk.logging.gcoAgent
 * - dctk.logging.agentLogonName
 * - dctk.logging.agentCallCenter
 * - dctk.logging.agentCountry
 * - dctk.logging.data
 *
 * TODO Include this documentation in the API Reference
 *
 * @preserve
 */
var dctk=window.dctk=window.dctk||{};dctk.logging=dctk.logging||{};var collectedErrors=window.collectedErrors;!function(){"use strict";if(dctk.logging._loaded||dctk._loggingLoaded)return void setTimeout(function(){throw new Error("Client Logging was attempted to be loaded twice")});dctk.logging._loaded=!0,function(){function n(n,e){var t=new XMLHttpRequest,o={method:"POST",headers:{"Content-type":"application/json"},body:e};return t.open(o.method,n,!0),t.setRequestHeader("Content-type","application/json"),t.send(JSON.stringify(o.body)),t}function e(n){var e={};for(var t in n)if(n.hasOwnProperty(t)){var o=n[t].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}var t;if(t=function(){var n=!1;return{hasEntry:function(){return Boolean(this.getEntryAsQueryStringParameter())},getEntryAsQueryStringParameter:function(){if(n||!dctk.ewePerformance)return"";var e=dctk.ewePerformance.getPageUsableTime();return e&&e.length?"pageUsableTime="+Math.round(e[0].startTime):""},markAsSent:function(){n=!0}}}(),null==dctk.logging.enabled&&(dctk.logging.enabled=!0),dctk.logging.enabled){var o,i=[],r=[{string:navigator.userAgent,subString:"Edge",identity:"Explorer",versionSearch:"Edge"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:navigator.userAgent,subString:"Firefox",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],a=[{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Kindle",identity:"Kindle"},{string:navigator.userAgent,subString:"BB10",identity:"Blackberry"},{string:navigator.userAgent,subString:"Touch",addlString:"MSIE 10",identity:"Surface"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];dctk.logging.setProduction=function(n){o=n},dctk.logging._isProduction=function(){return null!=o?o:dctk.logging._isAProductionDomain()};var g=["www.expedia.com","www.expedia.co.uk","www.expedia.ca","www.expedia.de","www.expedia.it","www.expedia.es","www.expedia.nl","www.expedia.mx","www.expedia.com.sg","www.expedia.com.my","www.expedia.co.kr","www.expedia.co.th","www.expedia.com.hk","www.expedia.fr","www.expedia.com.au","www.expedia.co.in","www.expedia.co.jp","www.expedia.co.nz","www.expedia.co.id","www.expedia.com.tw","www.expedia.ie","www.expedia.be","www.expedia.se","www.expedia.no","www.expedia.dk","www.expedia.com.ph","www.expedia.com.br","www.expedia.com.ar","www.expedia.com.vn","www.expedia.fi","www.expedia.at","expedia.viaggi.virgilio.it","expedia.viaggi.tiscali.it","expedia.corriere.it","expedia.viaggi.deejay.it","expedia.allmusic.tv","voyages.anyway.com","yahoo.expedia.com.au","ninemsn.expedia.com.au","jal.expedia.co.jp","msn.expedia.co.jp","expedia-aarp.com","voyage-sncf.com","expediafortd.com","vacation.hotwire.com","www.travelocity.com","www.travelocity.ca","xsell.expedia.com","www.airasiago.com.my","orbitz.com",/(^|\.)wotif\.(com|co\.nz)$/];dctk.logging._isAProductionDomain=function(n){n=n||{},n._domain=n._domain||k,n._productionDomains=n._productionDomains||g;for(var e=0;e<n._productionDomains.length;e++)if(n._domain.match(n._productionDomains[e]))return!0;return!1};var d=function(n){for(var e=0;e<n.length;e++){var t=n[e].string,o=n[e].prop;if(dctk.logging.versionSearchString=n[e].versionSearch||n[e].identity,t){if(-1!=t.indexOf(n[e].subString)&&(!n[e].addlString||-1!=t.indexOf(n[e].addlString)))return n[e].identity||"unknown"}else if(o)return n[e].identity||"unknown"}},c=function(n){var e=n.indexOf(dctk.logging.versionSearchString);if(-1!=e)return parseFloat(n.substring(e+dctk.logging.versionSearchString.length+1))},s=function(n){return n.toISOString?n.toISOString():n.getFullYear().toString()+"-"+n.getMonth()+"-"+n.getDate()+"T"+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()},l=function(n,e,t){n.attachEvent?(n["e"+e+t]=t,n[e+t]=function(){n["e"+e+t](window.event)},n.attachEvent("on"+e,n[e+t])):n.addEventListener(e,t,!1)},u=function(n){t.hasEntry()&&(n.push(t.getEntryAsQueryStringParameter()),t.markAsSent()),O("/cl/1x1.gif"+E+"&pageName="+dctk.logging.pageName+"&guid="+m()+"&logTime="+s(new Date)+"&sessionDuration="+encodeURIComponent(j())+"&action=logTrxEvent&"+(n||[]).join("&"))},m=function(){return dctk.logging.guid||"unknown"},w=function(){return dctk.logging.gcoAgent?"&gcoAgent=true&agentLogonName="+(dctk.logging.agentLogonName||"unknown")+"&agentCallCenter="+(dctk.logging.agentCallCenter||"unknown")+"&agentCountry="+(dctk.logging.agentCountry||"unknown"):null==dctk.logging.gcoAgent?"":"&gcoAgent=false"},p=function(n){return window.performance&&performance.timing&&performance.timing[n]||NaN},v=d(r),f=c(navigator.userAgent)||c(navigator.appVersion)||"an unknown version",k=window.location.hostname,S=d(a),y="";if(dctk.logging.data)for(var h=0,b=dctk.logging.data.split("|");h<b.length&&b[h].length>0;h++)y+="&"+b[h];var E="?browser="+v+"&browserVersion="+f+"&platform="+S+"&domain="+k+"&live="+dctk.logging._isProduction()+y+w(),x={browser:v,browserVersion:f,platform:S,domain:k,live:dctk.logging._isProduction(),dataParams:w()};"performance"in window?dctk.logging.pageStartTime=window.performance.timing.responseStart:dctk.logging.pageStartTime=dctk.logging.pageStartTime||(new Date).getTime();var T=function(n){"complete"==document.readyState?n():l(window,"load",n)},A=function(n){T(function(){n({unloadTime:p("unloadEventEnd")-p("unloadEventStart"),redirectTime:p("redirectEnd")-p("redirectStart"),dnsTime:p("domainLookupEnd")-p("domainLookupStart"),connectionTime:p("connectEnd")-p("connectStart"),requestTime:p("responseStart")-p("requestStart"),responseTime:p("responseEnd")-p("responseStart"),parsingTime:p("domInteractive")-p("domLoading"),domReadyCallbackTime:p("domContentLoadedEventEnd")-p("domContentLoadedEventStart"),onLdCallbackTime:p("loadEventEnd")-p("loadEventStart"),processingTime:p("domComplete")-p("domLoading"),navigationToResponse:p("responseStart")-p("navigationStart"),navigationToDomContentLoaded:p("domContentLoadedEventStart")-p("navigationStart"),navigationToOnLd:p("loadEventStart")-p("navigationStart"),fetchToResponse:p("responseStart")-p("fetchStart"),fetchToDomContentLoaded:p("domContentLoadedEventStart")-p("fetchStart"),fetchToOnLd:p("loadEventStart")-p("fetchStart"),responseToDomContentLoaded:p("domContentLoadedEventStart")-p("responseStart"),responseToOnLd:p("loadEventStart")-p("responseStart"),navigationToDomInteractive:p("domInteractive")-p("navigationStart")})})};dctk.logging.navTiming={},dctk.logging.browser=v,dctk.logging.version=f,dctk.logging.OS=S,dctk.logging.logTrxEvent=function(n,e){var t=[n+"_elapsedTime="+((new Date).getTime()-dctk.logging.pageStartTime)];e&&(t=t.concat(dctk.logging._normalizeMessageParams(e))),u(t)},dctk.logging.trxEventWrapper=function(n,e,t){return function(){var o=(new Date).getTime(),i=n.apply(t||dctk.logging,arguments),r=(new Date).getTime();return u([e+"_elapsedTime="+(r-dctk.logging.pageStartTime),"clEventName01="+e,"clEventTime01="+(r-o)]),i}};var C=function(){return"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon},P=function(e,t){return C()?navigator.sendBeacon(e,JSON.stringify(t)):n(e,t)},_=function(){return"undefined"!=typeof window&&"undefined"!=typeof location&&"localhost"===location.hostname}()?"https://collector.test.expedia.com/":"/",L=_+"cl/2x2.json";dctk.logging.logMessage=function(n,t){var o=dctk.logging._normalizeMessageParams(function(){var e={logTime:s(new Date),action:"logErrors",label:n,pageName:dctk.logging.pageName,pageUrl:window.location.href,guid:m(),clientWidth:document.documentElement.clientWidth};return e[n+"_elapsedTime"]=(new Date).getTime()-dctk.logging.pageStartTime,e}());o=o.concat(dctk.logging._normalizeMessageParams(t));var i=e(o);i.browser=x.browser,i.browserVersion=x.browserVersion,i.platform=x.platform,i.domain=x.domain,i.live=x.live,i.dataParams=x.dataParams;try{P(L,i),dctk.logging._beaconImages.push(i)}catch(n){D(n)}},dctk.logging.logError=function(n,e,t){var o=dctk.logging._normalizeMessageParams(e?R(e):{onError:"NA"});o=o.concat(dctk.logging._normalizeMessageParams(t)),dctk.logging.logMessage(n,o),D(n+"\n"+o.join("\n"))},dctk.logging.reset=function(){dctk.logging.pageStartTime=(new Date).getTime()},dctk.logging.subscribeToOnerrorCallback=function(n){i.push(n)},dctk.logging.publishOnerrorCallback=function(){for(var n=0;n<i.length;n++)"function"==typeof i[n]&&i[n]()},dctk.logging.setPageName=function(n){dctk.logging.pageName=n};var N=window.onerror,I={};dctk.logging._onerror=function(n,e,t,o,i){var r=i?R(i):{onErrorMsg:n};r.onErrorUrl=e,r.onErrorLine=t,r.onErrorChar=null==o?"NA":o,I[n]=(I[n]||0)+1;var a=100==I[n];a&&(r.exceedsErrorThreshold="true"),(1==I[n]||a)&&dctk.logging.logMessage("windowOnError",r),dctk.logging.publishOnerrorCallback()},window.onerror=function(){try{N&&N.apply(window,arguments)}finally{dctk.logging._onerror.apply(dctk.logging,arguments)}},dctk.loggingAdapter=dctk.logging,dctk.logging._normalizeMessageParams=function(n){if(!n)return[];if("string"==typeof n)return[n];if(!(n instanceof Array)){var e=[];for(var t in n)e.push(encodeURIComponent(t)+"="+encodeURIComponent(M(n[t])));n=e}return n};var M=function(n){return String(n).replace(/"/g,"＂")},D=function(n){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(n)};dctk.logging._beaconImages=[];var O=function(n){var e=new Image;e.src=n,dctk.logging._beaconImages.push(e)},R=function(n){return n=U(n),{onErrorMsg:n.message,onErrorUrl:n.sourceURL,onErrorLine:n.line,onErrorChar:n.col,stack:n.stack?n.stack.substr(0,200):"NA"}},U=function(n){var e,t="NA",o="NA",i="NA";try{n&&n.stack&&(e=n.stack.match(/\(([^\)]+\d+)\)/),e||(e=n.stack.match(/@([^\)]+\d+)\n/)),e&&(e=e[1].split(":"),t=e.pop(),o=e.pop(),i=e.join(":")))}catch(n){}return n&&(n={sourceURL:n.sourceURL||n.fileName||i,line:n.line||n.lineNumber||o,col:n.columnNumber||t,message:n.message,stack:n.stack||"NA"}),n},j=function(){var n,e,t,o,i,r,a;e=(new Date).getTime();try{if(!window.localStorage)return;t="dctk_clientLogging_firstInteractionTimestamp",o="dctk_clientLogging_lastInteractionTimestamp",i=Number(localStorage.getItem(o)),n=Number(localStorage.getItem(t)),r=e-i>18e5,a=0===n,(r||a)&&(n=e,localStorage.setItem(t,n)),i=e,localStorage.setItem(o,i)}catch(t){n=e}return e-n},z=function(n){var e=[];for(var t in n){var o=n[t];null==o||isNaN(o)||e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}return e.join("&")};!function(){A(function(n){dctk.logging.navTiming=n;var e=z(n);t.hasEntry()&&(e=[e,t.getEntryAsQueryStringParameter()].join("&"),t.markAsSent()),dctk.logging.logTrxEvent("navTiming",e)})}(),function(){setInterval(u([]),6e4)}()}}(),"function"==typeof define&&define.amd&&define("dctk/clientLogging",function(){return dctk.logging})}(),collectedErrors&&(collectedErrors.forEach(function(n){dctk.logging.logError(n)}),collectedErrors=null);
