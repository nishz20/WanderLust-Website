!function(a,b,c){"use strict";function d(a){this.element=a,this.classes=a.className.split(" ").filter(function(a){return""!==a})}function e(a,b){if(this.dateObj={},null!==a&&"undefined"!=typeof a)if(a instanceof Date)this.dateObj.month=a.getMonth()+1,this.dateObj.date=a.getDate(),this.dateObj.year=a.getFullYear();else if(a.length>0){var c=f(a);if(c.length>0){this.dateArr=a.split(c),this.formatArr=b.split(c);for(var d=0;d<this.formatArr.length;d++){var e=this.formatArr[d].toLowerCase();switch(e){case"m":case"M":case"mm":this.dateObj.month=this.dateArr[d];break;case"dd":case"d":this.dateObj.date=this.dateArr[d];break;case"yyyy":case"yy":this.dateObj.year=this.dateArr[d]}}}}}function f(a){for(var b=0;b<a.length;b++)if(a.charCodeAt(b)<48||a.charCodeAt(b)>57)return a[b];return""}function g(a){var b=[];if(null!==a&&a.length>0)for(var c=a[0],d=a[0],e=0;e++<a.length;){for(;d===a[e];)c+=a[e],e++;d=a[e],b.push(c),c="",c+=d}return b}var h=null;b.utils=b.utils||{},b.utils.emailRegex=/(?!\.)([a-zA-Z0-9\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\.!#$%&'*+-\/=?^_`{|}~\-\d]+)(?:@|%(?:25)*40)(?!\.)([a-zA-Z0-9\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\-\.\d]+)((\.([a-zA-Z\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF]){2,63})+)/i,b.utils.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},b.utils.isFunction=function(a){return"function"==typeof a},b.utils.isVisible=function(a){return null!==a&&b.utils.isParentVisible(a)},b.utils.isParentVisible=function(d){for(d!==c&&"function"==typeof d.getAttribute&&"true"===d.getAttribute("data-collapse-before-load")&&(d=d.parentNode);d!==c&&d.parentNode;){if(!b.utils.hasClass(d,"hidden-before-load")){if(a.getComputedStyle){var e=a.getComputedStyle(d,"");if("none"==e.display)return!1;if("hidden"==e.visibility)return!1}if(d.style){if("none"==d.style.display)return!1;if("hidden"==d.style.visibility)return!1}}if(d=d.parentNode,d==document)return!0}return!1},b.utils.hasClass=function(a,b){return a.className&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},b.utils.debounce=function(a,b,c){var d,e=function(b){a.apply(c,b)};return function(){var a=arguments;clearTimeout(d),d=setTimeout(e,b,a)}},b.utils.resize=function(a){try{var c=document.getElementById(a);if(b.utils.isLoaded(c)){var d=c.getElementsByTagName("iframe")[0],e=d.contentDocument||d.contentWindow.document,f="Height",g="scroll"+f,h="offset"+f,i=Math.max(e.body[g],e.documentElement[g],e.body[h],e.documentElement[h],e.documentElement["client"+f]);c.style.height=i+"px",d.style.height=i+"px"}}catch(j){b.logging.logError(j,["adAction=expads.utils.resize","id="+a])}},b.utils.isForceLoad=function(a){return null!==a&&"true"===a.getAttribute("data-force-load")},b.utils.toggleCollapsedExpanded=function(a,b){if(a&&a.className!==c){var d=a.className;d=d.replace(/(?:^|\s)expanded(?!\S)/g,""),d=d.replace(/(?:^|\s)collapsed(?!\S)/g,""),d+=b?" expanded":" collapsed",a.className=d}},b.utils.isLoaded=function(a){return null!==a&&"true"===a.getAttribute("data-loaded")};var i=function(){for(var a=3,b=document.createElement("div"),d=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",d[0];);return a>4?a:c}();b.utils.containsIgnoreCase=function(a,b){return a.reduce(function(a,c){return"string"==typeof c&&"string"==typeof b&&c.toLowerCase()===b.toLowerCase()?a+1:a},0)},b.utils.ajax=function(d){d=d||{},d.always=d.always||function(){},d.done=d.done||function(){},d.fail=d.fail||function(){},d.dataType=d.dataType||"",d.type=d.type||"GET",d.url=d.url||null,d.encode===c&&(d.encode=!0);var e;if(i<10&&a.XDomainRequest){var f=new XDomainRequest;d.encode?f.open(d.type,encodeURI(d.url)):f.open(d.type,d.url),d.timeout&&(f.timeout=d.timeout),f.onprogress=function(){},f.ontimeout=function(){},f.onload=function(){var a=f.responseText;if(d.dataType&&"json"===d.dataType.toLowerCase()&&"string"==typeof a)try{a=JSON.parse(a),d.done(a,f)}catch(c){b.logging.logError(c,["adAction=expads.utils.ajax"]),d.fail(f)}},f.onerror=function(){d.fail(f)},setTimeout(function(){f.send(d.data)},0)}else a.XMLHttpRequest&&(e=new XMLHttpRequest,e.onreadystatechange=function(){var a;4===e.readyState&&(200===e.status?(e.response?a=e.response:!e.responseType||""!==e.responseType&&"text"!==e.responseType||(a=e.responseText),d.dataType&&"json"===d.dataType.toLowerCase()&&"string"==typeof a&&(a=JSON.parse(a)),d.done(a,e)):d.fail(e),d.always(e,a))},d.encode?e.open(d.type,encodeURI(d.url)):e.open(d.type,d.url),d.contentType&&e.setRequestHeader("Content-Type",d.contentType),d.xhrFields&&d.xhrFields.withCredentials&&(e.withCredentials=!0),d.timeout&&(e.timeout=d.timeout),d.accept&&e.setRequestHeader("Accept",d.accept),e.responseType=d.dataType,e.send(d.data))},b.utils.isForceLoad=function(a){return null!==a&&"true"===a.getAttribute("data-force-load")},b.utils.formatDateToISOSpecification=function(a,b,c){return a+"-"+b+"-"+c},b.utils.logTimeTakenToCompleteAPICall=function(a,c,d){var e=c-a;b.logging.logMessage(d,["totalTime="+e])};var j=b.utils.isEmptyObject=function(a){var b;if(a)for(b in a)if(a.hasOwnProperty(b))return!1;return!0};b.utils.getCacheProofUrl=function(a){return a&&(a+=a.indexOf("?")>0?"&":"?",a=a+"uncacheParam="+Math.random()),a},b.utils.isLocalStorageAvailable=function(){if(null===h)try{a.localStorage.setItem("AdEng","is super cool");var b=a.localStorage.getItem("AdEng");a.localStorage.removeItem("AdEng"),h="is super cool"===b}catch(c){h=!1}return h},b.utils.mergeObjects=function(a,b){var c,d={},e=function(a){return JSON.parse(JSON.stringify(a))};if(a)for(c in a)a.hasOwnProperty(c)&&(d[c]=e(a[c]));if(b)for(c in b)b.hasOwnProperty(c)&&(d[c]=e(b[c]));return d},b.utils.resetLocalStorageAvailability=function(){h=null},b.utils.mergeTargetingAndUpdateLocalStorage=function(d){var e={};return b.mergedTargeting!==c&&(e=b.utils.mergeObjects(e,b.mergedTargeting)),e=b.utils.mergeObjects(e,b.targeting),"object"==typeof d&&(b.updatedTargeting=d,e=b.utils.mergeObjects(e,d)),b.utils.isLocalStorageAvailable()&&(a.localStorage.setItem("com.expedia.meso.targeting",JSON.stringify(e)),b.mergedTargeting=e),e},b.utils.isViewable=function(d,e){if("object"==typeof d&&null!==d){var f,g,h,i=d.getBoundingClientRect(),j=i.bottom-i.top,k=i.right-i.left,l=a.innerHeight||document.documentElement&&document.documentElement.clientHeight||0,m=a.innerWidth||document.documentElement&&document.documentElement.clientWidth||0,n=100,o=j*k,p=Math.min(i.bottom,l),q=Math.max(i.top,0),r=Math.min(i.right,m),s=Math.max(i.left,0);if(!(e&&b.configuration.refreshAdModel&&b.configuration.refreshAdModel.hasOwnProperty(e)&&b.configuration.refreshAdModel[e].minAdViewablePercentage!==c))return i.top+j<l&&i.bottom-j>0&&i.left+k<m&&i.right-k>0;if(0!==o&&(n=b.configuration.refreshAdModel[e].minAdViewablePercentage,f=Math.max(0,p-q),g=Math.max(0,r-s),h=f*g*100/o,h>=n))return!0}return!1},b.utils.isPartiallyViewable=function(b){if("object"==typeof b&&null!==b){var c=b.getBoundingClientRect(),d=a.innerHeight||document.documentElement&&document.documentElement.clientHeight||0,e=a.innerWidth||document.documentElement&&document.documentElement.clientWidth||0,f=Math.min(c.bottom,d),g=Math.max(c.top,0),h=Math.min(c.right,e),i=Math.max(c.left,0);return f-g>0&&h-i>0}return!1},b.utils.getDomain=function(a){var b=a.indexOf("://");return b!==-1&&(a=a.split("://")[1]),a=a.split("/")[0],b=a.indexOf("@"),b!==-1&&(a=a.split("@")[1]),b=a.indexOf("["),0===b&&a.indexOf("]")!==-1?a.substr(1,a.indexOf("]")-1):(b=a.indexOf(":"),b!==-1&&(a=a.split(":")[0]),a)},b.utils.sameDomain=function(a,d){return a!==c&&d!==c&&b.utils.getDomain(a)===b.utils.getDomain(d)},b.utils.containsEmail=function(a){if(b.utils.emailRegex.test(a)===!0)return!0;var c="";try{c=decodeURIComponent(a)}catch(d){}return b.utils.emailRegex.test(c)},b.utils.emailDetected=function(){return b.utils.containsEmail(b.utils.getRequestUrl())?(b.logging&&"function"==typeof b.logging.logMessage&&b.logging.logMessage("Suppressed expads initialization due to email address in url"),!0):!!b.utils.containsEmail(b.utils.getReferrerUrl())&&(b.logging&&"function"==typeof b.logging.logMessage&&b.logging.logMessage("Suppressed expads initialization due to email address in referrer"),!0)},b.utils.getRequestUrl=function(){return a.location.href},b.utils.getReferrerUrl=function(){return document.referrer||""},b.utils.onScroll=function(){if(b.configuration!==c&&b.configuration.refreshAdModel!==c){var a=b.configuration.refreshAdModel||{};for(var d in a)if(a.hasOwnProperty(d)){var e=a[d];e&&e.minTimeAwayFromPage&&e.minTimeAwayFromPage>0&&(e.experimentId?b.checkBucket(e.experimentId,b.ensureViewableAdsAreLoaded):b.ensureViewableAdsAreLoaded())}}},b.utils.defer=function(a,b){return function(){"function"==typeof a&&(b=b||0,setTimeout(a,b))}},b.utils.trim=function(a){return"function"!=typeof String.prototype.trim?a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):a.trim()},b.utils.parseQueryParams=function(a){if("string"!=typeof a)return b.logging.logError(new Error("Cannot parse query string: "+typeof a+", "+a)),{};if(a=b.utils.trim(a),!a)return{};a=a.replace(/^\?/,"").replace(/\+/g," ");var d,e={};d=a.split("&");for(var f=0;f<d.length;f++){var g=d[f].split("="),h=g.shift(),i=g.length>0?g.join("="):c;h!==c&&(h=b.utils.trim(decodeURIComponent(h))),i!==c&&(i=b.utils.trim(decodeURIComponent(i))),h&&(e.hasOwnProperty(h)&&i?b.utils.isArray(e[h])?e[h].indexOf(i)===-1&&e[h].push(i):e[h]!==i&&(e[h]=[e[h],i]):e[h]=!i||i)}return e},b.utils.performance={},b.utils.performance.mark=function(c){try{"undefined"!=typeof a.performance&&"function"==typeof a.performance.mark&&a.performance.mark(c)}catch(d){b.logging.logError(d,["adAction=expads.utils.performance.mark"])}},b.utils.performance.clearMarks=function(c){try{"undefined"!=typeof a.performance&&"function"==typeof a.performance.clearMarks&&a.performance.clearMarks(c)}catch(d){b.logging.logError(d,["adAction=expads.utils.performance.clearMarks"])}},b.utils.performance.clearAndMark=function(a){b.utils.performance.clearMarks(a),b.utils.performance.mark(a)},b.utils.performance.measure=function(c,d,e){try{"undefined"!=typeof a.performance&&"function"==typeof a.performance.measure&&a.performance.measure(c,d,e)}catch(f){b.logging.logError(f,["adAction=expads.utils.performance.measure"])}},b.utils.performance.clearMeasures=function(c){try{"undefined"!=typeof a.performance&&"function"==typeof a.performance.clearMeasures&&a.performance.clearMeasures(c)}catch(d){b.logging.logError(d,["adAction=expads.utils.performance.clearMeasures"])}},b.utils.performance.clearAndMeasure=function(a,c,d){b.utils.performance.clearMeasures(a),b.utils.performance.measure(a,c,d)},b.utils.performance.getEntriesByName=function(c,d){try{if("undefined"!=typeof a.performance&&"function"==typeof a.performance.getEntriesByName)return a.performance.getEntriesByName(c,d)}catch(e){b.logging.logError(e,["adAction=expads.utils.performance.getEntriesByName"])}return[]},b.utils.performance.getDuration=function(a){var c,d=b.utils.performance.getEntriesByName(a,"measure");return d&&d.length>0&&(c=d[0],c&&c.duration)?c.duration:null},b.utils.findTargetingDiffs=function(){var a,c,d,e,f=function(){var a,b,c,d=new Set;for(a=0;a<arguments.length;a++){b=arguments[a];for(c in b)b.hasOwnProperty(c)&&d.add(c)}return d},g=function(a,b,c,d){k.adUnits[a]=k.adUnits[a]||{},k.adUnits[a].targeting=k.adUnits[a].targeting||{},k.adUnits[a].targeting[b]=k.adUnits[a].targeting[b]||{},k.adUnits[a].targeting[b][c]=d},h=b.renderedAds,i=b.renderedAdsV2,j=f(h,i),k={};return k.adUnitsNotInV1=[],k.adUnitsNotInV2=[],k.adUnits={},j.forEach(function(f){if(h.hasOwnProperty(f))if(i.hasOwnProperty(f)){c=h[f],d=i[f].pageTargeting,e=b.targeting;for(a in e)e.hasOwnProperty(a)&&(c.hasOwnProperty(a)?d.hasOwnProperty(a)||g(f,"keyNotInV2",a,c[a]):g(f,"keyNotInV1",a,d[a]))}else k.adUnitsNotInV2.push(f);else k.adUnitsNotInV1.push(f)}),k};var k=b.utils.extractValue=function(a,b){for(var c=0,d=(b||[]).length;a&&c<d;)a=a[b[c]],c++;return a},l=Object.prototype.toString,m=function(a){return function(b){return l.call(b)===a}},n=(b.utils.isObject=m("[object Object]"),b.utils.isUndefined=m("[object Undefined]"),b.utils.isNull=m("[object Null]"),b.utils.isNumber=m("[object Number]"),b.utils.isString=m("[object String]"),b.utils.isFunction=m("[object Function]"));b.utils.isDuplicateAdCall=function(b){if("object"!=typeof b)return!1;var c,d={threshold:1},e=new Date,f=[],g=Object.keys(b),h=function(b){var c,d=[],e="";for(c=0;c<b.length;c++)if(b[c]&&"string"==typeof b[c]){d=b[c].split("/");break}for(c=3;c<d.length-1;c++)e+="/"+d[c];for(c=0;c<b.length;c++)b[c]&&"string"==typeof b[c]&&(b[c]=b[c].substr(b[c].lastIndexOf("/")+1));var f=new Error("Duplicate call for Display Ads Units "+b+" on pagepath="+e);n(k(a.dctk,["logging","logError"]))?a.dctk.logging.logError("expads",f):console.error(f)};if(j(b))return!1;for(var i,l=!1,m=0;m<g.length;m++)b[g[m]].hasOwnProperty("requestTime")?(c=b[g[m]].requestTime,i=b[g[m]].path,(e-c)/1e3<=d.threshold&&i&&(f.push(i),l=!0)):b[g[m]].requestTime=new Date;return l&&h(f),l},b.utils.toKeyPairParams=function(a){return"object"==typeof a?Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&"):void logError("fields must be JSON type.")},d.prototype.update=function(){this.element.className=this.classes.join(" ")},d.prototype.addClass=function(a){this.classes.indexOf(a)===-1&&(this.classes.push(a),this.update())},d.prototype.removeClass=function(a){this.classes=this.classes.filter(function(b){return b!==a}),this.update()},b.utils.ClassManager=d,e.prototype.formatDate=function(a){var b="";if(a.length>0&&null!==this.dateObj&&Object.keys(this.dateObj).length>0)for(var c=g(a),d=0;d<c.length;d++){var e=c[d].toLowerCase();switch(e){case"mm":this.dateObj.hasOwnProperty("month")&&(b+=1===this.dateObj.month.length?"0"+this.dateObj.month:this.dateObj.month);break;case"m":this.dateObj.hasOwnProperty("month")&&(b+=2===this.dateObj.month.length&&"1"!==this.dateObj.month[0]?this.dateObj.month[1]:this.dateObj.month);break;case"dd":this.dateObj.hasOwnProperty("date")&&1===this.dateObj.date.length&&(this.dateObj.date="0"+this.dateObj.date),b+=this.dateObj.date;break;case"d":this.dateObj.hasOwnProperty("date")&&2===this.dateObj.date.length&&(this.dateObj.date=this.dateObj.date[1]),b+=this.dateObj.date;break;case"yyyy":case"yy":this.dateObj.hasOwnProperty("year")&&(b+=this.dateObj.year);break;default:b+=e}}return b},b.utils.ParseDate=e,b.utils.isOverlappingLaterally=function(a,b){if(a instanceof Element&&b instanceof Element){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect();return c.left+c.width>=d.left&&c.left<=d.left+d.width}return!1},b.utils.getCompleteUrl=function(a,c){if(!c)return a;var d=b.utils.toKeyPairParams(c);if(d.length>0){var e=a+"?"+d;return e}return a},b.utils.getDeviceType=function(){var a=b.configuration.device||{};return a.deviceType||""},b.utils.fireImpressionBeacon=function(a){try{if(!a)throw new Error("The impression beacon url is invalid");(new Image).src=encodeURI(a)}catch(c){b.logging.logError(c,"Error firing impression beacon")}},b.utils.getCorrespondingExpwebEndpoint=function(){var a=location.hostname;if(a.indexOf("sandbox.dev.sb.karmalab.net")>=0||a.indexOf("test.expedia.com")>=0||a.indexOf("localhost")>=0){var b=/(www[a-z\-]*).*/g,c=b.exec(a)||[],d=c[1]||"wwwexpediacom",e="https://"+d+".trunk.sb.karmalab.net";return e}return""},b.utils.isProdEnvironment=function(){return"prod"===b.environment},b.utils.isLabEnvironment=function(){return!b.utils.isProdEnvironment()}}(window,window.expads=window.expads||{}),function(a,b){"use strict";var c=function(a){this.id=a,this.handlers=[]},d=function(b){a.events[b]=new c(b)};c.prototype.attachHandler=function(a){this.handlers.push(a)},c.prototype.fire=function(c){for(var d=0;d<this.handlers.length;d++)if("function"==typeof this.handlers[d])try{c!==b?this.handlers[d](c):this.handlers[d]()}catch(e){a.logging.logError(e,["adAction=ExpadsEvent.fire"])}},a.events=a.events||{},d("preInitialize"),d("postInitialize"),d("preRefresh"),d("postRefresh"),d("preEnsureVisibleAdsAreLoaded"),d("postEnsureVisibleAdsAreLoaded"),d("postSlotRenderEnded"),d("slotOnloadGoogleTagEvent"),d("postMarqueeCallSuccess"),d("postMarqueeImageLoaded"),d("postNativeAdsAreLoaded")}(window.expads=window.expads||{}),function(a,b,c){"use strict";b.external=b.external||{},b.external.addEventListener=function(a){b.events.slotOnloadGoogleTagEvent.attachHandler(a)}}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";function d(a,b,c){this.id=a,this.bucket=b,this.exposureLogged=c||!1}function e(){if(!o)try{k&&k.experiments&&(i(k.experiments),o=!0)}catch(a){b.logging.logError(a,["adAction=initializeExperimentsFromPageConfiguration"])}}function f(a){return j[a]}function g(a){return j.hasOwnProperty(a)}function h(){j={},o=!1}function i(a){if("object"==typeof a){var c,e,f;for(c in a)a.hasOwnProperty(c)&&(j.hasOwnProperty(c)&&b.logging.logError("Duplicate experiment merged into expads experiments"["experimentName="+c]),e=a[c],"object"==typeof e?(f=new d(e.id,e.bucket,e.exposureLogged),j[c]=f):b.logging.logMessage("experiment configuration not set up correctly",["configurationKey="+c]))}}var j={},k=b.configuration||{},l=k.tpid,m=k.eapid,n=k.guid,o=!1;d.prototype.bucketUser=function(d){var e=this;try{if(e.bucket!==c)"function"==typeof d&&d(e);else{var f={};f.id=e.id,f.eapid=m,f.tpid=l,f.guid=n,f.callback=function(a){e.bucket=a.value,"function"==typeof d&&d(e)},a.dctk&&a.dctk.evaluateExperiment(f)}}catch(g){b.logging.logError(g,["adAction=bucketUser","experimentId="+this.id])}},d.prototype.exposureLog=function(d){var e=this;if(e.exposureLogged===!1)try{"function"==typeof require&&require(["dctk/dctk"],function(f){if(a.dctk&&"function"==typeof a.dctk.evaluateExperimentAndLog){var g={};g.id=e.id,f.omtr&&f.omtr.pageName?g.pageName=f.omtr.pageName:b.adtoolkit&&b.adtoolkit.data&&b.adtoolkit.data.adcontext&&(g.pageName=b.adtoolkit.data.adcontext.pageName),g.eapid=m,g.tpid=l,g.guid=n,g.callback=function(a){a.error===c&&(e.exposureLogged=!0,e.bucket=e.bucket||a.value),"function"==typeof d&&d(e)},a.dctk.evaluateExperimentAndLog(g)}})}catch(f){b.logging.logError(f,["adAction=exposureLogUser","experimentId="+this.id])}else"function"==typeof d&&d(e)},b.events.preInitialize.attachHandler(function(){e()}),b.experiments=b.experiments||{},b.experiments.getExperimentByName=f,b.experiments.hasExperiment=g,b.experiments.addExperiments=i,b.experiments.initializeExperimentsFromPageConfiguration=e,b.experiments.clearExperiments=h}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";b.events.postInitialize.attachHandler(function(){if(b.configuration!==c&&b.configuration.refreshAdModel!==c){var d,e,f=b.configuration.refreshAdModel,g=function(a,d,e){e!==c&&"function"==typeof e&&(d?b.checkBucketAndExpose(d,function(b){b>0&&e(a)}):e(a))},h=function(a){return"object"==typeof a&&(a.maxRefreshCount===c||a.maxRefreshCount>0)},i=function(){for(var i in f)if(f.hasOwnProperty(i)){var k=f[i],l=k.minTimeAwayFromPage,m=k.minTimeBeforeRefresh,n=k.experimentId;if(h(k)&&a.isStaleModeEnabled!==!0){e=new Date;try{d&&e-d>=1e3*l&&(k.timeoutId!==c&&clearTimeout(k.timeoutId),l>0?0===m?g(i,n,b.refreshAdsOnFocus):k.timeoutId=j(i,n,b.refreshAdsOnFocus,1e3*m):m>0&&(k.timeoutId=j(i,n,b.refreshAdsOnFocus,1e3*m)))}catch(o){b.logging.logError(o,["adAction=initializeOnPageFocusRefresh"])}}}},j=function(a,b,c,d){return setTimeout(function(){g(a,b,c)},d)},k=function(){d=new Date;for(var a in f)if(f.hasOwnProperty(a)){var b=f[a].minTimeBeforeRefresh;b>0&&f[a].timeoutId!==c&&clearTimeout(f[a].timeoutId)}},l=function(){try{for(var a in f)if(f.hasOwnProperty(a)){var d=f[a].minTimeBeforeRefresh;f[a].experimentId;d>0&&(f[a].timeoutId!==c&&clearTimeout(f[a].timeoutId),f[a].timeoutId=j(a,f[a].experimentId,b.refreshAdsOnFocus,1e3*d))}}catch(e){b.logging.logError(e,["adAction=initializeOnPageLoadRefresh"])}};a.addEventListener?a.addEventListener("blur",k,!1):a.attachEvent&&a.attachEvent("onblur",k),a.addEventListener?a.addEventListener("focus",i,!1):a.attachEvent&&a.attachEvent("onfocus",i),a.addEventListener?a.addEventListener("load",l,!1):a.attachEvent&&a.attachEvent("onload",l)}})}(window,window.expads=window.expads||{}),function(a,b){"use strict";a.Logger=function(){},a.Logger.prototype.logMessage=function(a,b){},a.Logger.prototype.logError=function(a,b){},a.Logger.prototype.logTrxEvent=function(){},a.Logger.prototype.name=function(){},a.loggers=a.loggers||[],a.logging=a.logging||{},a.logging.registerLogger=function(b){a.loggers.push(b)},a.logging.logMessage=function(c,d){if(c!==b)for(var e=0;e<a.loggers.length;e++)a.loggers[e].logMessage(c,d)},a.logging.logError=function(c,d){if(c!==b)for(var e=0;e<a.loggers.length;e++)a.loggers[e].logError(c,d)},a.logging.logTrxEvent=function(c,d){if(c!==b)for(var e=0;e<a.loggers.length;e++){var f=a.loggers[e];f.hasOwnProperty("logTrxEvent")&&"function"==typeof f.logTrxEvent&&f.logTrxEvent(c,d)}},a.logging.AdSlotPropertiesMismatchException=function(a,b,c){this.title="Ad Slot Properties Mismatch Exception",this.propertyName=a,this.requestedValue=b,this.returnedValue=c,this.message="Requested Ad Slot and Returned Ad Slot properties mismatch.",this.toString=function(){return this.title+": "+this.message+" (requestedAdSlot."+this.propertyName+"="+this.requestedValue+", returnedAdSlot."+this.propertyName+"="+this.returnedValue+")"}}}(window.expads=window.expads||{}),function(a,b,c){"use strict";if(a!==c){var d=new b.Logger;d.name=function(){return"Console logger"},d.logMessage=function(b,d){d!==c?a.log(b,d):a.log(b)},d.logError=function(b,d){d!==c?a.error(b,d):a.error(b)},b.logging.registerLogger(d)}}(window.console,window.expads=window.expads||{}),function(a,b,c,d){"use strict";b.configuration=b.configuration||{};var e="expads",f=!1,g=!1,h=[],i=[],j=[],k=function(){return"dctk logger"},l=function(a){var b=Math.floor(Math.random()*Math.pow(10,13));return a+=a.indexOf("?")>-1?"&_="+b:"?_="+b},m=function(){if(f){var a;for(a=0;a<h.length;a++)q(h[a].message,h[a].additionalParams);for(h=[],a=0;a<i.length;a++)p(i[a].error,i[a].additionalParams);for(i=[],a=0;a<j.length;a++)r(j[a].message,j[a].additionalParams);j=[]}},n=function(){if(b.configuration.forceDctkLoggingOn===!0||a.location.search.indexOf("adsClientLoggingEnabled=true")!==-1)return!0;if(b.configuration.loggingEnabled===!1)return!1;var c=5,d=1,e=Math.floor(Math.random()*(c-d+1))+d;return e===d},o=function(){if(c.logging!==d&&"function"==typeof c.logging.logMessage&&"function"==typeof c.logging.logError)f=!0,m();else if(b.configuration.dctkClientLoggingURL!==d&&b.configuration.dctkClientLoggingURL.length>0){g=!0;try{b.utils.ajax({url:l(b.configuration.dctkClientLoggingURL),done:t,fail:s,dataType:"text"})}catch(a){g=!1,b.logging.logError(a,["adAction=loadDctkIfNotAlreadyLoaded","dctkClientLoggingURL="+b.configuration.dctkClientLoggingURL])}}},p=function(a,b){if(f){var d=c.logging.pageName;c.logging.pageName+="_ads";try{c.logging.logError(e,a,b)}finally{c.logging.pageName=d}}else g&&i.push({error:a,additionalParams:b})},q=function(a,b){var d,i=["message="+a];for(d in b)b.hasOwnProperty(d)&&i.push(b[d]);if(f){var j=c.logging.pageName;c.logging.pageName+="_ads";try{c.logging.logMessage(e,i)}finally{c.logging.pageName=j}}else g&&h.push({message:a,additionalParams:b})},r=function(a,b){if(f){var d=c.logging.pageName;c.logging.pageName+="_ads";try{c.logging.logTrxEvent(e,b)}finally{c.logging.pageName=d}}else g&&j.push({message:a,additionalParams:b})},s=function(){g=!1,b.logging.logMessage("Failed to load the remote DCTK file",["dctkClientLoggingURL="+b.configuration.dctkClientLoggingURL])},t=function(c){g=!1,u(),a.dctk!==d&&a.dctk.logging!==d||(a.dctk=a.dctk||{},a.dctk.logging={pageStartTime:(new Date).getTime(),pageName:b.configuration.pageName,guid:b.configuration.guid},a.eval(c),u()),m()},u=function(){a.dctk!==d&&a.dctk.logging!==d&&"function"==typeof a.dctk.logging.logMessage&&"function"==typeof a.dctk.logging.logError&&(c=a.dctk,f=!0)};if(n()){b.events.preInitialize.attachHandler(o);var v=new b.Logger;v.logMessage=q,v.logError=p,v.logTrxEvent=r,v.name=k,b.logging.registerLogger(v)}}(window,window.expads=window.expads||{},window.dctk||{}),function(a,b,c){"use strict";var d=function(b){function c(c){var d="kx"+b+"_"+c,e=function(){try{return a.localStorage}catch(b){return null}}();if(e)return e[d]||"";if(navigator.cookieEnabled){var f=document.cookie.match(d+"=([^;]*)");return f&&unescape(f[1])||""}return""}return a.Krux||(a.Krux=function(){Krux.q=[],Krux.q.push(arguments)}),Krux.user=c("user"),Krux.segments=c("segs")?c("segs").split(","):[],Krux};a.expads=a.expads||{},a.expads.krux=a.expads.krux||{},a.expads.krux.getKrux=d}(window,window.expads=window.expads||{}),function(a,b){"use strict";a.extensions=a.extensions||{},a.callbacks=a.callbacks||{}}(window.expads=window.expads||{}),function(a,b){"use strict";var c="TOP-CENTER",d="TOP-RIGHT",e="CENTER-LEFT",f="CENTER-CENTER",g="CENTER-RIGHT",h="BOTTOM-LEFT",i="BOTTOM-CENTER",j="BOTTOM-RIGHT",k=function(b,k){var l=k.getElementById(b.priceContainer);if(b.eventData.priceAvailable===!0){var m=b.availableMessage+b.eventData.currencyType+b.eventData.price;l.appendChild(k.createTextNode(m))}else l.appendChild(k.createTextNode(b.unavailableMessage));var n=b.adWidth,o=b.adHeight,p=l.offsetWidth,q=l.offsetHeight,r=0,s=0;p<=n&&q<=o?(b.position===c?r=(n-p)/2:b.position===d?r=n-p:b.position===e?s=(o-q)/2:b.position===f?(r=(n-p)/2,s=(o-q)/2):b.position===g?(r=n-p,s=(o-q)/2):b.position===h?s=o-q:b.position===i?(r=(n-p)/2,s=o-q):b.position===j?(r=n-p,s=o-q):(r=0,s=0),l.style.marginLeft=r,l.style.marginTop=s,l.style.visibility="visible"):a.logging.logError("The dynamic price container width/height is greater than the ad unit size.")},l=function(a,b){b.getElementsByTagName("iframe")[0].contentWindow.postMessage(a.eventData,"*")};a.callbacks.dynamicPricing=a.callbacks.dynamicPricing||{},a.callbacks.dynamicPricing.dfpCallback=k,a.callbacks.dynamicPricing.sizmekCallback=l}(window.expads=window.expads||{}),function(a,b,c){"use strict";b.events.preInitialize.attachHandler(function(){b.mergedTargeting=b.utils.isLocalStorageAvailable()?JSON.parse(a.localStorage.getItem("com.expedia.meso.targeting")):{}})}(window,window.expads=window.expads||{}),function(a,b){"use strict";var c="-",d=function(b,d,e,f,g){if(""===b||""===d||""===f||""===g)return a.logging.logError("Error: Flight search API cannot be queried if airline code, start date, departure airport or arrival airport are missing."),null;var h=a.utils.formatDateToISOSpecification(d.split(c)[2],d.split(c)[0],d.split(c)[1]),i="PRICE",j="1",k="/api/flight/search?",l="departureAirport="+encodeURIComponent(f.trim())+"&arrivalAirport="+encodeURIComponent(g.trim())+"&departureDate="+encodeURIComponent(h.trim())+"&airlinePreference="+encodeURIComponent(b.trim())+"&sortType="+encodeURIComponent(i.trim())+"&maxOfferCount="+encodeURIComponent(j.trim());if(""!==e){var m=a.utils.formatDateToISOSpecification(e.split(c)[2],e.split(c)[0],e.split(c)[1]);l+="&returnDate="+encodeURIComponent(m.trim())}return k+l},e=function(){a.logging.logError("Error: Flight search API call to fetch the dynamic pricing data failed.")},f=function(a,c,d){var f=JSON.parse(a),g=f.offers,h=f.searchCities;if(g!==b){if(0===g.length)d.eventData.priceAvailable=!1;else{for(var i in h)h.hasOwnProperty(i)&&(d.departureAirport===h[i].code&&(d.eventData.departureCity=h[i].city),d.arrivalAirport===h[i].code&&(d.eventData.arrivalCity=h[i].city));d.eventData.priceAvailable=!0,d.eventData.price=g[0].totalFarePrice.formattedPrice,d.eventData.currencyType=""}d.dynamicPricingDisplayCallback(d,c)}else e()},g=function(b,c,d){var g=(new Date).getTime(),h="Flight Search API call took ";a.utils.ajax({url:b,done:function(b){return a.utils.logTimeTakenToCompleteAPICall(g,(new Date).getTime(),h),f(b,c,d)},fail:function(){return a.utils.logTimeTakenToCompleteAPICall(g,(new Date).getTime(),h),e()}})},h=function(b,c){try{var e=d(c.queryParams.airlineCode,c.queryParams.startDate,c.queryParams.endDate,c.queryParams.departureAirport,c.queryParams.arrivalAirport);null!==e&&g(e,b,c.displayParams)}catch(f){a.logging.logError("Extension: AirlinesDynamicPriceExtension, "+f)}};a.extensions.airlinesDynamicPricing=a.extensions.airlinesDynamicPricing||{},a.extensions.airlinesDynamicPricing.retrieveAndDisplayPrice=h}(window.expads=window.expads||{}),function(a,b){"use strict";var c="-",d="/m/api/hotel/info",e="/ads/priceHotel",f="/m/api/hotel/search",g=function(b,d,e,g){if(""===e||""===g||""===b||""===d)return a.logging.logError("Error: Hotel search API cannot be queried if brand id, destination, start date or end date are missing."),null;var h=a.utils.formatDateToISOSpecification(e.split(c)[2],e.split(c)[0],e.split(c)[1]),i=a.utils.formatDateToISOSpecification(g.split(c)[2],g.split(c)[0],g.split(c)[1]),j="1",k="BASE_PRICE_ONLY",l="-1",m=f+"?",n="city="+encodeURIComponent(d.trim())+"&brandNameId="+encodeURIComponent(b.toString().trim())+"&priceType="+encodeURIComponent(k.trim())+"&checkInDate="+encodeURIComponent(h.trim())+"&checkOutDate="+encodeURIComponent(i.trim())+"&room="+encodeURIComponent(j.trim())+"&resultsPerPage="+encodeURIComponent(l.trim());
return m+n},h=function(b,d,f){if(""===b)return a.logging.logError("Error: Hotel search API cannot be queried if hotelId is missing."),null;var g=""===d?"":a.utils.formatDateToISOSpecification(d.split(c)[2],d.split(c)[0],d.split(c)[1]),h=""===f?"":a.utils.formatDateToISOSpecification(f.split(c)[2],f.split(c)[0],f.split(c)[1]),i=e+"?",j="hotelId="+encodeURIComponent(b)+(""===g?"":"&start="+encodeURIComponent(g.trim()))+(""===h?"":"&end="+encodeURIComponent(h.trim()));return i+j},i=function(){a.logging.logError("Error: Hotel search API call to fetch the dynamic pricing data failed.")},j=function(c,d,e){var f=JSON.parse(c),g=f.hotelList;if(g!==b&&g.length>0){var h=g[0].rateCurrencySymbol,j=[];for(var k in g)g.hasOwnProperty(k)&&g[k].isHotelAvailable===!0&&j.push(parseInt(g[k].lowRateInfo.priceToShowUsers));j.length>0?(j.sort(function(a,b){return a-b}),e.eventData.price=j[0],e.eventData.currencyType=h,e.eventData.priceAvailable=!0):e.eventData.priceAvailable=!1,e.dynamicPricingDisplayCallback(e,d)}else{var l=f.errors;if(l!==b&&l.length>0){var m="Error: Hotel search API call to fetch the dynamic pricing data returned with the following error(s):\n";for(var n in l)if(l.hasOwnProperty(n)){var o=l[n].errorInfo.field,p="Summary: "+l[n].errorInfo.summary;m+=o!==b?p+", Field: "+o+"\n":p+"\n"}a.logging.logError(m)}else i()}},k=function(a,b,c){var d=JSON.parse(a);d&&d.price&&d.currencySymbol?(c.eventData.price=d.price,c.eventData.currencyType=d.currencySymbol,c.eventData.priceAvailable=!0):c.eventData.priceAvailable=!1,c.dynamicPricingDisplayCallback(c,b)},l=function(b,c,d,e){var f=(new Date).getTime(),g="Hotel Search API call took ";a.utils.ajax({url:b,done:function(b){return a.utils.logTimeTakenToCompleteAPICall(f,(new Date).getTime(),g),e?j(b,c,d):k(b,c,d)},fail:function(){return a.utils.logTimeTakenToCompleteAPICall(f,(new Date).getTime(),g),i()}})},m=function(b,c){try{var d=h(c.queryParams.hotelId,c.queryParams.startDate,c.queryParams.endDate);null!==d&&l(d,b,c.displayParams,!1)}catch(e){a.logging.logError("Extension: HotelsDynamicPriceExtension, Type: By Hotel ID, "+e)}},n=function(b,c){try{var d=g(c.queryParams.brandId,c.queryParams.destinationCode,c.queryParams.startDate,c.queryParams.endDate);null!==d&&l(d,b,c.displayParams,!0)}catch(e){a.logging.logError("Extension: HotelsDynamicPriceExtension, Type: By Brand, "+e)}},o={_buildUrl:function(a,b){return a+this._buildQuery(b)},_buildQuery:function(a){for(var b="?",c=[],d=Object.keys(a),e=0,f=d.length;e<f;e++)c.push(d[e]+"="+encodeURIComponent(a[d[e]]));return b+c.join("&")},get:function(b,c,e){var f=this._buildUrl(d,b.requestParams),g=b.apiName+" call took ",h=(new Date).getTime();a.utils.ajax({url:f,dataType:"json",done:function(b){a.utils.logTimeTakenToCompleteAPICall(h,(new Date).getTime(),g),b&&b.percentRecommended?c(b.percentRecommended):e(b)},fail:function(b){a.utils.logTimeTakenToCompleteAPICall(h,(new Date).getTime(),g),p(),p!==e&&e(b)}})}},p=function(){a.logging.logError("Error: Hotel Info API call to fetch the dynamic review data failed.")},q=function(b,c){try{c.apiName=c.apiName||"Hotel Info API",o.get(c,c.displayCallback,c.errorCallback||p)}catch(d){a.logging.logError("Extension: HotelsDynamicReviewExtension  "+d)}};a.extensions.hotelsDynamicPricing=a.extensions.hotelsDynamicPricing||{},a.extensions.hotelsDynamicReview=a.extensions.hotelsDynamicReview||{},a.extensions.hotelsDynamicPricing.retrieveAndDisplayPriceById=m,a.extensions.hotelsDynamicPricing.retrieveAndDisplayPriceByBrand=n,a.extensions.hotelsDynamicReview.fetch=q}(window.expads=window.expads||{}),function(a,b,c,d){"use strict";var e,f,g,h,i=function(b,c,i,j){var k=c.offset().top+c.height(),l=i.offset().top,m=b.height(),n=b.parent(),o=$(a).scrollTop();if(o>k){var p=o+m;if(p<=l)e===d&&(e=b.css("marginLeft"),f=b.css("marginRight")),b.css({position:"fixed",top:"0px","margin-top":"0px","margin-left":e,"margin-right":f});else{var q;j?(g===d&&(g=parseFloat(n.css("padding-top"))+parseFloat(n.css("padding-bottom"))),h===d&&(h=n.offset().top),q=(l-h-g-m).toString()+"px"):q=(l-k-m).toString()+"px",b.css({position:"relative",top:"auto","margin-top":q,"margin-left":e,"margin-right":f})}}else b.css({position:"relative",top:"auto","margin-top":"0px","margin-left":e,"margin-right":f})};c.extensions.clingyAds={init:function(b,d,e,f,g){require(["uitk","jquery"],function(d,h){var j=h(b),k=h(e),l=h(f),m=j.siblings("div").last();k.length<=0&&(k=m),j.length>0&&k.length>0&&l.length>0?(d.subscribe("debounced.resize",function(){i(j,k,l,g)}),h(a).scroll(d.utils.throttle(function(){i(j,k,l,g)},150)),i(j,k,l,g)):c.logging.logMessage("Element reference parameters in expads.extensions.clingyAds.init could not be resolved.")})}}}(window,document,window.expads=window.expads||{}),function(a,b){"use strict";function c(b,c){this.startTime=(new Date).getTime(),this.type=b,this.requested={},this.recorded=!1,this.recordingTimeout=null;var d;for(d in c)c.hasOwnProperty(d)&&(this.requested[c[d]]={loaded:!1});a.analytics.adCalls.push(this)}var d=1e3;c.prototype.slotLoadedCallback=function(a,b){if(a&&a.slot&&"function"==typeof a.slot.getSlotId&&"function"==typeof a.slot.getSlotId().getDomId){var c=a.slot.getSlotId().getDomId(),e=this.requested[c];e&&!e.loaded&&(e.loaded=!0,e.isEmpty=a.isEmpty,e.creativeId=a.creativeId,e.lineItemId=a.lineItemId,e.adUnitPath=a.slot.getAdUnitPath(),e.timeLoaded=(new Date).getTime(),e.loadTime=this.getLoadTime(c),!this.recorded&&b&&(clearTimeout(this.recordingTimeout),this.numAdsOutstanding()>0?this.recordingTimeout=setTimeout(this.record,d):this.record()))}},c.prototype.getLoadTime=function(a){if(this.requested[a])return this.requested[a].timeLoaded-this.startTime},c.prototype.numAdsOutstanding=function(){return this.numAdsRequested()-this.numAdsLoaded()},c.prototype.numAdsLoaded=function(){var a,b,c=0;for(a in this.requested)this.requested.hasOwnProperty(a)&&(b=this.requested[a],b.loaded&&c++);return c},c.prototype.numAdsRequested=function(){var a,b=0;for(a in this.requested)this.requested.hasOwnProperty(a)&&b++;return b},c.prototype.averageLatencyPerAd=function(){var a,b,c=0,d=0;for(a in this.requested)this.requested.hasOwnProperty(a)&&(b=this.requested[a],b.loaded&&(d++,c+=b.loadTime));return 0===d?null:c/d},c.prototype.averageNavStartToSlotRenderEnded=function(){if(f()){var a,b,c=0,d=0;for(a in this.requested)this.requested.hasOwnProperty(a)&&(b=this.requested[a],b.loaded&&(d++,c+=b.timeLoaded-window.performance.timing.navigationStart));return 0===d?null:c/d}return null},c.prototype.record=function(){this.recorded===!1&&(this.logAdCall(),this.recorded=!0)},c.prototype.logAdCall=function(){var c,d=[],g=a.analytics.expadsReady,h=a.analytics.googleTagReady,i=a.analytics.adsRequested,j=a.analytics.simplifiedAdsRequested,k=a.analytics.simplifiedAdsReturned,l=e(this.requested);d.push("numberOfAdsRequested="+encodeURIComponent(this.numAdsRequested())),d.push("numberOfAdsReturned="+encodeURIComponent(this.numAdsLoaded())),d.push("averageLatencyPerAd="+encodeURIComponent(this.averageLatencyPerAd())),d.push("adCallNumber="+encodeURIComponent(a.analytics.adCalls.indexOf(this)+1)),b!==g&&f()&&(d.push("navStartToExpadsReady="+encodeURIComponent(g-window.performance.timing.navigationStart)),b!==h&&d.push("expadsReadyToGoogleTagReady="+encodeURIComponent(h-g))),b!==h&&f()&&(d.push("navStartToGoogleTagReady="+encodeURIComponent(h-window.performance.timing.navigationStart)),b!==g&&d.push("googleTagReadyToExpadsReady="+encodeURIComponent(g-h))),b!==i&&(b!==h&&d.push("googleTagReadyToAdsRequested="+encodeURIComponent(i-h)),b!==g&&d.push("expadsReadyToAdsRequested="+encodeURIComponent(i-g)),f()&&d.push("navStartToAdsRequested="+encodeURIComponent(i-window.performance.timing.navigationStart))),b!==l&&b!==i&&d.push("adsRequestedToAdsRendered="+encodeURIComponent(l-i)),c=this.averageNavStartToSlotRenderEnded(),b!==c&&null!==c&&d.push("averageNavStartToSlotRenderEnded="+encodeURIComponent(c)),b!==j&&(f()&&d.push("navStartToMarqueeRequested="+encodeURIComponent(j-window.performance.timing.navigationStart)),b!==g&&d.push("expadsReadyToMarqueeRequested="+encodeURIComponent(j-g))),b!==k&&(f()&&d.push("navStartToMarqueeReturned="+encodeURIComponent(k-window.performance.timing.navigationStart)),b!==j&&d.push("marqueeRequestedToMarqueeReturned="+encodeURIComponent(k-j))),a.logging.logTrxEvent((new Date).getTime()-this.startTime,d)};var e=function(a){var c,d,e;for(d in a)a.hasOwnProperty(d)&&(c=a[d],c.loaded&&(e===b||c.timeLoaded>e)&&(e=c.timeLoaded));return e},f=function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart};a.analytics=a.analytics||{},a.analytics.AdCall=c,a.analytics.adCalls=a.analytics.adCalls||[]}(window.expads=window.expads||{}),function(a,b){"use strict";function c(b){var c;for(this.startTime=(new Date).getTime(),this.recorded=!1,this.renderedAds=[],this.requestedAds=[],c=0;c<b.length;c++)this.requestedAds.push(b[c]);a.analytics.displayAdCalls.push(this)}c.prototype.recordRenderedAd=function(a){var b;b=d(a),this.renderedAds.push(b)},c.prototype.processAdMetrics=function(b,c,d){try{var f,g=this;for(f=0;f<this.renderedAds.length;f++)this.renderedAds[f].path===b&&(this.renderedAds[f].cmc=c,this.renderedAds[f].timeToLoadCreative=d,this.renderedAds[f].loaded=!0);"function"==typeof window.define&&window.define.amd&&"function"==typeof window.require?require("adtoolkit/experiments",function(a){var b=a.getExperimentByName("EnableAdsPerfDataCollection");b&&b.bucket&&1===b.bucket&&e(g)}):window.location.href.indexOf("hotels.com")>-1&&e(g)}catch(h){a.logging.logError(h,["adAction=displayAdCall.processAdMetrics"])}},c.prototype.numAdsOutstanding=function(){return this.numAdsRequested()-this.numAdsLoaded()},c.prototype.numAdsLoaded=function(){var a,b=0;for(a=0;a<this.renderedAds.length;a++)this.renderedAds[a].loaded===!0&&b++;return b},c.prototype.numAdsRequested=function(){var a,b=0;for(a in this.requestedAds)this.requestedAds.hasOwnProperty(a)&&b++;return b};var d=function(b){var c,d,e,f={};try{a.utils.performance.clearAndMark("expedia.displayads.ensurevisibleadsareloaded.end"),d=function(b){var c,d,e,f={};if(a.utils.isFunction(b.getTargetingKeys)&&a.utils.isFunction(b.getTargeting))for(c=b.getTargetingKeys(),e=0;e<c.length;e++)d=c[e],f[d]=b.getTargeting(d);return f},f.containerID=b.getSlotId().getDomId(),c=document.getElementById(f.containerID),c&&(f.googleQueryID=c.dataset.googleQueryId),f.path=b.getAdUnitPath(),f.responseInformation=b.getResponseInformation(),f.slotTargeting=d(b),f.pageTargeting=d(googletag.pubads()),a.utils.performance.clearAndMeasure("Time to load ad","expedia.displayads.ensurevisibleadsareloaded.start","expedia.displayads.ensurevisibleadsareloaded.end"),f.timeToLoad=a.utils.performance.getDuration("Time to load ad"),e=new Date,f.timeLoaded=e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate(),f.deviceType=a.utils.getDeviceType()}catch(g){a.logging.logError(g,["adAction=createRenderedAdFromGPTSlot"])}return f},e=function(b){try{if(!b.recorded&&0===b.numAdsOutstanding()){var c=JSON.stringify(b.renderedAds);c&&a.utils.ajax({type:"POST",url:a.configuration.collectorWebURL,contentType:"application/json",data:c,fail:function(){a.logging.logError("Failed to post ad call metrics data to collector web",["adAction=postToCollectorWeb"])}}),b.recorded=!0}}catch(d){a.logging.logError(d,["adAction=record"])}};a.analytics=a.analytics||{},a.analytics.DisplayAdCall=c,a.analytics.displayAdCalls=a.analytics.displayAdCalls||[]}(window.expads=window.expads||{}),function(a,b){"use strict";function c(a,b,c,d){this.path=a,this.width=b,this.height=c,this.id=d,this.adCalls=[]}a.analytics=a.analytics||{},a.analytics.DisplayAdSlot=c}(window.expads=window.expads||{}),function(a,b){"use strict";var c=function(c){var d=c.adconfig||{},e=c.onerror,f=new Date,g=c.onload,h=c.name,i=function(){var b,e,i="function"==typeof g&&g();if(void 0!==h&&c.document.body.innerHTML.length>0){e={},e.name=h.replace(/^google_ads_iframe_/,"").replace(/_\d+$/,""),e.requestTime=f;for(var j in d)d.hasOwnProperty(j)&&(e[j]=d[j]);var k,l;if(c&&c.performance&&"function"==typeof c.performance.getEntriesByType){k=c.performance.getEntriesByType("resource"),e.resourceList=k;for(var m=0;m<k.length;m++)"img"==k[m].initiatorType&&(l=k[m].responseEnd-k[m].startTime,(void 0===b||l>b)&&(b=k[m].responseEnd-k[m].startTime))}else b=(new Date).getTime()-f.getTime();e.elapsedTime=b,a.expads.renderedAds[e.name]=e}return i},j=function(c,f,g){var i=a.expads.renderedAds[h]||{},j=[];return i.errorMsg=c,i.errorLine=g,i.errorUrl=f,i.error=!0,a.expads.renderedAds[h]=i,j.push("onErrorMsg="+encodeURIComponent(c)),j.push("onErrorUrl="+encodeURIComponent(f)),j.push("orderId="+encodeURIComponent(d.orderId||"")),j.push("lineItemId="+encodeURIComponent(d.lineItemId||"")),j.push("creativeId="+encodeURIComponent(d.creativeId||"")),j.push("adUnitId="+encodeURIComponent(d.adUnitId||"")),j.push("onErrorLine="+encodeURIComponent(g)),b.logging.logMessage("ExpAds",j),"function"==typeof e&&e(c,f,g),!1};c.onerror=j,c.onload=i};b.analytics=b.analytics||{},b.analytics.creativeWindowCallback=c}(window,window.expads=window.expads||{}),function(a){"use strict";function b(a,b){"string"==typeof a&&(f[a]=f[a]||[],f[a].push(b))}function c(a){if(a&&"object"==typeof a.data&&a.data.hasOwnProperty("type")){var b=f[a.data.type]||[];b.map(function(b){"function"==typeof b.postMessage&&b.postMessage(a.data)})}}function d(){this.events={},this.constraints=[]}function e(a){var b=a.split(/\//);return b[b.length-1]}var f={};d.prototype.registerAdUnit=function(b,c){void 0!==b&&"function"==typeof c?this.events[b]=c:a.logging.logMessage("Unable to register adunit on event handler")},d.prototype.registerConstraint=function(b){"function"==typeof b?this.constraints.push(b):a.logging.logError(new Error("Constraint is not a function, cannot register"),["adAction=expads.postMessage.EventHandler.registerConstraint"])},d.prototype.handleEvent=function(a,b){var c,d;if(a&&a.hasOwnProperty("adUnit")&&(d=e(a.adUnit),this.events.hasOwnProperty(d)&&"function"==typeof this.events[d])){for(c in this.constraints)if(this.constraints.hasOwnProperty(c)&&!this.constraints[c](a))return;this.events[d](a),"function"==typeof b&&b(a)}},window.addEventListener("message",c),a.postMessage=a.postMessage||{},a.postMessage.AdUnitEventHandler=d,a.postMessage.registerPostMessageGroup=b}(window.expads=window.expads||{}),function(a){"use strict";function b(b,c,d,e){this.element=c,this.conditions=d,this.containerElement=e,this.elementClassManager=c?new a.utils.ClassManager(c):null,this.containerClassManager=e?new a.utils.ClassManager(e):null,this.event=new a.postMessage.AdUnitEventHandler,this.container={},this.container.adData=this.container.adData||[],this.displayed=!1,this.postUpdate=[],this.preUpdate=[],a.postMessage.registerPostMessageGroup(b,this)}b.prototype.registerAdUnit=function(a,b){this.event.registerAdUnit(a,b)},b.prototype.postMessage=function(a){var b=this;this.event.handleEvent(a,function(a){b.isVisible()&&b.update(a)})};var c=function(a){a(this.container.adData,this.displayed)};b.prototype.update=function(b){b&&Object.keys(b).length>0&&this.container.adData.push(b),this.preUpdate.forEach(c,this),this.displayed||(this.displayed=this.display()),Object.keys(this.event.events).length==this.container.adData.length&&this.displayed&&a.events.postNativeAdsAreLoaded.fire(this.element.dataset.format),this.postUpdate.forEach(c,this)},b.prototype.display=function(){var a,b;for(a in this.conditions)if(this.conditions.hasOwnProperty(a)&&(b=this.conditions[a],"function"==typeof b&&b(this.container.adData)))return this.elementClassManager.removeClass("hidden"),null!==this.containerClassManager&&this.containerClassManager.removeClass("hidden"),!0;return!1},b.prototype.registerPostUpdateFunction=function(b){"function"==typeof b?this.postUpdate.push(b):a.logging.logError(new Error("Can only register functions to adgroup update"),["adAction=expads.postMessage.group.registerPostUpdateFunction"])},b.prototype.registerPreUpdateFunction=function(b){"function"==typeof b?this.preUpdate.push(b):a.logging.logError(new Error("Can only register functions to adgroup update"),["adAction=expads.postMessage.group.registerPreUpdateFunction"])},b.prototype.isVisible=function(){return this.containerClassManager?a.utils.isVisible(this.containerElement):a.utils.isVisible(this.element)},a.postMessage=a.postMessage||{},a.postMessage.Group=b}(window.expads=window.expads||{}),function(a,b,c){"use strict";b.postMessage=b.postMessage||{},b.postMessage.utils=b.postMessage.utils||{},b.postMessage.utils.isHouseAd=function(a){return a&&a.hasOwnProperty("isHouseAd")&&a.isHouseAd},b.postMessage.utils.containsRevenueAds=function(a){for(var c,d=0;d<a.length;++d)if(c=a[d],!b.postMessage.utils.isHouseAd(c))return!0;return!1}}(window,window.expads=window.expads||{}),function(a){"use strict";"function"==typeof a.define&&a.define.amd&&define("expads/flexCard",["uitk","expads"],function(b,c){function d(){return function(a){require(["expads/linkDirectConfig","expads/linkDirectTargeting","adtoolkit/experiments"],function(b,d,e){c&&c.HotelLinkDirect&&d&&"function"==typeof d&&d(function(d){var f=new c.HotelLinkDirect(a,b,d,e),g=f;f.isHotelEnrolledInLD()&&f.getTargetUrl(function(a){var b=g;g.wrapWithClickTrackers(a,function(a){b.logOmnitureForHoldout(),b.renderCriteriaMet()&&b.renderAndSetTargetUrl(a)})})})})}}function e(a){return function(b){a&&b&&(f(a,b),g(a,b),j(a,b),k(a,b),n(a,b),o(a,b),m(a,b),l(a,b),p(a,b),q(a,b),r(a,b),s(a,b),u(a,b),t(a,b),x(a,b))}}function f(a,b){if(b&&b.hasOwnProperty("title")){var c=a.getElementsByClassName("title")[0],d=document.createElement("h2");c&&(d.className="flex-title truncate",d.innerText=b.title,c.innerHTML="",c.appendChild(d))}}function g(a,b){var c=a.getElementsByClassName("description")[0];if(c&&b&&b.hasOwnProperty("description")){var d=b.description;"dx-native-inline"==b.type&&(d=v(d,160)),c.innerText=d}}function h(a){var b,c,d,e=[];for(b=0;b<a.length;++b)d=a[b],d&&d.hasOwnProperty("src")&&(c=d.src,d.hasOwnProperty("width")&&(c+=" "+d.width),d.hasOwnProperty("ratio")&&(c+=" "+d.ratio),e.push(c));return e.join(",")}function i(a){try{if(a){for(var b=a.parentNode,d=a.cloneNode(!0),e=d.getElementsByClassName("tile-media"),f=0;f<e.length;f++)d.removeChild(e[f]);return b.removeChild(a),b.appendChild(d),d}}catch(g){c.logging.logError(g,["adAction=initializeNativeImageElement"])}return null}function j(a,b){var c,d=i(a.getElementsByClassName("image")[0]);d&&b&&b.hasOwnProperty("backgroundUrl")&&(c=[{src:b.backgroundUrl}],b.hasOwnProperty("backgroundUrlSmall")&&c.push({src:b.backgroundUrlSmall,width:"725w",ratio:"1-1"}),b.hasOwnProperty("imageAltText")&&(d.setAttribute("data-alt",b.imageAltText),d.classList.contains("image-title")&&(d.title=b.imageAltText)),d.setAttribute("data-srcset",h(c)),d.setAttribute("data-lazy","true"))}function k(a,b){var d,e,f=a.getElementsByClassName("top-left-logo")[0];f&&(d=f.getElementsByTagName("img")[0],e=new c.utils.ClassManager(f)),d&&e&&(b.topLeftLogoUrl?(d.setAttribute("src",b.topLeftLogoUrl),e.removeClass("hidden")):e.addClass("hidden"))}function l(a,b){if(b.hasOwnProperty("impressionTrackers")){var c,d=b.impressionTrackers;for(c=0;c<d.length;++c)if(d[c]){var e=document.createElement("img");e.className="hidden",e.src=d[c],a.appendChild(e)}}}function m(a,b){if(b&&b.hasOwnProperty("sponsoredText")&&!c.postMessage.utils.isHouseAd(b)){var d,e,f=a.getElementsByClassName("sponsored-text")[0];f&&(f.innerText=b.sponsoredText,b.logoUrl?(e=document.createElement("img"),e.src=b.logoUrl,e.alt=b.logoText,e.className="bottom-logo",f.appendChild(e)):b.logoText&&(e=document.createElement("span"),e.innerText=v(b.logoText,25),e.className="logo-text",f.appendChild(e)),d=f.parentElement,d&&new c.utils.ClassManager(d).removeClass("hidden"))}}function n(a,b){var c=a.getElementsByClassName("flex-link")[0];c&&b&&b.hasOwnProperty("clickThroughUrl")&&(c.href=b.clickThroughUrl,b.hasOwnProperty("openInTab")&&(c.target=b.openInTab?"_blank":"_top"))}function o(a,b){var d=a.getElementsByClassName("destination-title")[0];if(d){var e=new c.utils.ClassManager(d);e.addClass("hidden"),b&&b.destinationName&&(d.innerText=v(b.destinationName,25),e.removeClass("hidden"))}}function p(a,b){if(b&&b.hasOwnProperty("buttonText")){var c=a.getElementsByClassName("btn-label")[0];c&&(c.innerText=b.buttonText)}}function q(a,d){a.parentElement.parentElement;if(d&&d.hasOwnProperty("modal")){var e=d.modal.modalBackground,f=d.modal.modalContent,g=d.modal.advertiserLogo,h=d.modal.learnMoreUrl,i=new Image,j=new Image;j.onload=function(){i.src=j.src},j.src=e;var k=new Image,l=new Image;l.onload=function(){k.src=l.src},l.src=g;var m=document.createElement("a");m.setAttribute("href",h),m.setAttribute("id","learnMoreLink"),m.innerText="Learn More";var n=document.createElement("p");n.appendChild(k),b.subscribe("modal.appended",function(a,b){var d=b.options;if("undefined"!=typeof d&&"adLandingOverlay"===d.modalId){var e,g,h,j,k,l=b.modalInnerHtml;"undefined"!=typeof l?(e=l[0].getElementsByClassName("modal-header")[0],g=l[0].getElementsByClassName("modal-body")[0],h=l[0].getElementsByClassName("modal-footer")[0]):c.logging.logError(new Error("modal inner HTML is undefined"),["adAction=expads.postMessage.setModal"]),"undefined"!=typeof g?(j=g.children[1],k=g.children[0]):c.logging.logError(new Error("the body of the modal is undefined"),["adAction=expads.postMessage.setModal"]),"undefined"!=typeof e?e.style.backgroundImage="url("+i.src+")":c.logging.logError(new Error("the header of the modal is undefined"),["adAction=expads.postMessage.setModal"]),"undefined"!=typeof j?j.innerHTML=f:c.logging.logError(new Error("text content of the modal body undefined"),["adAction=expads.postMessage.setModal"]),"undefined"!=typeof k?k.appendChild(n):c.logging.logError(new Error("logo part of the modal body undefined"),["adAction=expads.postMessage.setModal"]),"undefined"!=typeof h?h.appendChild(m):c.logging.logError(new Error("The modal footer undefined"),["adAction=expads.postMessage.setModal"])}})}}function r(a,b){var c=a.getElementsByClassName("affinities")[0];if(b&&b.destinationAffinities&&c){c.innerHTML="";for(var d,e,f=document.createDocumentFragment(),g=document.createElement("div"),h=document.createElement("span"),i=0;i<b.destinationAffinities.length;i++){var j=b.destinationAffinities[i];e=h.cloneNode(),e.innerText=v(j,15),e.setAttribute("title",j),d=g.cloneNode(),d.className="affinity affinity"+i,d.appendChild(e),f.appendChild(d)}c.appendChild(f)}}function s(a,b){if(a&&b&&b.calltoAction){var c=a.getElementsByClassName("callto-action")[0];c&&b.calltoAction&&(c.innerText=v(b.calltoAction,36),c.setAttribute("title",b.calltoAction))}}function t(b,c){var d,e,f;b&&c&&"native-flight-filter"===c.type&&c.airlineCode&&(f=w(c.adUnit),d="flightFilter-"+f,e=document.getElementById(d),e.onclick=function(){"function"==typeof a.filterByAirlineCode_NBF&&filterByAirlineCode_NBF(c.airlineCode)})}function u(a,b){var d=a.querySelector(".hearting-btn button");d&&b&&b.hasOwnProperty("gaiaIdNumber")&&(d.setAttribute("data-item-id",b.gaiaIdNumber),d.setAttribute("data-name",b.destinationTitle),new c.utils.ClassManager(d).removeClass("hidden"))}function v(a,b){var c=a;return c.length>b&&(c=c.substr(0,b-3)+"..."),c}function w(a){var b=a.split(/\//);return b[b.length-1]}function x(a,b){new c.utils.ClassManager(a).removeClass("hidden");var d=parseInt(b.abacusID,10);d===d&&c.checkBucketAndExpose(d,function(){})}return function(a,f){if(a){var g,h,i=document.getElementById(a.templateId),j=i.parentElement;if(null!==i&&j&&"object"==typeof j.adgroup?(g=e(i),"HLD"===(a.slotIdOverride||a.id)&&(g=d()),j.adgroup.registerAdUnit(a.slotIdOverride||a.id,g)):c.logging.logError(new Error("Unable to find element to register post message handler"),["adAction=expads.postMessage.registerAdUnit"]),"string"==typeof f&&""!==f.trim()){var k,l=document.getElementById(a.templateId),m=document.getElementById(a.id);null!==l&&null!==m&&(h=new c.utils.ClassManager(l),k=new c.utils.ClassManager(m),b.subscribe("mediaquery.matched",function(b,d){d.key===a.templateId&&(h.removeClass("hidden"),k.addClass("hidden-before-load"),c.ensureVisibleAdsAreLoaded())}),b.mediaquery.register(f,a.templateId))}}else c.logging.logError(new Error("No slot config specified, cannot register flexCard"),["adAction=expads.postMessage.flexCard"])}})}(window),function(a){"use strict";"function"==typeof window.define&&window.define.amd&&define("expads/flexCardSet",function(){return function(b,c,d){var e=document.getElementById(b),f=document.getElementById(c);return e.adgroup=new a.postMessage.Group(d||"ad-native-flex",e,[a.postMessage.utils.containsRevenueAds],f),e.adgroup}})}(window.expads=window.expads||{}),function(a,b){"use strict";var c=function(c){try{var d,e,f,g,h,i,j=c.adconfig||{},k=c.startTime,l=c.name,m=c.timeToLoadCreative,n=c.cmc;if(void 0!==l){d={},d.name=l,d.requestTime=k,d.timeToLoadCreative=m,d.cmc=n;for(h in j)j.hasOwnProperty(h)&&(d[h]=j[h]);try{if(g=JSON.parse(c.resourceList),g&&g.length>0)for(d.resourceList=g,f=0;f<g.length;f++)"img"===g[f].initiatorType&&(i=g[f].responseEnd-g[f].startTime,(void 0===e||i>e)&&(e=g[f].responseEnd-g[f].startTime));else g&&(d.resourceList=g),e=(new Date).getTime()-k.getTime()}catch(o){e=(new Date).getTime()-k.getTime(),b.logging.logMessage("Unable to parse stringified resource list from HTML5 message. Frame name="+l)}d.elapsedTime=e,a.expads.renderedAds[d.name]=d,b.analytics.displayAdCalls[b.analytics.displayAdCalls.length-1].processAdMetrics(l,n,m)}}catch(p){b.logging.logError(p,["adAction=creativeAnalyticListener.processAdMetrics"])}},d=function(c){var d=c.name,e=a.expads.renderedAds[d]||{},f=[],g=c.adconfig;e.errorMsg=c.errorMsg,e.errorLine=c.errorLine,e.errorUrl=c.errorUrl,e.error=!0,a.expads.renderedAds[d]=e,f.push("onErrorMsg="+encodeURIComponent(c.errorMsg)),f.push("onErrorUrl="+encodeURIComponent(c.errorUrl)),f.push("orderId="+encodeURIComponent(g.orderId||"")),f.push("lineItemId="+encodeURIComponent(g.lineItemId||"")),f.push("creativeId="+encodeURIComponent(g.creativeId||"")),f.push("adUnitId="+encodeURIComponent(g.adUnitId||"")),f.push("onErrorLine="+encodeURIComponent(c.errorLine)),b.logging.logMessage("ExpAds",f)};b.analytics=b.analytics||{},b.analytics.processAdMetrics=c,b.analytics.handleErrorMessage=d,window.addEventListener("message",function(a){var c=a.data,d=a.origin;c&&c.adconfig&&(d.indexOf("google")!==-1||d===window.location.origin)&&(c.error?b.analytics.handleErrorMessage(c):b.analytics.processAdMetrics(c))})}(window,window.expads=window.expads||{}),"function"==typeof window.define&&window.define.amd&&"function"==typeof window.require&&define("setDisplayAdSlotConfig",["expads"],function(a){"use strict";return function(b){var c={};c.width=b.width,c.height=b.height,"boolean"==typeof b.collapseEmptyDiv&&(c.collapseEmptyDiv=b.collapseEmptyDiv),b.collapseEmptyDiv?(c.id=b.id+"-AD",c.slotIdOverride=adconfig.id):c.id=b.id,b.slotIdOverride&&(c.slotIdOverride=b.slotIdOverride),b.pagePath&&(c.pagePath=b.pagePath),a.configuration.displayAdSlots=a.configuration.displayAdSlots||[],a.configuration.displayAdSlots.push(c)}}),function(a,b){"use strict";function c(){return a.utils.emailDetected()}var d=a.adProducts=a.adProducts||[];a.configuration=a.configuration||{},a.renderedAds=a.renderedAds||{},a.initialize=function(b){var e=a.utils,f=e.isDuplicateAdCall,g=e.isEmptyObject,h=e.mergeTargetingAndUpdateLocalStorage;if(c()!==!0){a.events.preInitialize.fire();var i,j;if(h(b),!f(a.slots)){for(i=0;i<d.length;i++)j=d[i].filterAdSlots(a.slots),g(j)||d[i].initialize(j);a.events.postInitialize.fire()}}},a.refresh=function(b,e){var f=a.utils,g=f.isDuplicateAdCall,h=f.isEmptyObject,i=f.mergeTargetingAndUpdateLocalStorage;if(c()!==!0&&(a.events.preRefresh.fire(),i(b),!g(a.slots))){a.renderedAds={};var j,k;for(k=0;k<d.length;k++)j=d[k].filterAdSlots(a.slots),h(j)||d[k].refresh(j,e);a.events.postRefresh.fire()}},a.ensureVisibleAdsAreLoaded=function(){if(c()!==!0){a.events.preEnsureVisibleAdsAreLoaded.fire();var b,e;for(b=0;b<d.length;b++)e=d[b].filterAdSlots(a.slots),a.utils.isEmptyObject(e)||d[b].ensureVisibleAdsAreLoaded(e);a.events.postEnsureVisibleAdsAreLoaded.fire()}},a.refreshAdsOnFocus=function(b){if(c()!==!0){var e,f;for(e=0;e<d.length;e++)f=d[e].filterAdSlots(a.slots),!a.utils.isEmptyObject(f)&&f.hasOwnProperty(b)&&d[e].refreshAdsOnFocus(b)}},a.ensureViewableAdsAreLoaded=function(){if(c()!==!0){var b,e;for(b=0;b<d.length;b++)e=d[b].filterAdSlots(a.slots),a.utils.isEmptyObject(e)||d[b].ensureViewableAdsAreLoaded(e)}},a.setAdProducts=function(b){d=a.adProducts=b},a.registerAdProduct=function(a){d.push(a)},a.utils.performance.clearAndMark("expedia.ads.library.ready"),a.analytics=a.analytics||{},b===a.analytics.expadsReady&&(a.analytics.expadsReady=(new Date).getTime())}(window.expads=window.expads||{}),function(a){"use strict";a.AdProduct=function(a){this.name=a},a.AdProduct.prototype.clear=function(){a.logging.logMessage("Call to unimplemented method clear for base AdProduct",["adProductName="+this.name])},a.AdProduct.prototype.ensureVisibleAdsAreLoaded=function(){a.logging.logMessage("Call to unimplemented method ensureVisibleAdsAreLoaded for base AdProduct",["adProductName="+this.name])},a.AdProduct.prototype.filterAdSlots=function(b){return a.logging.logMessage("Call to unimplemented method filterAdSlots for base AdProduct",["adProductName="+this.name,"slots="+b]),{}},a.AdProduct.prototype.initialize=function(b){a.logging.logMessage("Call to unimplemented method initialize for base AdProduct",["adProductName="+this.name,"slots="+b])},a.AdProduct.prototype.refresh=function(a){this.clear(),this.ensureVisibleAdsAreLoaded(a)},a.AdProduct.prototype.refreshAdsOnFocus=function(a){},a.AdProduct.prototype.ensureViewableAdsAreLoaded=function(a){}}(window.expads=window.expads||{}),function(a,b,c){"use strict";function d(a){return a.baseUrl}function e(a,c,d){var e,f=[];return b.utils.isArray(d)&&d.forEach(function(b){e=q(a,c,b),null!==e&&f.push(e)}),f.join("/")}function f(a,b,c){var d,e,f,g=[],h="";return null!==c&&"function"==typeof c.forEach&&c.forEach(function(c){if(d=c.key,f=k(c),j(a,f)&&d){if(h=d,e=q(a,b,c.value),null!==e&&"undefined"!=typeof e){if("__blank__"===d)return void g.push(e);h+="="+e}g.push(h)}}),g.join("&")}function g(a,c){try{if(a.hasOwnProperty("dateFormat")&&a.hasOwnProperty(c.value))return new b.utils.ParseDate(a[c.value],a.dateFormat).formatDate(c.format)}catch(d){b.logging.logError(d,["adAction=expads.goDirect.handleDate"])}return null}function h(a,b){return a.hasOwnProperty(b.value)?a[b.value]:null}function i(a,b){return a.hasOwnProperty(b.value)?a[b.value]:null}function j(a,b){var c=b.filter(function(b){return a.hasOwnProperty(b)});return b.length===c.length}function k(a){var c=a.dependsOn||[];return b.utils.isArray(c)||(c=[c]),c}function l(a,b,c){var d=k(c);if(j(a,d)){if(c.hasOwnProperty("path"))return e(a,b,c.path);if(c.hasOwnProperty("query"))return f(a,b,c.query)}return null}function m(){return Date.now()}function n(a,b){var c=i(a,{value:t});if(b.hasOwnProperty("encoding"))switch(b.encoding){case"uriComponent":c=encodeURIComponent(c)}return c}function o(a,d,e){var f,g=null;return b.utils.isArray(e.value)&&e.value.forEach(function(b){f=q(a,d,b),null!==f&&f!==c&&(null===g?g=f:g+=f)}),g}function p(a,d,e){var f,g=e.delimiter||"",h=[];try{return b.utils.isArray(e.value)&&e.value.forEach(function(b){f=q(a,d,b),null!==f&&f!==c&&h.push(""+f)}),h.length>0?h.join(g):null}catch(i){b.logging.logError(i,["adAction=expads.goDirect.handleCombineDate"])}}function q(a,b,c){if(c.hasOwnProperty("type"))switch(c.type){case"string":return c.value||"";case"param":return i(b,c);case"variable":return h(a,c);case"date":return g(a,c);case"runtime":return l(a,b,c);case"timestamp":return m();case"redirect":return n(b,c);case"add":return o(a,b,c);case"join":return p(a,b,c)}return null}function r(a,b,c){var d=a;return"string"==typeof b&&b.length>0&&(d+="/"===d.charAt(d.length-1)?"":"/",
d+=b),"string"==typeof c&&c.length>0&&(d+="?"+c),d}function s(a,c){var g=c.mapping||{},h=g.params||{},i=c.brand||{},j=c.clickTracker,k=e(a,h,i.path||[]),l=f(a,h,i.query||[]),m=d(g),n=r(m,k,l);if("string"!=typeof n||0===n.trim().length)throw new Error("Cannot construct go direct url, invalid base url");return null!==j&&"object"==typeof j&&"string"==typeof j.baseUrl&&j.baseUrl.length>0&&(h[t]=n,n=r(j.baseUrl,e(a,h,j.path||[]),f(a,h,j.query||[]))),b.logging.logMessage("GoDirect Generated",["url="+n,"baseUrl="+m,"path="+k,"query="+l]),n}var t="_REDIRECT_URL_";b.goDirect=s}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";function d(a,b,c,d){this.dfpData=a||{},this.config=b||{},this.hotelId=b.hotelId,this.brandName=(b.brand||{}).brandHotelName||"",this.targeting=c||{},this.experiments=d||{},this.omnitureData={hotelId:b&&b.hotelId||"",creativeId:a&&a.creativeId||"",lineItemId:a&&a.lineItemId||""}}d.prototype={isHotelEnrolledInLD:function(){return this.config&&this.hotelId&&this.config.brand&&this.getDcmClickTrackingUrlTemplate()||!1},isHoldout:function(){return b&&b.configuration&&b.configuration.user&&b.configuration.user.isHoldout||!1},evaluateBrandAbTest:function(){for(var a=[{brandName:"laQuintaHotel",experimentName:"HLD_LaQuinta"}],b=0;b<a.length;b++){var c=a[b],d=c.brandName,e=c.experimentName;if(d===this.brandName&&this.experiments&&this.experiments.hasExperiment(e))return 1==this.experiments.getExperimentByName(e).bucket}return!0},renderCriteriaMet:function(){return!this.isHoldout()&&this.evaluateBrandAbTest()},getUserGuid:function(){var b=a.utag_data||{},c=b.context||{},d=c.user||{},e=d.guid;return e},adultCountInRoom1:function(a){return"string"==typeof a.adults&&a.adults.trim().length>0?a.adults.split(",")[0]:0},childrenCountInRoom1:function(a){var b="string"==typeof a.children?a.children.split(","):[];return b.reduce(function(a,b){var c;return"string"==typeof b&&b.match("[0-9]+_[0-9]+")&&(c=b.split("_")[0],"1"===c)?++a:a},0)},getTargetUrl:function(b){"function"==typeof a.define&&a.define.amd&&require(["expads","hotelInfo"],function(a,c){if(a&&"function"==typeof a.goDirect){var d=c.backToSearchParams||{},e={children:this.childrenCountInRoom1(d),adults:this.adultCountInRoom1(d),checkin:d.startDate,checkout:d.endDate,dateFormat:c.dateFormat,nights:this.getRoomNights(this.targeting.ets,this.targeting.ete)},f=a.goDirect(e,this.config);b&&b(f)}}.bind(this))},getRoomNights:function(a,b){var c=new Date(a),d=new Date(b);return Math.floor((d-c)/864e5)},wrap:function(a,b){if(b)return a?a+encodeURIComponent(b):b},wrapWithoutEncode:function(a,b){if(b)return a?a+""+b:b},wrapWithClickTrackers:function(a,b){if("string"==typeof a){var c=this.getDcmTrackingParams(this.targeting),d=this.dfpData.dfpClickTrackingUrl,e=(this.getDcmClickTrackingUrlTemplate()||"").replace("[params]",c),f=this.dfpData.thirdPartyClickTrackingURL,g=this.wrap(f,a),h=this.wrapWithoutEncode(e,g),i=this.wrap(d,h);b&&b(i)}},getDcmClickTrackingUrlTemplate:function(){var a=this.config&&this.config.brand||{};return"function"==typeof b.utils.isProdEnvironment&&b.utils.isProdEnvironment()?a.dcmClickTrackingUrl_prod:a.dcmClickTrackingUrl_dev},getDcmTrackingParams:function(c){var d=[],e={u30:c.hid,u32:c.ets,u33:c.ete,u34:c.ladr,u35:c.cur,u36:1,u38:this.getUserGuid(),u39:a.location.hostname,ENV:b.environment||""};for(var f in e)e.hasOwnProperty(f)&&e[f]&&d.push(f+":"+e[f]);return encodeURIComponent(d.join("|"))},renderAndSetTargetUrl:function(a){var b=document.getElementById(this.config.hyperlinkId||"");b&&"a"===b.tagName.toLocaleLowerCase()&&a&&(b.href=a,b.classList.remove("hidden"),this.logOmnitureImpression(),b.onclick=this.logOmnitureClick.bind(this))},logOmnitureImpression:function(){this.omnitureData.hotelId&&"function"==typeof a.define&&a.define.amd&&require("dctk/dctk",function(a){if(a&&"function"==typeof a.trackEvent){var b="LinkDirect.impression.hid.#HOTELID#.cid.#CREATIVEID#.lid.#LINEITEMID#";b=b.replace("#HOTELID#",this.omnitureData.hotelId),b=b.replace("#CREATIVEID#",this.omnitureData.creativeId),b=b.replace("#LINEITEMID#",this.omnitureData.lineItemId),a.trackEvent({name:"HOT.HIS.Link.HotelDirect.impression."+this.omnitureData.hotelId,trackVars:{prop16:b,eVar28:b}})}}.bind(this))},logOmnitureClick:function(){this.omnitureData.hotelId&&"function"==typeof a.define&&a.define.amd&&require("dctk/dctk",function(a){if(a&&"function"==typeof a.trackEvent){var b="LinkDirect.click.hid.#HOTELID#.cid.#CREATIVEID#.lid.#LINEITEMID#";b=b.replace("#HOTELID#",this.omnitureData.hotelId),b=b.replace("#CREATIVEID#",this.omnitureData.creativeId),b=b.replace("#LINEITEMID#",this.omnitureData.lineItemId),a.trackEvent({name:"HOT.HIS.Link.HotelDirect.click."+this.omnitureData.hotelId,trackVars:{prop16:b,eVar28:b}})}}.bind(this))},logOmnitureForHoldout:function(){this.omnitureData.hotelId&&"function"==typeof a.define&&a.define.amd&&require("dctk/dctk",function(a){if(a&&"function"==typeof a.trackAction){var b="LinkDirect.#STATUS#."+this.omnitureData.hotelId;b=this.isHoldout()?b.replace("#STATUS#","Holdout"):b.replace("#STATUS#","NotHoldout"),a.trackAction(b)}}.bind(this))}},b.HotelLinkDirect=d}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";var d=function(c){var d,e,f,h;for(d in c)if(c.hasOwnProperty(d))try{e=a.getElementById(d),b.utils.isLoaded(e)||!b.utils.isVisible(e)&&!b.utils.isForceLoad(e)||(f=c[d],h=f.url+"location="+f.location+"&sublocation="+f.sublocation+"&placement="+f.placement,g(e,h))}catch(i){b.logging.logError(i,["adAction=afcAds.ensureVisibleAdsAreLoaded","adId="+d])}},e=function(c){for(var e in c)if(c.hasOwnProperty(e)){var f=a.getElementById(e);b.utils.isLoaded(f)&&h(f)}d(c)},f=function(a){var b,d,e={};if(a!==c)for(b in a)a.hasOwnProperty(b)&&(d=a[b],d!==c&&d.url!==c&&d.location!==c&&d.sublocation!==c&&d.placement!==c&&(e[b]=d));return e},g=function(a,b){var c="true"===a.getAttribute("data-resize"),d='<iframe scrolling="no" frameBorder="0" marginHeight="0" marginWidth="0" allowTransparency="true" style="border:none; overflow:hidden; width:'+a.style.width+"; height:"+a.style.height+';" src="'+b+'"';c&&(d+=" onload=\"expads.utils.resize('"+a.id+"');\""),d+="></iframe>",a.innerHTML=d,a.setAttribute("data-loaded","true")},h=function(a){a!==c&&a.removeAttribute("data-loaded")},i=new b.AdProduct("AfcAds");i.initialize=e,i.clear=h,i.ensureVisibleAdsAreLoaded=d,i.filterAdSlots=f,i.refresh=e,b.registerAdProduct(i)}(window.document,window.expads=window.expads||{}),function(a,b,c){"use strict";b.adSenseContainers=b.adSenseContainers||{};var d=function(){e()},e=function(){if("object"==typeof window.expAdsCsa&&window.expAdsCsa.shouldRefresh())for(var c in window.expads.adSenseContainers)if(window.expads.adSenseContainers.hasOwnProperty(c)){var d=a.getElementById(c);b.utils.isLoaded(d)&&f(d)}g()},f=function(a){a!==c&&a.removeAttribute("data-loaded")},g=function(){for(var c in b.adSenseContainers)try{var d=a.getElementById(c);if(!b.utils.isLoaded(d)&&(b.utils.isVisible(d)||b.utils.isForceLoad(d))){var e=window.expads.adSenseContainers[c];e(c),d.setAttribute("data-loaded","true")}}catch(f){b.logging.logError(f,["adAction=afsAds.ensureVisibleAdsAreLoaded"])}},h=function(){return b.adSenseContainers},i=new b.AdProduct("AfsAds");i.initialize=d,i.clear=f,i.ensureVisibleAdsAreLoaded=g,i.refresh=e,i.filterAdSlots=h,b.registerAdProduct(i)}(window.document,window.expads=window.expads||{}),function(a,b,c,d){"use strict";function e(a,b,c){this.id=a,this.config=b,this.googleSlot=c,this.viewed=!1,this.reloadOnFocus=!1}e.prototype.getContainer=function(){return a.getElementById(this.id)};var f=!1,g=!1,h=[],i=b.utils.isFunction,j=b.utils.extractValue,k=b.utils.debounce(b.events.postSlotRenderEnded.fire,20,b.events.postSlotRenderEnded),l=function(){var a,b,d=[];for(a=0;a<h.length;a++)b=h[a].getContainer(),d.push(h[a].googleSlot),G(b)&&n(b);c&&c.apiReady&&(c.pubads().clear(d),c.pubads().updateCorrelator())},m=function(a){var d,e;for(d=0;d<a.length;d++)e=a[d].getContainer(),a[d].viewed=b.utils.isViewable(e)||!1,G(e)&&(n(e),c&&c.apiReady&&(c.pubads().clear(a[d].googleSlot),c.pubads().updateCorrelator()))},n=function(a){a!==d&&(a.removeAttribute("data-loaded"),a.style.display="")},o=function(a,c,d){try{if("object"==typeof c){var e,f,g,h,i,j,k,l,m,n,o=10,p=[];for(e in c)if(c.hasOwnProperty(e)&&(g=e.split("X"),b.utils.isArray(g)&&2===g.length)){n=[],h=g[0],i=g[1],f=[],f.push(parseInt(h,o)),f.push(parseInt(i,o)),j=[];for(k in c[e])c[e].hasOwnProperty(k)&&(l=c[e][k],m=[],m.push(parseInt(l.width,o)),m.push(parseInt(l.height,o)),j.push(m));b.utils.isArray(f)&&f.length>0&&b.utils.isArray(j)&&j.length>0&&(n.push(f),n.push(j),p.push(n))}p.length>0&&d.defineSizeMapping(p)}}catch(q){b.logging.logError(q,["adAction=defineSizeMapping","adId="+a])}},p=function(a){var b,d=[];for(b=0;b<a.length;b++)d.push(a[b].googleSlot);d.length>0&&c.destroySlots(d)},q=function(b){var f,g,i,j,k;if(b!==d&&c&&c.apiReady)for(f in b)b.hasOwnProperty(f)&&(g=b[f],g!==d&&g.path!==d&&g.width!==d&&g.height!==d&&s(a.getElementById(f))&&!g.defined&&(i=g.legacyId!==d?g.legacyId:f,k="fluid"===g.width||"fluid"===g.height?"fluid":[parseInt(g.width,10),parseInt(g.height,10)],j=c.defineSlot(g.path,k,i).addService(c.pubads()),g.collapseEmptyDiv&&j.setCollapseEmptyDiv(!0,!0),o(f,g.sizeMap,j),h.push(new e(i,g,j)),g.defined=!0))},r=function(b){var f,g,h,i,j,k=[];if(b!==d&&c&&c.apiReady)for(f in b)b.hasOwnProperty(f)&&(g=b[f],g!==d&&g.path!==d&&g.width!==d&&g.height!==d&&s(a.getElementById(f))&&(h=g.legacyId!==d?g.legacyId:f,j="fluid"===g.width||"fluid"===g.height?"fluid":[parseInt(g.width,10),parseInt(g.height,10)],i=c.defineSlot(g.path,j,h).addService(c.pubads()),g.collapseEmptyDiv&&i.setCollapseEmptyDiv(!0,!0),o(f,g.sizeMap,i),k.push(new e(h,g,i))));return k},s=function(a){return!G(a)&&(b.utils.isVisible(a)||H(a))},t=function(){return b.configuration.defineViewableAndDestroyHiddenAdSlots===!0&&!b.configuration.defineViewableAdSlots},u=function(){!1!==b.configuration.collapseEmptyDivs&&c.pubads().collapseEmptyDivs(),c.pubads().disableInitialLoad(),c.pubads().enableSingleRequest(),c.pubads().set("page_url",window.location.href.toString()),c.enableServices()},v=function(a){if(c&&c.apiReady&&g){var e,f,i=[],j=[];try{for(b.utils.performance.clearAndMark("expedia.displayads.ensurevisibleadsareloaded.start"),q(a),e=0;e<h.length;e++)J(h[e]);if(t())for(h!==d&&(l(),p(h)),h=r(a),e=0;e<h.length;e++)J(h[e]);for(e=0;e<h.length;e++)try{f=h[e].getContainer(),s(f)&&(b.utils.isViewable(f,h[e].id)&&(h[e].viewed=!0),h[e].reloadOnFocus===!0&&(h[e].reloadOnFocus=!1),f.setAttribute("data-loaded","true"),i.push(h[e]),j.push(h[e].id))}catch(k){b.logging.logError(k,["adAction=ensureVisibleAdsAreLoaded","adId="+h[e].id])}w(i,j)}catch(k){e!==d?b.logging.logError(k,["adAction=ensureVisibleAdsAreLoaded","adId="+h[e].id]):b.logging.logError(k,["adAction=ensureVisibleAdsAreLoaded"])}}},w=function(a,e){var f,g,h=[],i=[];try{if(a.length>0)try{if(c&&c.apiReady){new b.analytics.DisplayAdCall(e);var j=new b.analytics.AdCall("display",e);for(c.pubads().addEventListener("slotOnload",function(a){try{j.slotLoadedCallback(a,!0)}catch(c){b.logging.logError(c,["adAction=googletag.slotOnload"])}}),M(a),f=0;f<a.length;f++)g=a[f],g.config.lazyLoad!==!0?h.push(g.googleSlot):i.push(g.googleSlot);d===b.analytics.adsRequested&&(b.analytics.adsRequested=(new Date).getTime()),c.pubads().refresh(h,{changeCorrelator:!1}),I(i)}}catch(k){b.logging.logError(k,["adAction=googletag.pubads().refresh"])}}catch(k){b.logging.logError(k,["adAction=ensureVisibleAdsAreLoaded"])}},x=function(a){return a&&(a.maxRefreshCount===d||a.maxRefreshCount>0)},y=function(a){var c,e,f;try{b.configuration!==d&&b.configuration.refreshAdModel!==d&&(c=z(a),e=b.configuration.refreshAdModel.hasOwnProperty(a)&&b.configuration.refreshAdModel[a],f=e&&e.viewedAdsOnly,c&&(c.viewed||f===!1)&&x(e)&&(c.reloadOnFocus=!0,c.viewed=!1,e&&e.maxRefreshCount>0&&e.maxRefreshCount--)),A()}catch(g){b.logging.logError(g,["adAction=refreshAdsOnFocus"])}},z=function(a){var b;for(b=0;b<h.length;b++)if(h[b].id&&h[b].id===a)return h[b]},A=function(){if(c&&c.apiReady&&g){var a,d,e=[],f=[];try{for(a=0;a<h.length;a++)d=h[a].getContainer(),b.utils.isViewable(d,h[a].id)&&(h[a].reloadOnFocus&&!h[a].viewed&&(d.setAttribute("data-loaded","true"),h[a].reloadOnFocus=!1,e.push(h[a]),f.push(h[a].id)),h[a].viewed=!0);m(e),w(e,f)}catch(i){b.logging.logError(i,["adAction=ensureViewableAdsAreLoaded"])}}},B=function(a){var b,c,e={};for(b in a)a.hasOwnProperty(b)&&(c=a[b],c!==d&&c.path!==d&&c.width!==d&&c.height!==d&&(e[b]=c));return e},C=function(e){f===!0?this.refresh(e):e!==d&&(b.utils.performance.clearAndMark("expedia.displayads.initialize.start"),c.cmd=c.cmd||[],!1!==b.configuration.isExpAdsToDownloadGpt&&(c.cmd.push(function(){d===b.analytics.googleTagReady&&(b.analytics.googleTagReady=(new Date).getTime())}),function(){var b=a.createElement("script");b.async=!0,b.type="text/javascript",b.src="//www.googletagservices.com/tag/js/gpt.js",a.getElementsByTagName("head")[0].appendChild(b)}()),c.cmd.push(function(){b.utils.performance.clearAndMark("google.ads.initialize.start"),K(),u(),g=!0,D(),E(),v(e),b.utils.performance.clearAndMark("google.ads.initialize.complete"),b.utils.performance.clearAndMeasure("google.ads.initialize.startToFinish","google.ads.initialize.start","google.ads.initialize.complete")}),f=!0,b.utils.performance.clearAndMark("expedia.displayads.initialize.complete"),b.utils.performance.clearAndMeasure("expedia.displayads.initialize.startToFinish","expedia.displayads.initialize.start","expedia.displayads.initialize.complete"))},D=function(){c.pubads().addEventListener("slotOnload",function(a){var c,d;try{c=a.slot,d=b.analytics.displayAdCalls[b.analytics.displayAdCalls.length-1],d.recordRenderedAd(c),b.events.slotOnloadGoogleTagEvent.fire(a)}catch(e){b.logging.logError(e,["adAction=displayAds.slotOnLoadEventHandler"])}})},E=function(){var e={};c.pubads().addEventListener("slotRenderEnded",function(c){var f,g,h,i;try{if(i=c.slot.getSlotId().getDomId(),f=a.getElementById(i),null===f)throw new Error(i+" adSlot not found in DOM");e[i]=!0,g=b.utils.hasClass(f,"ad-variant")?f.parentNode:f,h=f.getElementsByTagName("iframe"),h&&h.length>0&&(k(e),b.configuration.title!==d?h[0].title=b.configuration.title:(b.logging.logMessage("Localized value of Advertisement is not configured"),h[0].title="Advertisement")),b.utils.toggleCollapsedExpanded(g,!c.isEmpty)}catch(j){b.logging.logError(j,["adAction=googletag.slotRenderEnded"])}})},F=function(a){this.clear(),K(),this.ensureVisibleAdsAreLoaded(a)},G=function(a){return null!==a&&"true"===a.getAttribute("data-loaded")},H=function(a){return null!==a&&"true"===a.getAttribute("data-force-load")},I=function(a){var b=function(){window.uitk!==d&&"function"==typeof window.uitk.unsubscribe&&(e&&window.uitk.unsubscribe("debounced.scroll",e),a.length>0&&c&&c.apiReady&&c.pubads().refresh(a,{changeCorrelator:!1}))};if(window.uitk!==d&&"function"==typeof window.uitk.subscribe&&a.length>0)var e=window.uitk.subscribe("debounced.scroll",b)},J=function(a){var b=a.getContainer();null!==b&&"true"!==b.getAttribute("data-displayed")&&c&&c.apiReady&&(c.display(a.id),b.setAttribute("data-displayed","true"))},K=function(){var a;if(c&&c.apiReady){if(b.targeting!==d)for(a in b.targeting)!b.targeting.hasOwnProperty(a)||b.updatedTargeting!==d&&a in b.updatedTargeting||L(c.pubads(),a,b.targeting[a]);if(b.updatedTargeting&&"object"==typeof b.updatedTargeting)for(a in b.updatedTargeting)b.updatedTargeting.hasOwnProperty(a)&&L(c.pubads(),a,b.updatedTargeting[a])}},L=function(a,c,e){var f,g;if(a!==d&&c!==d&&e!==d){if(b.utils.isArray(e)){for(g=[],f=0;f<e.length;f++)g.push(String(e[f]));a.setTargeting(c,g)}else e===!0?a.setTargeting(c,"1"):e===!1?a.setTargeting(c,"0"):a.setTargeting(c,String(e));if("d"===c&&("0"==e||"1"==e)){var h=new Error("d is corrupted in displayAds , value="+e);i(j(window.dctk,["logging","logError"]))?window.dctk.logging.logError("expads",h):console.error(h)}}},M=function(a){var c,e,f,g,h=window.expads.configuration&&window.expads.configuration.slotTargeting?window.expads.configuration.slotTargeting:null;for(c=0;c<a.length;c++){if(e=a[c],h&&e.config){g=e.config.name&&h[e.config.name]?h[e.config.name]:{};for(var i in g)g.hasOwnProperty(i)&&(e.config.slotTargeting||(e.config.slotTargeting={}),e.config.slotTargeting[i]&&b.logging.logMessage("slot targeting overriden for ",["slotId="+e.id,"key="+i]),e.config.slotTargeting[i]=g[i])}if(b.updatedTargeting!==d||e.config!==d&&e.config.slotTargeting){if(e.googleSlot.clearTargeting(),e.config!==d&&e.config.slotTargeting!==d)for(f in e.config.slotTargeting)e.config.slotTargeting.hasOwnProperty(f)&&L(e.googleSlot,f,e.config.slotTargeting[f]);if(b.updatedTargeting!==d)for(f in b.updatedTargeting)b.updatedTargeting.hasOwnProperty(f)&&L(e.googleSlot,f,b.updatedTargeting[f])}}},N=function(){return{run:function(a){try{b.analytics.creativeWindowCallback(a)}catch(c){b.logging.logError(c,["adAction=displayAds.callbackForAds"])}}}}(),O=new b.AdProduct("DisplayAds");O.initialize=C,O.clear=l,O.refresh=F,O.ensureVisibleAdsAreLoaded=v,O.filterAdSlots=B,O.refreshAdsOnFocus=y,O.ensureViewableAdsAreLoaded=A,b.registerAdProduct(O),b.callbackForAds=N}(window.document,window.expads=window.expads||{},window.googletag=window.googletag||{}),function(a){"use strict";function b(b){var c=function(a){return a=a||"0",parseInt(a.split(",")[0])},d=function(a){var b,c=0;return a=a||"",a.split(",").forEach(function(a){b=a.split("_")[0],1==b&&c++}),c};if(this.slot=b||{},"function"==typeof a.define&&a.define.amd){var e=this;require(["hotelInfo","expads","adtoolkit/experiments"],function(a,f,g){var h,i,j="yyyy-mm-dd",k=f.adtoolkit.data.adcontext,l={},m=a.backToSearchParams||{},n=m.startDate,o=m.endDate,p=a.dateFormat;g&&g.hasExperiment("HOTEL_DIRECT_HIS")&&(h=g.getExperimentByName("HOTEL_DIRECT_HIS"),h&&(e.experiment=h,i=h.id+"|0|"+h.bucket)),n&&o&&p&&(l.checkIn=new f.utils.ParseDate(n,p).formatDate(j),l.checkOut=new f.utils.ParseDate(o,p).formatDate(j)),l.domain=k.brandDomain,l.culture=(k.locale||"").replace("_","-"),l.userGuid=k.userId,l.userIp=k.clientIP,l.userAgent=navigator.userAgent,l.userAuthenticated=k.memberId>0,l.pageName="Hotel-IS",l.destHotels=b.hotelId,l.partnerQS="",l.hotelId=b.hotelId,l.rooms=1,l.adults=c(m.adults),l.children=d(m.children),l.userId=k.memberId>0?k.memberId:"0",l.testVersionOverride=i||"",l.destTLA="",l.currency=k.currencyCode,l.deviceType=f.utils.getDeviceType(),l.maxRequested=1,l.slots="HIS_GD",l.enableLinkOffAds=!0,e.slot.requestParams=l,e.slot.hooklogicUrl=f.adtoolkit.data.adcontext.config.hooklogicUrl,e._getAdultsInRoom1=c,e._getChildrenInRoom1=d})}}a.expads=a.expads||{},a.expads.configuration=a.expads.configuration||{};var c=!1,d={},e=function(a){c||g(a)},f=function(){return expads&&expads.configuration?expads.configuration.hotelDirectSlots||[]:[]},g=function(e){if(!c&&Array.isArray(e)){if("function"!=typeof a.define||!a.define.amd)return;e.forEach(function(a){a&&"object"==typeof a&&a.hotelId&&!d[a.hotelId]&&(d[a.hotelId]=new b(a))}),define("expads/hotelDirect",function(){return function(a){return d.hasOwnProperty(a)?d[a]||null:null}}),c=!0}};b.prototype=function(){var b,c=function(a,b,c){a=a||{};var d,e,f=a.slot||{},g=f.requestParams||{},h=g.testVersionOverride||"";return b&&b.travelAds&&Array.isArray(b.travelAds)&&b.travelAds.length>0&&(e=b.travelAds[0],d=e[c],d&&(d=d.replace("[trackingData]",e.trackingData||""),d=d.replace("[rank]","1"),d=d.replace("[testVersionOverride]",h),d=d.replace("[slots]","HIS_GD"),d=d.replace("[position]","1"))),d},d=function(a){var b=document.getElementById("hotelDirect-"+a);if(b&&b.tagName&&"a"===b.tagName.toLowerCase())return b},e=function(a,b){var c=expads.utils.getCompleteUrl(a.hooklogicUrl,a.requestParams);expads.utils.ajax({url:c,type:"GET",accept:"application/json; charset=utf-8",dataType:"json",done:function(a){null!==b&&"function"==typeof b&&b(a)},fail:function(a){expads.logging.logError(a,"Error making GetWinningCall ajax call for HotelDirect")}})},f=function(b){var c="HOT.HIS.Link.HotelDirectTest.click.#hotelId#".replace("#hotelId#",b);"function"==typeof a.define&&a.define.amd&&require("dctk/dctk",function(a){a.trackAction(c)})},g=function(b){var c="HOT.HIS.Link.HotelDirectTest.impression.#hotelId#".replace("#hotelId#",b);"function"==typeof a.define&&a.define.amd&&require("dctk/dctk",function(a){a.trackAction(c)})};return b={process:function(){if(this.experiment&&0!=this.experiment.bucket){var b,h,i=this,j=d(i.slot.hotelId);j&&"function"==typeof a.define&&a.define.amd&&require(["expads/hotelDirect"],function(){e(i.slot,function(a){b=c(i,a,"clickRedirectLinkoffTrackingUrl"),b&&(j.href="#",j.classList.remove("hidden"),j.onmousedown=function(){f(i.slot.hotelId),j.href=b},h=c(i,a,"impressionTrackingUrl"),h&&expads.utils.fireImpressionBeacon(h),g(i.slot.hotelId))})})}}},b._getUrlFromResponse=c,b._getElementByHotelId=d,b._makeGetWinningAdsCall=e,b}();var h=new expads.AdProduct("HotelDirect");h.initialize=g,h.filterAdSlots=f,h.ensureVisibleAdsAreLoaded=e,h.hotelMap=d,expads.registerAdProduct(h),expads.HotelDirect=b}(window),function(a,b,c){"use strict";var d,e,f;b.intentMedia=b.intentMedia||{},b.intentMedia.loaded=!1;var g=function(){if(b.slots&&b.slots.intentMedia){var a=b.slots.intentMedia;f=a.autoLoad||!1,h(f)}},h=function(a){if(b.slots&&b.slots.intentMedia){var c=b.slots.intentMedia;window.IntentMediaProperties=c.dataModel,d=c.scriptUrl,e=c.apiUrl,p(),a&&d?l():a&&e&&m()}},i=function(){b.intentMedia.loaded||h(f)},j=function(){},k=function(){},l=function(){if(window.IntentMedia&&window.IntentMedia.Event&&window.IntentMedia.Event.trigger)window.IntentMedia.Event.trigger("IntentMediaRefresh");else{var c=a.createElement("script");c.src=d,a.getElementsByTagName("head")[0].appendChild(c)}b.intentMedia.loaded=!0},m=function(){var a=window.IntentMediaProperties&&window.IntentMediaProperties.page_id||"",c=+new Date;b.utils.ajax({url:o(),done:function(c,d){a&&b.logging&&b.logging.logTrxEvent&&b.logging.logTrxEvent(a,["clEventName01=intentMediaApiCallSuccess&clEventTime01=1"])},fail:function(c){a&&b.logging&&b.logging.logError&&b.logging.logTrxEvent&&(b.logging.logError("IntentMedia API Call Error",c.status),b.logging.logTrxEvent(a,["clEventName01=intentMediaApiCallFailure&clEventTime01=0"]))},always:function(d,e){if(a&&b.logging&&b.logging.logTrxEvent){var f=+new Date-c;b.logging.logTrxEvent(a,["clEventName01=intentMediaApiCallLatency&clEventTime01="+f])}}}),b.intentMedia.loaded=!0},n=function(a){var b,d,e={};for(b in a)a.hasOwnProperty(b)&&(d=a[b],d!==c&&"intentMedia"===b&&(e[b]=d));return e},o=function(){var a,b,c=e,d=[],f=window.IntentMediaProperties;for(a in f)f.hasOwnProperty(a)&&(b=f[a],0===b.length?delete f[a]:("hotel_state_code"===a||"car_pickup_state"===a||"car_dropoff_state"===a)&&b.length>2?delete f[a]:"hotel_country_code"===a&&b.length>3?delete f[a]:d.push(encodeURIComponent(a)+"="+encodeURIComponent(b)));return d.length>0&&(c+="?"+d.join("&")),c},p=function(){window.IntentMediaProperties=window.IntentMediaProperties||{},window.IntentMediaProperties.cache_buster=Math.floor(1e7*Math.random())+ +new Date,window.IntentMediaProperties.screen_width=window.innerWidth||a.documentElement.clientWidth||a.body.clientWidth,window.IntentMediaProperties.screen_height=window.innerHeight||a.documentElement.clientHeight||a.body.clientHeight,window.IntentMediaProperties.screen_pixel_depth=window.screen.colorDepth,window.IntentMediaProperties.time_zone_offset=(new Date).getTimezoneOffset()*-1,window.IntentMediaProperties.display_format_type=a.documentElement.clientWidth>491?"Desktop":"Mobile"},q=function(){window.IntentMediaProperties=window.IntentMediaProperties||{};var a=1,b=10,d="aspp",e="adinf",f="IAID",g="|",h=r(d),i=r(e),j=r(f);if(h!==c&&h.length>0){window.IntentMediaProperties.expedia_cookie_aspp=h;var k=s(h,g,a);k!==c&&k.length>0&&(window.IntentMediaProperties.referring_site=k);var l=s(h,g,b);l!==c&&l.length>0&&(window.IntentMediaProperties.acquisition_channel=l)}if(i!==c&&i.length>0){var m=s(i,"|",2);m!==c&&m.length>0&&(window.IntentMediaProperties.is_signed_up_for_promo_email="1"===m)}j!==c&&j.length>0&&(window.IntentMediaProperties.machine_id=j)},r=function(b){if(a.cookie.length>0){var c=a.cookie.indexOf(b+"=");if(c!=-1){c=c+b.length+1;var d=a.cookie.indexOf(";",c);return d==-1&&(d=a.cookie.length),unescape(a.cookie.substring(c,d))}}return""},s=function(a,b,d){var e="";if(a!==c&&b!==c){var f=a.split(b);f.length>d&&f[d]!==c&&(e=f[d])}return e};b.intentMedia.updateDataModel=function(a){if("object"==typeof a){window.IntentMediaProperties=window.IntentMediaProperties||{};for(var b in a)a.hasOwnProperty(b)&&"function"!=typeof a[b]&&(properties[b]=a[b],0===a[b].length?delete window.IntentMediaProperties[b]:("hotel_state_code"===b||"car_pickup_state"===b||"car_dropoff_state"===b)&&a[b].length>2?delete window.IntentMediaProperties[b]:"hotel_country_code"===b&&a[b].length>3?delete window.IntentMediaProperties[b]:window.IntentMediaProperties[b]=a[b])}},b.intentMedia.invoke=function(){h(!0)},b.intentMedia.fillExitUnit=function(){"object"==typeof window.IntentMedia&&"function"==typeof window.IntentMedia.fill_exit_unit&&window.IntentMedia.fill_exit_unit()},b.intentMedia.pageIdUpdated=function(){"object"==typeof window.IntentMedia&&"function"==typeof window.IntentMedia.page_id_updated&&window.IntentMedia.page_id_updated()},b.intentMedia.isIntentMediaLoaded=function(){return"object"==typeof window.IntentMedia};var t=new b.AdProduct("IntentMediaAds");t.initialize=g,t.clear=j,t.ensureVisibleAdsAreLoaded=k,t.refresh=i,t.filterAdSlots=n,t.loadIntentMedia=h,t.reloadIMScript=l,t.callIntentMediaApi=m,t.getEncodedPropertiesUrl=o,t.addClientPropertiesToModel=p,t.addCookiePropertiesToModel=q,b.registerAdProduct(t)}(window.document,window.expads=window.expads||{}),function(a,b,c){"use strict";var d={},e={},f=b.utils.isFunction,g=b.utils.extractValue;b.events.preInitialize.attachHandler(function(){e={},b.utils.isEmptyObject(m(b.slots))||(b.utils.isLocalStorageAvailable()&&null!==window.localStorage.getItem("com.expedia.meso.targeting")?b.logging.logTrxEvent("localStorageTargeting",["localStorageTargeting=100"]):b.logging.logTrxEvent("localStorageTargeting",["localStorageTargeting=0"]))});var h=function(a){for(var b in a)a.hasOwnProperty(b)&&j(a[b])},i=function(a){if(a&&a.slots)for(var c in a.slots)if(a.slots.hasOwnProperty(c)){a.slots[c].rendered=!1;var d=A(a.slots[c].selector);null===d||b.utils.isVisible(d)||M(d)}},j=function(a){a.initialized=!1,a.adToLoad!==c&&i(a.adCalls[a.adToLoad])},k=function(a){for(var b in a)a.hasOwnProperty(b)&&"object"==typeof a[b]&&l(a[b])},l=function(a){if(a.initialized===!0)try{t(a,d)}catch(c){b.logging.logError(c,["adAction=simplifiedAds.ensureVisibleAdsAreLoadedForSlot"])}},m=function(a){var b,d,f={};for(b in a)a.hasOwnProperty(b)&&(d=a[b],d!==c&&d.adCalls!==c&&d.adDefault!==c&&(f[b]=d));for(b in e)e.hasOwnProperty(b)&&!f.hasOwnProperty(b)&&(f[b]=e[b]);return f},n=function(a){b.analytics=b.analytics||{},c===b.analytics.simplifiedAdsRequested&&(b.analytics.simplifiedAdsRequested=(new Date).getTime());for(var d in a)a.hasOwnProperty(d)&&(o(a[d]),e[d]=a[d])},o=function(a){if(a.initialized!==!0&&a.adToLoad&&a.adCalls[a.adToLoad]){var c="";try{b.utils.performance.clearAndMark("expedia.ads.simplifiedads.requested"),c=a.adToLoad;var d=a.adCalls[c],e=d.url;b.utils.ajax({url:B(e,a.updatedTargeting,d),done:function(b){return q(b,a,c)},fail:function(){return w(a,c)},dataType:"json",encode:!1})}catch(f){b.logging.logError(f,["adAction=simplifiedAds.initializeSlot"]);try{w(a,c)}catch(g){b.logging.logError(f,["adAction=simplifiedAds.initializeSlot.errorHandler"])}}}},p=function(a,b){h(a),e={};for(var c in a)a.hasOwnProperty(c)&&(a[c].adToLoad=b);n(a)},q=function(a,c,e){try{d=a||{};var f=c.adCalls[e],g=c.adDefault;g.adCalls[e].slots;a?(r(d,f,e,g),t(c,d),d.thirdPartyImpressionURL&&z(d.thirdPartyImpressionURL,d),d.delayedImpressionURL&&z(d.delayedImpressionURL,d),b.events.postMarqueeCallSuccess.fire(a)):(b.logging.logMessage("adAction=simplifiedAds.successHandler pageToDisplay="+e+" no data returned from DFP"),t(c,null),w(c,e))}catch(h){b.logging.logError(h,["adAction=simplifiedAds.successHandler","pageToDisplay="+e]),w(c,e)}finally{c.initialized=!0,b.utils.performance.clearAndMark("expedia.ads.simplifiedads.rendered"),b.utils.performance.clearAndMeasure("Time to Render SimplifiedAds","expedia.ads.simplifiedads.requested","expedia.ads.simplifiedads.rendered")}},r=function(a,d,e,f){try{var g;c===b.analytics.simplifiedAdsReturned&&(b.analytics.simplifiedAdsReturned=(new Date).getTime()),b.renderedAds[d.path]={},b.renderedAds[d.path].renderedSlots=[];for(g in f.adCalls[e])f.adCalls[e].hasOwnProperty(g)&&(b.renderedAds[d.path][g]=f.adCalls[e][g]);for(g in a)a.hasOwnProperty(g)&&"string"==typeof a[g]&&(b.renderedAds[d.path][g]=a[g]);b.renderedAds[d.path].url=d.url,b.renderedAds[d.path].path=d.path,b.renderedAds[d.path].targeting=d.targeting}catch(h){b.logging.logError(h,["adAction=simplifiedAds.recordAdCall","pageToDisplay="+e])}},s=function(a,b,c){if(a&&b)for(var d in b)"rendered"===d||a.hasOwnProperty(d)&&!c||(a[d]=b[d]);return a},t=function(a,c){try{var e=a.adToLoad,f=a.adCalls[e],g=f.slots,h=f.path,i=a.adDefault.adCalls[e].slots,j="";b.configuration.sitePath&&d.siteToURLMap&&(j=x(d.siteToURLMap));for(var k in g){var l=g&&g[k]||null,m=i&&i[k]||null,n=c&&c[k]||null;u(l,m,n,h,k,c,j)}}catch(o){throw b.logging.logError(o,["adAction=simplifiedAds.displayVisibleAds"]),o}},u=function(a,c,d,e,f,g,h){try{if(a=s(a,c,!1),a.rendered===!0)return;var i=A(a.selector);if(!b.utils.isVisible(i))return M(i);a.rendered=!0,d?(v(f,d,a,e,h),d.thirdPartyImpressionURL&&"string"==typeof d.thirdPartyImpressionURL&&d.thirdPartyImpressionURL.length>0&&z(d.thirdPartyImpressionURL,g)):a&&(a.url||a.hasOwnProperty("devices"))?(a=s(a,c,!0),L(i,a)):M(i)}catch(j){throw b.logging.logError(j,["adAction=simplifiedAds.displayVisibleAds","id="+f]),j}},v=function(e,f,g,h,i){try{var j;d.clickThroughURL!==c&&d.clickThroughURL.length>0&&d.baseClickThroughURL!==c&&d.baseClickThroughURL.length>0&&(j=d.clickThroughURL);var k=function(a,d){d!==c&&(b.renderedAds[d]=b.renderedAds[d]||{},b.renderedAds[d].renderedSlots=b.renderedAds[d].renderedSlots||[],b.renderedAds[d].renderedSlots.indexOf(a)===-1&&b.renderedAds[d].renderedSlots.push(a))},l=function(a){d&&d.linkOff&&("new-window"===d.linkOff?a.setAttribute("target","_blank"):"same-window"===d.linkOff&&a.setAttribute("target","_top"))},m=function(b,c){var d=a.createElement("a"),e=a.createElement("div");d.className="clickThroughURL",d.setAttribute("href",c),e.style.width="100%",e.style.height="100%",e.style.margin="0",e.style.padding="0",d.appendChild(e),l(d),C(b,"clickThroughURL"),b.appendChild(d)},n=function(b,c){var d=a.createElement("a");d.className="clickThroughURL",d.setAttribute("href",c),l(d),$(b).wrap(d)},o=function(b,c){var d=A(b.selector),e=c.hasOwnProperty("text")?c.text:"",f=b.hasOwnProperty("clickThroughURL")||b.hasOwnProperty("useClickThroughURL")&&b.useClickThroughURL===!0,g=c.hasOwnProperty("clickThroughURL");if(!d)return void p("No element with selector ["+b.selector+"] to add sponsored text to");if(f&&g){var h=a.createElement("a");return h.className="clickThroughURL",h.setAttribute("href",c.clickThroughURL),h.innerText=e,l(h),void d.appendChild(h)}(f||g)&&p("Returned and requested sponsored texts have mismatched clickThroughUrl expectations"),d.innerText=e},p=function(a){b.logging.logMessage(a,["adAction=simplifiedAds.populateAdContainer","path="+h,"id="+e])},q=A(g.selector);if(L(q,f),g.useClickThroughURL&&(i?m(q,i):f.clickThroughURL!==c&&f.clickThroughURL.length>0&&f.baseClickThroughURL!==c&&f.baseClickThroughURL.length>0?m(q,f.clickThroughURL):j!==c&&j.length>0&&m(q,j)),g.hasOwnProperty("SCRIM")){if(!f.hasOwnProperty("SCRIM"))throw new Error("No scrim obj returned from dfp");if(!b.utils.isObject(g.SCRIM)||!b.utils.isObject(f.SCRIM))throw new Error("Requested and returned scrims must be objects.");
var r=f.SCRIM;if(r&&r.useClickThroughURL&&r.clickThroughURL){var s=A(r.selector);null!=s&&n(s,r.clickThroughURL)}var t;for(t in g.SCRIM)f.SCRIM.hasOwnProperty(t)?o(g.SCRIM[t],f.SCRIM[t]):p("Requested sponsored text with key ["+t+"] was not returned from dfp in scrim")}k(e,h)}catch(u){b.logging.logError(u,["adAction=simplifiedAds.populateAdContainer","path="+h,"id="+e])}},w=function(a,d){try{var e,f,g,h=a.adDefault,i=h.adCalls[d].slots,j=a.adCalls[d].slots;for(e in i)i.hasOwnProperty(e)&&(f=i[e],j!==c&&j[e]!==c&&(j[e].rendered=!0),g=A(f.selector),L(g,f))}catch(k){b.logging.logError(k,["adAction=simplifiedAds.errorHandler","pageToDisplay="+d])}finally{a.initialized=!0}},x=function(a){var c={};c=Object.keys(a).filter(function(a){return a}).reduce(function(b,c){var d=c.toLowerCase().split("/"),e=d[0]+"."+d[1]+"_"+d[2];return b[e]=a[c],b},{});var d=c[b.configuration.sitePath.toLowerCase()];return d},y=function(a){return a.indexOf("https:")>-1},z=function(a,c){try{if(!y(a))throw new Error(a+" is non-https thirdPartyImpressionURL");(new Image).src=encodeURI(a)}catch(d){var e=c,f=[];f.push("adAction=","simplifiedAds.fireImpressionBeacon"),f.push("url=",encodeURI(a)),f.push("orderId="+encodeURIComponent(e.orderID||"")),f.push("lineItemId="+encodeURIComponent(e.lineItemID||"")),f.push("creativeId="+encodeURIComponent(e.creativeID||"")),f.push("adUnitId="+encodeURIComponent(e.adUnitID||"")),b.logging.logError(d,f)}},A=function(b){return a.querySelector(b)},B=function(a,c,d){var e=function(a,c,d){var e,h,i=a,j="";try{d.targeting={};for(e in b.mergedTargeting)b.mergedTargeting.hasOwnProperty(e)&&(d.targeting[e]=b.mergedTargeting[e]);for(e in c)c.hasOwnProperty(e)&&(d.targeting[e]=c[e]);if("0"==d.targeting.d||"1"==d.targeting.d){var k=new Error("d is corrupted in simplifiedAds , value="+d.targeting.d);f(g(window.dctk,["logging","logError"]))?window.dctk.logging.logError("expads",k):console.error(k)}for(e in d.targeting)if(d.targeting.hasOwnProperty(e)){if(h=j.length>0?"&"+encodeURIComponent(e)+"=":""+encodeURIComponent(e)+"=",b.utils.isArray(d.targeting[e]))for(var l=0;l<d.targeting[e].length;l++)l>0&&(h+=","),h+=encodeURIComponent(d.targeting[e]);else h+=encodeURIComponent(d.targeting[e]);j+=h}j.length>0&&(j="&t="+encodeURIComponent(j),i=a.replace(/&t=[^&]*/i,j))}catch(m){b.targeting=b.targeting||{},b.logging.logError(m,["adAction=simplifiedAds.updateTargeting","url="+a,"targeting="+c,"expads.targeting="+b.targeting])}return i},h=function(a){var c;try{c=a.replace(/&c=[^&]*/i,"&c="+(new Date).getTime())}catch(d){b.logging.logError(d,["adAction=simplifiedAds.updateCacheBuster","url="+a]),c=a}return c};return a=h(a),a=e(a,c,d)},C=function(a,b){for(var c=a.children.length-1;c>-1;c--)a.children[c].className===b&&a.removeChild(a.children[c])},D=function(a,c){var d=c.videoPoster,e=a.querySelector("source"),f=c.url;e.src!==f&&(a.onload=function(){b.utils.performance.clearAndMark("expedia.ads.video.simplifiedads.rendered"),b.utils.performance.clearAndMeasure("Time to Render Video SimplifiedAds","expedia.ads.video.simplifiedads.requested","expedia.ads.video.simplifiedads.rendered")},a.setAttribute("poster",d),e.setAttribute("src",f),a.load())},E=function(a){var b=a.querySelector("source");a.pause(),b.removeAttribute("src"),a.removeAttribute("poster")},F=function(a,c){var d=c.url,e=c.altText;a.onload=function(){b.utils.performance.clearAndMark("expedia.ads.simplifiedads.rendered"),b.utils.performance.clearAndMeasure("Time to Render SimplifiedAds","expedia.ads.simplifiedads.requested","expedia.ads.simplifiedads.rendered"),b.events.postMarqueeImageLoaded.fire(c)},a.src=d,a.setAttribute("data-src",d),a.setAttribute("alt",e)},G=function(a){a.src="",a.removeAttribute("data-src"),a.removeAttribute("alt")},H=function(a,b){var d=new Image,e=b.url,f=b.altText,g=a.style.background;if(g===c||g.indexOf(e)===-1){if(0===e.length)return void J(a);F(d,b),a.style.backgroundImage="url("+e+")",a.setAttribute("data-src",e),a.setAttribute("alt",f),a.style.backgroundPosition=K(b)}},I=function(a){a.removeAttribute("data-src"),a.style.backgroundImage=""},J=function(a){a.removeAttribute("data-src"),a.style.backgroundImage=""},K=function(a){var b="",c="",d=!1,e="left",f="top";if(a.hasOwnProperty("focalPoint")){var g=a.focalPoint.split(" ");for(var h in g)switch(g[h].toLowerCase()){case"center":d=!0;break;case"top":c="top";break;case"center-top":c="25%";break;case"center-bottom":c="75%";break;case"bottom":c="bottom";break;case"left":b="left";break;case"center-left":b="25%";break;case"center-right":b="75%";break;case"right":b="right"}}return b=""!==b?b:d?"center":e,c=""!==c?c:d?"center":f,b+" "+c},L=function(a,d){try{d.hasOwnProperty("devices")&&N(d);var e=d.url,f=e!==c,g=f&&e.length>0;if(!a)throw new Error("No element set to set display to");if(f)switch(a.tagName){case"VIDEO":D(a,d);break;case"IMG":F(a,d);break;case"DIV":H(a,d);break;default:throw new Error("Element not handled by setDisplayElement")}b.utils.toggleCollapsedExpanded(a,g)}catch(h){b.logging.logError(h,["adAction=simplifiedAds.setDisplayElement"])}},M=function(a){try{if(!a)throw new Error("No element set to clear display of");switch(a.tagName){case"VIDEO":E(a);break;case"IMG":G(a);break;case"DIV":I(a);break;default:throw new Error("Element not handled by clearDisplayElement")}b.utils.toggleCollapsedExpanded(a,!1),C(a,"clickThroughURL")}catch(c){b.logging.logError(c,["adAction=simplifiedAds.clearDisplayElement"])}},N=function(a){if(a.hasOwnProperty("devices")){var c=a.devices,d=b.utils.getDeviceType();d||(b.logging.logMessage("Select HERO SKIN by Device: DeviceType not set in config, default to Desktop"),d="Desktop"),d=d.toLowerCase();for(var e in c)if(c.hasOwnProperty(e)&&d.indexOf(e.toLowerCase())>=0){var f=c[e];for(var g in f)f.hasOwnProperty(g)&&(a[g]=f[g]);break}}},O=new b.AdProduct("SimplifiedAds");O.initialize=n,O.clear=h,O.ensureVisibleAdsAreLoaded=k,O.filterAdSlots=m,O.refresh=p,b.registerAdProduct(O)}(window.document,window.expads=window.expads||{}),function(a){"use strict";function b(a){a=a||{},this.id=a.id,this.data={slot:a},this.items=[],this.containerElement=document.querySelector("#body-"+this.id+" .travelads-wrapper"),this.rulesConfig={validVariants:[0,1,2,3,5,6,7],exposureLogVariants:[0,1,2,3,5,6,7],makeGetWinningAdsCall:[1,2,3,5,6,7],renderVariants:[1,2,5,6,7],pageViewVariants:[1,2,3,5,6,7],excludeForVacationRental:[6]},this.experiment=null,this.rulesEngine=null,this.isVacationRental=!1}function c(a,b){this.element=a,this.hotel=b||{},this.isImpressionFired=!1,this.isAriaVisible=!1}function d(a,b){a=a||{},a.validVariants=a.validVariants||[],a.exposureLogVariants=a.exposureLogVariants||[],a.pageViewVariants=a.pageViewVariants||[],a.makeGetWinningAdsCall=a.makeGetWinningAdsCall||[],a.renderVariants=a.renderVariants||[],a.excludeForVacationRental=a.excludeForVacationRental||[],this.config=a,this.experiment=b}a.expads=a.expads||{},a.expads.configuration=a.expads.configuration||{};var e=!1,f=!1,g={},h=expads.utils.ClassManager,i=(Array.prototype.indexOf.call.bind(Array.prototype.indexOf),["0.0","0.5","1.0","1.5","2.0","2.5","3.0","3.5","4.0","4.5","5.0","5.5","6.0"]),j=function(a){expads.logging.logMessage("TravelAds Carousel log: "+a)},k=function(a,b){"function"==typeof a&&a(b)},l=function(a){e||n(a)},m=function(){var a=[];return expads&&expads.configuration&&(a=expads.configuration.travelAds||[]),a},n=function(c){if(!e){if(Array.isArray(c)){if("function"!=typeof a.define||!a.define.amd)return void j("Missing requirejs support.");c.forEach(function(a){return a&&"object"==typeof a?a.id?g[a.id]?void j('The travel ad "'+a.id+'" is already initialized.'):void(g[a.id]=new b(a)):void j("Invalid slot id."):void j("slot must be JSON.")}),define("expads/travel-ad",function(){return function(a){return g.hasOwnProperty(a)?g[a]:(j("Requested travel ad that is not present"),null)}}),e=!0}else j("Invalid slots.");j("Travel ads already initialized")}};b.prototype={validateServiceResponse:function(a){return null===a||"object"!=typeof a?(j("Response data must be JSON type."),!1):null===a.travelAdsResponse||"object"!=typeof a.travelAdsResponse?(j('Response data must have property "travelAdsResponse"'),!1):Array.isArray(a.travelAdsResponse.hotels)?0!==a.travelAdsResponse.hotels.length||(j("No hotels in travelads response"),!1):(j("Invalid hotel list."),!1)},validateFields:function(a){return"object"!=typeof a?(j("Invalid fields data"),!1):!!a.regionId||(j("Invalid regionId"),!1)},formatDates:function(a,b){var c="mm/dd/yyyy";require(["exp_datetimeformats","uitk_i18n"],function(d,e){var f=e&&e.locale||" ",g=d&&d.dateTimeSettings[f]&&d.dateTimeSettings[f].date.format["short"];a.startDate=new expads.utils.ParseDate(a.startDate,g).formatDate(c),a.endDate=new expads.utils.ParseDate(a.endDate,g).formatDate(c),b()})},callGetWinningAdsService:function(a,b){var c=expads.utils.toKeyPairParams(a),d=expads.utils.getCorrespondingExpwebEndpoint(),e=[],f=(new Date).getTime(),g=d+"/api/travelAds/TravelAds-Search-Data";e.push("ad=travelAdsCarousel"),expads.utils.ajax({url:g,type:"POST",contentType:"application/x-www-form-urlencoded",data:c,dataType:"json",done:function(a){e.push("status=success"),expads.logging.logTrxEvent((new Date).getTime()-f,e);var c=a&&a.travelAdsResponse&&a.travelAdsResponse.hotels||[];c.length>0&&require(["dctk/dctk"],function(a){var b=26538;a.onReady(function(){"function"==typeof a.evaluateExperimentAndLog&&a.evaluateExperimentAndLog({id:b})})}),k(b,a)},fail:function(a){e.push("status=fail"),expads.logging.logTrxEvent((new Date).getTime()-f,e),j("Response data is not processed with a status of "+a.status+".")}})},run:function(a,b){var c=expads.configuration.site||{};if(c&&c.locale&&(a.locale=c.locale),this.rulesEngine=new d(this.rulesConfig,this.experiment),this.rulesEngine.isExperimentPresent()===!0){if(this.rulesEngine.isValidVariant()===!1)return j("Invalid abacus bucket for travelAds"),k(b,!1),!1;if(this.rulesEngine.isExposureLogEligible()===!0&&(this.experiment.exposureLogged||"function"!=typeof this.experiment.exposureLog||this.experiment.exposureLog()),this.rulesEngine.isGetWinningAdsCallEligible()===!1)return k(b,!1),!1}var e=this;this.formatDates(a,function(){return e.validateFields(a)===!1?(k(b,!1),!1):void e.callGetWinningAdsService(a,function(a){var c=expads.configuration.localizationMap||{},d=c["travel.ad.title"]||"",f=c["native.image.links.title"]||"";e.validateServiceResponse(a)===!0&&(e.data=e.data||{},e.data.slot=e.data.slot||{},e.data.slot.title=d,e.data.response=a.travelAdsResponse,e.data.count=a.travelAdsResponse.hotels.length,e.data.response.hotels=e.data.response.hotels||[],e.data.response.hotels.forEach(function(a){a.sponsored=f}),e.render(function(a){return k(b,a),!0}))})})},render:function(b){try{"function"==typeof a.define&&a.define.amd?require(["uitk","infositeData","adtoolkit/template-travel-ads"],function(a,c){this.isVacationRental=c&&c.isVacationRental,this.containerElement||(j("Invalid TravelAd element."),k(b,!1));var d=expads.configuration.templates.travelAd;"function"!=typeof d&&(j("Missing handlebars template."),k(b,!1)),this.containerElement.style.display="none",this.containerElement.innerHTML=d(this.data),this.rulesEngine.isRenderEligible(this.isVacationRental)&&(this.containerElement.style.display="block"),$(this.containerElement.querySelector(".travelads-carousel")).uitk_carousel(),a.mediaquery.publishAgain(),this.initializeTravelAdItems(),this.setHotelStars(),this.impressionBeaconHandler(a);for(var e=this.containerElement.querySelectorAll(".uitk-carousel-item .flex-card .flex-figure .image img"),f=0;f<e.length;f++)e[f].setAttribute("alt"," ");this.rulesEngine.isPageViewBeaconEligible()&&this.pageViewBeaconHandler(a),k(b,!0)}.bind(this)):j("Missing requirejs support.")}catch(c){j(c)}},initializeTravelAdItems:function(){if(this.containerElement instanceof Element){var a=this.data.response.hotels,b=this.containerElement.querySelectorAll(".uitk-carousel-item");if(Array.isArray(a)&&a.length===b.length)for(var d=0;d<b.length;d++)a[d]?this.items.push(new c(b[d],a[d])):j("Invalid hotel data.");else j("Invalid hotel list.")}else j("Invalid TravelAd element.")},impressionBeaconHandler:function(a){if(this.containerElement instanceof Element){var b=this.containerElement.querySelector(".uitk-carousel-pagecontrol-prev"),c=this.containerElement.querySelector(".uitk-carousel-pagecontrol-next");if(this.checkImpressionBeacon(),b&&b.addEventListener("click",this.delayCheckImpressionBeacon.bind(this)),c&&c.addEventListener("click",this.delayCheckImpressionBeacon.bind(this)),a&&"function"==typeof a.subscribe){a.subscribe("debounced.resize",this.checkImpressionBeacon.bind(this)),a.subscribe("debounced.scroll",this.checkImpressionBeacon.bind(this));var d=this;require(["hammer"],function(a){var b=new a.Manager(document.querySelector(".travelads-carousel"));b.add(new a.Pan({threshold:0,pointers:0,direction:a.DIRECTION_HORIZONTAL})),b.on("pan",function(a){setTimeout(function(){d.checkImpressionBeacon()},1e3)})})}else j("Invalid uitk.")}else j("Invalid TravelAd element.")},checkImpressionBeacon:function(){if(this.containerElement instanceof Element){var a='.uitk-carousel-item:not([aria-hidden="true"])',b=this.containerElement.querySelectorAll(a),d=document.getElementsByClassName("travelads-carousel")[0];b.length>0?this.items.forEach(function(a){if(a instanceof c){var b=a.element,e=expads.utils.isOverlappingLaterally(d,b);a.isAriaVisible=e,a.fireImpressionBeacon()}else j("Invalid TravelAdItem.")}):j("No element in carouselCurrent to check for impression beacon.")}else j("Invalid TravelAd element.")},delayCheckImpressionBeacon:function(){if(this.containerElement instanceof Element){var b=this.containerElement.querySelector(".uitk-carousel-items");if(b instanceof Element){var c=a.getComputedStyle(b)["transition-duration"],d="ms"===c.substring(c.length-2);c=parseFloat(c)*(d?1:1e3)||0,setTimeout(this.checkImpressionBeacon.bind(this),1.5*c)}else j('Invalid element ".uitk-carousel-items".')}else j("Invalid TravelAd element.")},pageViewBeaconHandler:function(a){this.checkPageViewBeacon(),a.subscribe("debounced.resize",this.checkPageViewBeacon.bind(this))},checkPageViewBeacon:function(){if(!f&&this.isCarouselVisible())if(this.data.response&&this.data.response.pageViewBeacon){var a=document.createElement("img"),b=this.data.response.pageViewBeacon;a.setAttribute("data-page-view-beacon",!0),a.setAttribute("src",b),a.setAttribute("class","ad-visuallyhidden"),this.containerElement.appendChild(a),f=!0}else j("Invalid page view beacon URL.")},setHotelStars:function(){this.items.forEach(function(a){var b=a.hotel.starRating;if(i.indexOf(b)>=0){var c=a.element.querySelector(".hotel-information .icon"),d=new h(c);d.removeClass("icon-stars5-0"),d.addClass("icon-stars"+b.replace(".","-"))}else j("Invalid star rating (0.0 to 6.0)")})},isCarouselVisible:function(){if(this.containerElement instanceof Element){var a=this.containerElement.querySelector(".travelads-container");return"none"!==getComputedStyle(a).display}j("Invalid container element")}},c.prototype={fireImpressionBeacon:function(){var a=expads.utils.isPartiallyViewable(this.element);if(!this.isImpressionFired&&this.isAriaVisible&&a){var b=this.hotel.impressionUrl;if(b&&"string"==typeof b)if(this.element instanceof Element&&this.element.parentNode){var c=this.element.parentNode,d=document.createElement("img");d.setAttribute("data-impression-beacon",!0),d.setAttribute("src",b),d.setAttribute("class","ad-visuallyhidden"),c.appendChild(d),this.isImpressionFired=!0}else j("Invalid hotel element");else j("Invalid impressionUrl")}}},d.prototype={isExperimentPresent:function(){return this.experiment&&this.experiment.hasOwnProperty("bucket")},isValidVariant:function(){return this.isExperimentPresent()&&this.config.validVariants.indexOf(this.experiment.bucket)>=0},isExposureLogEligible:function(){return!this.isExperimentPresent()||this.isExperimentPresent()&&this.isValidVariant()&&this.config.exposureLogVariants.indexOf(this.experiment.bucket)>=0},isGetWinningAdsCallEligible:function(){return!this.isExperimentPresent()||this.isExperimentPresent()&&this.isValidVariant()&&this.config.makeGetWinningAdsCall.indexOf(this.experiment.bucket)>=0},isRenderEligible:function(a){return!this.isExperimentPresent()||this.isExperimentPresent()&&this.isValidVariant()&&this.meetsVacationRentalRenderCriteria(a)&&this.config.renderVariants.indexOf(this.experiment.bucket)>=0},meetsVacationRentalRenderCriteria:function(a){var b=this.config.excludeForVacationRental.indexOf(this.experiment.bucket)>=0;return!b||b&&!a},isPageViewBeaconEligible:function(){return!this.isExperimentPresent()||this.isExperimentPresent()&&this.isValidVariant()&&this.config.pageViewVariants.indexOf(this.experiment.bucket)>=0}};var o=new expads.AdProduct("TravelAds");o.initialize=n,o.filterAdSlots=m,o.ensureVisibleAdsAreLoaded=l,o.ads=g,o.RulesEngine=d,expads.registerAdProduct(o)}(window),function(a,b,c){"use strict";var d,e=b.utils.defer(b.ensureVisibleAdsAreLoaded),f=[],g=["(min-width: 960px)","(min-width: 726px) and (max-width: 959px)","(max-width: 725px)"],h=function(a,b){for(;a.length>0;)a.pop().removeListener(b)},i=function(){h(f,j),a.uitk!==c&&"function"==typeof a.uitk.subscribe?(m(e),n(b.utils.onScroll)):f=k(g)},j=function(a){a!==c&&a.matches===!0&&e()},k=function(a){var c,d,e,f=[];try{for(c=0;c<a.length;c++)e=l(a[c]),null!==e&&f.push(e);if(d=b.configuration.mediaQueries||[],b.utils.isArray(d))for(c=0;c<d.length;c++)e=l(d[c]),null!==e&&f.push(e)}catch(g){b.logging.logError(g,["Custom media queries not supported"])}return f},l=function(b){var d=null;return"function"==typeof a.matchMedia&&(d=a.matchMedia(b),d!==c&&"function"==typeof d.addListener&&d.addListener(j)),d},m=function(c){return d||(d=a.uitk.subscribe("mediaquery.matched",function(){b.flags&&a.expads.flags.isFetchingSearchResults||c()}),b.events.postSlotRenderEnded.attachHandler(function(){a.expads.flags&&(a.expads.flags.isFetchingSearchResults=!1)})),d},n=function(b){return a.uitk.subscribe("debounced.scroll",b)};b.events.postInitialize.attachHandler(i),a.addEventListener?a.addEventListener("load",i,!1):a.attachEvent&&a.attachEvent("onload",i)}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";expads.adtoolkit=expads.adtoolkit||{},expads.adtoolkit.initialize=function(d){expads.adtoolkit.data=expads.adtoolkit.data||{},expads.adtoolkit.data.adcontext=d,"function"==typeof a.define&&a.define.amd&&require(["jquery"],function(e){function f(b){var c,d={ville:N?"BOT":"PEOPLE",pageName:K},e={};if(O&&(d.li=O),I&&(d.kuid=b.krux.getKrux(I).user),b&&b.utils&&b.utils.parseQueryParams){c=b.utils.parseQueryParams(a.location.search),e=g(c);for(var f in e)d[f]=e[f]}return d}function g(a){var b,c=["mdpcid","icmcid","affcid","olacid","semcid","emlcid"],d={},e={};for(var f in a)d[f.toLowerCase()]=a[f];for(var g=0;g<c.length;g++)b=c[g],d[b]&&(e[b]=d[b]);return e}function h(){S&&(T&&U?Q.resolve("all components loaded"):V?Q.resolve("all components loaded but slotinfo failed"):G&&Q.resolve("display ads disabled, skipping service calls"))}function i(a){v(a),W||(W=!0,Q.reject(a))}function j(a,b,d){d!==c&&null!==d&&""!==d&&(a[b]=d)}function k(a,b,d){d!==c&&null!==d&&0!==d.length&&(a[b]=d.join(","))}function l(b){if(b=b||{},b.done=b.done||function(){},b.fail=b.fail||function(){},b.beforeSend=b.beforeSend||function(){},b.dataType=b.dataType||"",b.type=b.type||"GET",b.cache=b.cache||!1,b.xhrFields=b.xhrFields||{},b.encode===c&&(b.encode=!0),Y<10&&a.XDomainRequest){b.data&&b.url?b.url=b.url+"?"+e.param(b.data):b.url=b.url||null;var d=new XDomainRequest;b.encode?d.open(b.type,encodeURI(b.url)):d.open(b.type,b.url),d.onprogress=function(){},d.ontimeout=function(){},d.onload=function(){var a=d.responseText;if(b.dataType&&"json"===b.dataType.toLowerCase()&&"string"==typeof a)try{a=JSON.parse(a)}catch(c){v("cannot parse data returned from service - ad cannot be loaded as a result")}b.done(a,d)},d.onerror=function(){b.fail(d)},d.send()}else e.ajax({url:b.url,dataType:b.dataType,data:b.data,timeout:2e3,cache:b.cache,xhrFields:b.xhrFields,beforeSend:b.beforeSend,success:b.done,error:b.fail})}function m(a){return"function"!=typeof String.prototype.trim?a.replace(/^\s+|\s+$/g,""):a.trim()}function n(){function b(b){var c,d=[];for(var f in b.slots)if(c="call to slotInfo service returned invalid data - ads cannot be loaded as a result",b.slots.hasOwnProperty(f)&&e("#"+f).length>0){var g=b.slots[f],h=e("#"+f).data("adwidth"),i=e("#"+f).data("adheight"),j=e("#"+f).data("isnative"),k=!0;if(j)k=!1;else for(var l in g.size)if(g.size.hasOwnProperty(l)){var m=g.size[l];m.width==h&&m.height==i&&(k=!1)}k?(c=f+" had an invalid size from the slotinfo service.",d.push(f),v(c)):(g.width=h,g.height=i)}for(var n in d){var o=d[n];delete b.slots[o],a.expads&&a.expads.slots&&delete a.expads.slots[o]}}var f,g=a.expads.configuration.sitePath,k=a.expads.configuration.displayAdSlots||[],m=!1,n=function(){var a,b;if(0!==k.length)for(f=k[0].pagePath,a=1;a<k.length;a++)if(b=k[a].pagePath,(f||b)&&f!==b){f=c,m=!0;break}},o=function(){var b,d,e;for(a.expads.slots=a.expads.slots||{},b=0;b<k.length;b++){var f=k[b];f.id===c||""===f.id||f.width===c||""===f.width||f.height===c||""===f.height?v("a displayAd tag was missing some required data and will not be rendered"):f.pagePath===c||""===f.pagePath?v("the displayAd tag with id "+f.id+" did not specify a pagePath, but a sitePath was configured in the adConfiguration tag. Skipping this displayAd"):(d="/"+a.expads.configuration.networkId+"/"+g+"/"+f.pagePath+"/",f.slotIdOverride!==c&&""!==f.slotIdOverride?(d+=f.slotIdOverride,e=f.slotIdOverride):(d+=f.id,e=f.id),a.expads.slots[f.id]={name:e,path:d,width:f.width,height:f.height})}T=!0,R.resolve("eligible to make adinfo service call"),h()},p=function(){var c,d={};j(d,"siteId",H),j(d,"locale",J),j(d,"pageName",K),l({url:F+"/adinfo/slotinfo",dataType:"json",data:d,cache:!0,beforeSend:function(){c=(new Date).getTime()},done:function(d){expads.utils.performance.clearAndMark("adConfiguration.processSlotInfoServiceResponse.start");var f=(new Date).getTime()-c;w("adSlotsLatency",f),u(d,"slots")?(b(d),T=!0,R.resolve("eligible to make adinfo service call"),a.expads=a.expads||{},a.expads.slots=e.extend(!0,{},a.expads.slots,d.slots)):(R.reject("prevent adinfo targeting service call because of invalid slot info data"),V=!0),h(),expads.utils.performance.clearAndMark("adConfiguration.processSlotInfoServiceResponse.end"),expads.utils.performance.clearAndMeasure("Time to process Slot Info client side call response","adConfiguration.processSlotInfoServiceResponse.start","adConfiguration.processSlotInfoServiceResponse.end")},fail:function(){V=!0,w("adSlotsFailure","0"),h(),R.reject("prevent adinfo service call since slot info failed")}})},q=function(a){return a&&a.slotInfo&&a.slotInfo.slots&&!expads.utils.isEmptyObject(a.slotInfo.slots)},r=function(a){expads.utils.performance.clearAndMark("adConfiguration.processProvidedSlotInfoData.start"),b(a.slotInfo),expads.slots=e.extend(!0,{},expads.slots,a.slotInfo.slots),T=!0,R.resolve("eligible to make adinfo service call"),h(),expads.utils.performance.clearAndMark("adConfiguration.processProvidedSlotInfoData.end"),expads.utils.performance.clearAndMeasure("Time to process Slot Info server side slots","adConfiguration.processProvidedSlotInfoData.start","adConfiguration.processProvidedSlotInfoData.end")};g!==c&&""!==g?o():(n(),m===!0?i("displayAd tags on the page specified different pagePaths - ads cannot be loaded as a result"):q(d)?r(d):p())}function o(b,c,d){R.done(function(){"function"==typeof c&&(d=c,c={}),c=c||{},d=d||h;var g,i="call to targeting service returned invalid data - ads will be loaded without latest targeting";l({url:F+"/adinfo",dataType:"json",cache:!1,data:b,xhrFields:{withCredentials:!0},beforeSend:function(){g=(new Date).getTime()},done:function(b){var i=(new Date).getTime()-g;w("adInfoLatency",i),u(b,"targeting")&&require(["expads"],function(g){U=!0,a.expads.targeting=e.extend(!0,f(g),b.targeting,c),p(a.expads.targeting),d(a.expads.targeting),h()})},fail:function(){w("adInfoFailure","0"),v(i),require(["expads"],function(b){a.expads.targeting=e.extend(!0,f(b),c),p(a.expads.targeting),U=!0,h()})}})})}function p(b){if(b=b||{},b.d){var c=q(b.d);if("string"==typeof c&&3!==c.length)return void v("targeting.d is not a valid TLA");b.pd=b.pd||[],a.expads.utils.containsIgnoreCase(b.pd,c)||b.pd.push(c),b.pd.length>20&&b.pd.shift()}}function q(a){switch(typeof a){case"object":return a.hasOwnProperty(0)?a[0]:(v("Cannot normalize expads.targeting.d expected an array"),"");case"string":return a;default:return v("Cannot normalize expads.targeting.d"),""}}function r(a){var b={};if(a)for(var c=0;c<X.length;c++){var d=X[c];a.hasOwnProperty(d)&&(b[d]=a[d],delete a[d])}return b}function s(){var a={};return x(),j(a,"siteId",H),j(a,"userId",L),j(a,"pageName",K),M>0&&j(a,"memberId",M),k(a,"bkc",P),a}function t(){var a=s();E===!0?setTimeout(function(){require(["expads.targeting"],function(b){var c=r(b);c.dest_region&&!parseInt(c.dest_region)&&v("Invalid dest_region, value should be a region id"),j(a,"dest",c.dest_region),o(a,b)})},0):o(a)}function u(a,b){return a!==c&&"object"==typeof a&&a.hasOwnProperty(b)&&a[b]!==c}function v(a){S?require(["expads"],function(b){b.logging.logMessage(a)}):console!==c&&console.error!==c&&console.error(a)}function w(a,b){a!==c&&require(["dctk/clientLogging"],function(c){switch(a){case"adInfoLatency":c.logTrxEvent("adtkAdInfoLatency",["adtkAdInfoLatency="+encodeURIComponent(b),"adtkAdInfoSuccess=100"]);break;case"adInfoFailure":c.logTrxEvent("adtkAdInfoSuccess",["adtkAdInfoSuccess=0"]);break;case"adSlotsLatency":c.logTrxEvent("adtkAdSlotsLatency",["adtkAdSlotsLatency="+encodeURIComponent(b),"adtkAdSlotsSuccess=100"]);break;case"adSlotsFailure":c.logTrxEvent("adtkAdSlotsSuccess",["adtkAdSlotsSuccess=0"])}})}function x(){for(var a=b.cookie.split(";"),d=function(a){var b=a.split("=");b.length>=2&&(L=b[1])},e=0;e<a.length;e++){var f=m(a[e]),g=f.indexOf("="),h=g>-1?m(f.substr(0,g)):c,i=g>-1?decodeURIComponent(m(f.substr(g+1))):c;if(h!==c&&i!==c)switch(h){case"MC1":d(i)}}}function y(){A===!0&&require(["adtoolkit"],function(a){a.initialize()}),S=!0,h(),C===!1&&z()}function z(){G===!1&&(n(),B===!0?t():require(["adtoolkit-user-info"],function(a){a&&(a.hasOwnProperty("memberId")&&(M=a.memberId),a.hasOwnProperty("userId")&&(L=a.userId),a.hasOwnProperty("isBot")&&(N=!0===a.isBot)),t()})),h()}d.config=d.config||{};var A=d.config.autoInitialize===c||d.config.autoInitialize,B=d.config.autoGenerateUserInfo===c||d.config.autoGenerateUserInfo,C=!!d.config.deferServiceCalls,D=!!d.config.deferGptScriptLoading,E=!!d.config.usePageSpecificTargeting,F=d.config.adInfoServiceUrl,G=!!d.displayAdsDisabled,H=d.siteId,I=d.kruxBrand,J=d.locale,K=d.pageName,L=d.userId,M=d.memberId,N=!!d.isBot,O=d.isLoggedIn,P=[],Q=new e.Deferred,R=new e.Deferred,S=!1,T=!1,U=!1,V=!1,W=!1,X=["dest_region"];a.expads.configuration=a.expads.configuration||{},a.expads.configuration.isExpAdsToDownloadGpt=D,a.expads.configuration.slotTargeting=a.expads.configuration.slotTargeting||{},a.expads.configuration.site=a.expads.configuration.site||{},a.expads.configuration.site.locale=J,e.extend(!0,a.expads.configuration.slotTargeting,d.slotTargeting);var Y=function(){for(var a=3,d=b.createElement("div"),e=d.getElementsByTagName("i");d.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",e[0];);return a>4?a:c}();define("adtoolkit",["expads"],function(a){return{initialize:function(){C===!0&&z(),Q.done(function(){a.initialize()}).fail(function(a){console.log(a)})},refresh:function(b){if(b===c||G===!0)a.refresh();else{var d=s(),e=r(b);j(d,"dest",e.dest_region),o(d,b,function(b){a.refresh(b)})}}}}),e(b).ready(y)})}}(window,document),function(a,b){"use strict";expads.adtoolkit=expads.adtoolkit||{},expads.adtoolkit.configure=function(c){if(expads.adtoolkit.data=expads.adtoolkit.data||{},expads.adtoolkit.data.config=c,"function"==typeof a.define&&a.define.amd){var d=c.advertisementTitle,e=c.collapseEmptyDivs,f=c.breakPoints,g=c.networkId,h=c.sitePath,i=c.collectorWebUrl,j=c.refreshAdModel,k=c.localizationMap,l=c.isMobile||!1,m=c.isTablet||!1,n=l===!0?"Mobile-Phone":m===!0?"Mobile-Tablet":"Desktop",o=c.isHoldout||!1,p=c.environment||"";if(a.expads=a.expads||{},a.expads.environment=p,a.expads.configuration=a.expads.configuration||{},a.expads.configuration.isExpAdsToDownloadGpt=a.expads.configuration.isExpAdsToDownloadGpt||!1,a.expads.configuration.mediaQueries=a.expads.configuration.mediaQueries||[],a.expads.configuration.collapseEmptyDivs=e,a.expads.configuration.networkId=g,a.expads.configuration.collectorWebURL=i,a.expads.configuration.refreshAdModel=j||{},a.expads.configuration.templates=a.expads.configuration.templates||{},a.expads.configuration.localizationMap=k||{},a.expads.configuration.device=a.expads.configuration.device||{},a.expads.configuration.device.isMobile=l,a.expads.configuration.device.isTablet=m,a.expads.configuration.device.deviceType=n,a.expads.configuration.user=a.expads.configuration.user||{},a.expads.configuration.user.isHoldout=o,a.define instanceof Function&&a.define.amd?define("adtoolkit/template-travel-ads",["handlebars"],function(b){var c=a.expads.configuration.travelAds;if(c&&c.length>0){var d=document.querySelector(".travelads-wrapper-template");if(d){var e=b.compile(d.innerHTML);a.expads.configuration.templates.travelAd=e}else expads.logging.logError("Template element does not exist.")}}):expads.logging.logError("Missing require support."),""!==d&&(a.expads.configuration.title=d),""!==h&&(a.expads.configuration.sitePath=h),f!==b){for(var q=0;q<f.length;q++)""!==f[q]&&a.expads.configuration.mediaQueries.push(f[q]);a.require("uitk",function(a){if(a!==b&&a.mediaquery!==b&&"function"==typeof a.mediaquery.register)for(var c=0;c<f.length;c++){var d=f[c];d&&a.mediaquery.register(d,d)}})}}}}(window),function(a,b){"use strict";"function"==typeof a.define&&a.define.amd&&define("adtoolkit/handlebars",["handlebars","adtoolkit"],function(b){function c(a){var b=!1;return a.id||(b=!0,d("id is a required parameter for the displayAd helper")),a.size||(b=!0,d("size is a required parameter for the displayAd helper")),a.size&&"fluid"!==a.size&&a.size.toLowerCase().indexOf("x")===-1&&(b=!0,d("size should have the format 'widthxheight' ")),b}function d(b){"function"==typeof a.define&&a.define.amd&&require(["expads"],function(a){a.logging.logMessage(b)})}var e=a.expads.adtoolkit.data.config.advertisementTitle||"Advertisement";return b.registerHelper("adtk:displayAd",function(d){var f=d.hash;if(!c(f)){a.expads=a.expads||{},a.expads.configuration=a.expads.configuration||{},a.expads.configuration.displayAdSlots=a.expads.configuration.displayAdSlots||[];var g,h=f.pagePath?b.Utils.escapeExpression(f.pagePath):"",i=f.classes?b.Utils.escapeExpression(f.classes):"",j=f.size.toLowerCase().split("x"),k="fluid"===f.size,l=f.collapseEmptyDiv,m=b.Utils.escapeExpression(e),n={},o="overflow:hidden;margin-left:auto;margin-right:auto;",p="";return k?(o+="width:100%;",p+=' data-isnative="true"',n.width="fluid",n.height="fluid"):(n.width=b.Utils.escapeExpression(parseInt(j[0],10)),n.height=b.Utils.escapeExpression(parseInt(j[1],10)),o+="width:"+n.width+"px;max-height:"+n.height+"px;"),l?(n.id=b.Utils.escapeExpression(f.id)+"-AD",n.slotIdOverride=b.Utils.escapeExpression(f.id),p+=' data-collapse-before-load="true"'):(n.id=b.Utils.escapeExpression(f.id),n.slotIdOverride=f.slotIdOverride?b.Utils.escapeExpression(f.slotIdOverride):""),n.pagePath=h,a.expads.configuration.displayAdSlots.push(n),g=l?'<div id="'+n.slotIdOverride+'" aria-label="'+m+'" class="ad '+i+'" ><div id="'+n.id+'" data-adwidth="'+n.width+'" data-adheight="'+n.height+'" style="'+o+'"'+p+"></div></div>":'<div id="'+n.id+'" aria-label="'+m+'" class="ad '+i+'" data-adwidth="'+n.width+'" data-adheight="'+n.height+'" style="'+o+'"'+p+"></div>",new b.SafeString(g)}}),b}),expads.adtoolkit=expads.adtoolkit||{},expads.adtoolkit.registerDisplayAdHelper=function(){
expads.logging&&"function"==typeof expads.logging.logMessage&&expads.logging.logMessage("Registering displayAd helpers is now done automatically. Please upgrade to the latest version of adtoolkit to stop receiving this message."),require("adtoolkit/handlebars")}}(window),function(a,b){"use strict";var c=0,d={},e=function(){},f=function(b,f,g){if(f="function"==typeof f?f:e,d.hasOwnProperty(b))f(d[b]);else if(a.dctk&&"function"==typeof a.dctk.evaluateExperiment){var h={id:b,callback:function(a){void 0===a.error?f&&(d[b]=a.value,f(a.value)):f&&(d[b]=c,f(c))}};g===!0?a.dctk.evaluateExperimentAndLog(h):a.dctk.evaluateExperiment(h)}else f&&f(c)};b.checkBucket=function(a,b){f(a,b,!1)},b.checkBucketAndExpose=function(a,b){f(a,b,!0)},b.clearCachedExperiments=function(){d={}}}(window,window.expads=window.expads||{}),function(a,b,c){"use strict";a.adScriptLoaded===!0?a.logging.logMessage("The expads library is already loaded and an attempt to load it again has been made. This is an undefined use case."):(a.adScriptLoaded=!0,"function"==typeof b&&b.amd!==c&&b("expads",[],function(){return a}))}(window.expads=window.expads||{},window.define);
//# sourceURL=expads.js