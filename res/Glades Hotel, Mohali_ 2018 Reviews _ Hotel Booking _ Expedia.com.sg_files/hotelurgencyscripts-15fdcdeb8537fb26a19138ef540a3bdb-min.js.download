require(["handlebars"],function(b){try{define("modernizr",function(){return window.Modernizr})}catch(k){}b.registerHelper("urgency_loc",function(k,f){var a=f.hash.bundle,a=void 0!==window.loc[a]?window.loc[a][k]:window.loc.messages[a+"_"+k];"function"!==typeof a&&-1<a.indexOf("{")&&(a=b.compile(a));"function"===typeof a&&(a=a(this));"fi_FI"===uitk.locale&&(a=a.replace("ebookersn","ebookersin"));return new b.SafeString(a)});b.registerHelper("urgency_if_eq",function(b,f,a){return b===f&&!a.hash.useDoubleEquals||b==f&&!0===a.hash.useDoubleEquals?a.fn(this):a.inverse(this)});b.registerHelper("block",function(k,f){var a=b.partials[k];"string"===typeof a&&(a=b.compile(a),b.partials[k]=a);return(a||f.fn)(this,{data:f.hash})});b.registerHelper("partial",function(k,f){b.registerPartial(k,f.fn)})});
(function(b,k){b||(window.urgency={});if("function"===typeof define&&define.amd)try{define("urgency/main",["jquery","uitk","dctk/dctk","urgencyCoreNotifierConfig"],function(f,a,b,l){window.urgency.main=k(f,a,b,l);return window.urgency.main})}catch(f){}else window.urgency.main=k(window.jQuery,window.uitk,window.dctk)})(window.urgency,function(b,k,f,a){function e(a,f){return"undefined"===typeof a||"undefined"===typeof a.responseStatusCode||0!==a.responseStatusCode?!1:"function"===typeof f?f(a):!0}function l(a,f,d,h,b){var e;f=f.split(",");for(var p=0;p<f.length;p++)e=f[p],a.hasOwnProperty(e)&&a[e]&&(e=a[e],"function"===typeof e.responseValidator&&e.topic&&(e.responseValidator(d)?k.publish(e.topic,{status:c.statuscodes.SUCCESS_RESPONSE,response:"function"===typeof e.responseExtractor?e.responseExtractor(d):d,src:h,requestData:b}):k.publish(e.topic,{status:c.statuscodes.ERROR_RESPONSE,response:d,src:h,requestData:b})))}function g(a,f,d,h,e){var b,c;for(b in a)a.hasOwnProperty(b)&&a[b]&&(c=a[b],c.topic&&k.publish(c.topic,{status:h,response:f,src:d,requestData:e}))}var c={statuscodes:{AJAX_FAIL:"URGENCY_AJAX_FAIL",RESPONSE_PARSE_ERROR:"URGENCY_AJAX_RESPONSE_PARSE_ERROR",ERROR_RESPONSE:"ERROR",SUCCESS_RESPONSE:"SUCCESS",INVALID_INPUT:"INVALID_INPUT"},api:{flight:"FlightTickerApi",flightEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/flight",flightTimeout:3E3,region:"RegionTickerApi",regionEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/region",regionTimeout:3E3,hotel:"HotelTickerApi",hotelEndpoint:"//urgency.expedia.com/urgencyservice/v1/ticker/hotel",hotelTimeout:15E3},utils:{objToStringArray:function(a,f,d){var h=[],b,e;if("object"===typeof a){f="string"===typeof f?f:"";d="number"===typeof d?d:50;for(b in a)a.hasOwnProperty(b)&&(e=a[b],"string"===typeof e||"number"===typeof e||"boolean"===typeof e?h.push((f+b+"\x3d"+e.toString().substring(0,d)).replace(/\.| /g,"")):null!==e&&"object"===typeof e&&(h=h.concat(this.objToStringArray(e,b+"-"))));return h}},isDisabled:function(){var m=parseInt(window.tpid,10);return a&&a.excludedTpids&&-1<a.excludedTpids.indexOf(m)},ajaxRequest:function(a,e){var d=["api\x3d"+e],h=this,g=0;if(!h.isDisabled())return a=b.extend(!0,{dataType:"json",data:{},timeout:3E3,type:"GET"},a),d=d.concat(this.objToStringArray(a,"options-")),b.ajax({cache:!1,data:a.data,dataType:a.dataType,type:a.type,url:a.url,timeout:a.timeout,beforeSend:function(){g=(new Date).getTime()}}).done(function(e,t,g){try{var k;d=d.concat(h.objToStringArray(g,"xhr-"));if("function"===typeof a.success){try{k="string"===typeof e?b.parseJSON(e):e}catch(q){f.loggingAdapter.logError(c.statuscodes.RESPONSE_PARSE_ERROR,q,d),"function"===typeof a.fail&&a.fail()}a.success(k)}}catch(q){f.loggingAdapter.logError("UrgencyErrorDone",q)}}).fail(function(e,b,t){var k=(new Date).getTime()-g;d.push("ajaxCallElapsedTime\x3d"+k);d.push("callback\x3dfail");d=d.concat(h.objToStringArray(e,"xhr-"));d.push("statusParameter\x3d"+b);d=d.concat(h.objToStringArray(t,"error-"));f.loggingAdapter.logMessage(c.statuscodes.AJAX_FAIL,d);"function"===typeof a.fail&&a.fail()})},getUTCDate:function(a){var f=new Date;a=new Date(a);return"function"!==typeof a.getMonth||isNaN(a.getMonth())?null:0<f.getTimezoneOffset()?(a.setHours(f.getHours()),a.setMinutes(f.getMinutes()),a.setSeconds(f.getSeconds()),f=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()),f.getMonth()+1+"/"+f.getDate()+"/"+f.getFullYear()):a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()},getUTCDateObject:function(a){var f=new Date;a=new Date(a);return"function"!==typeof a.getMonth||isNaN(a.getMonth())?null:0<f.getTimezoneOffset()?(a.setHours(f.getHours()),a.setMinutes(f.getMinutes()),a.setSeconds(f.getSeconds()),f=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())):a}},getRegionPriceCalendar:function(a,c){var d=this,h=["api\x3dRegionPriceCalendar"],g=function(a){return a&&a.regionTicker&&0!==a.regionTicker.length&&a.regionTicker[0].regionPriceCalendar?!0:!1},k=b.Deferred();a=b.extend(!0,{type:"regionpricecalendar",lob:"hotel"},a);h=h.concat(d.utils.objToStringArray(a,"request-"));d.utils.ajaxRequest({url:d.api.regionEndpoint,timeout:d.api.regionTimeout,dataType:"jsonp",data:a,success:function(a){var b;e(a,g)?b=d.statuscodes.SUCCESS_RESPONSE:(b=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.region+": "+d.statuscodes.ERROR_RESPONSE,h));k.resolve({status:b,response:a,src:c})},fail:function(){k.resolve({status:d.statuscodes.AJAX_FAIL,response:null,src:c})}},d.api.region);return k},getFlightUrgency:function(a,b){var d=this,h=["api\x3dFlightUrgency"],c,g=function(a){return a&&a.flightTicker&&0!==a.flightTicker.length&&"0"!==a.flightTicker[0].bookingCount?!0:!1},h=h.concat(d.utils.objToStringArray(a,"request-"));if("undefined"!==typeof a.startDate){c=d.utils.getUTCDate(a.startDate);if(null===c){k.publish("flightUrgency:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid StartDate",response:null,src:b});f.loggingAdapter.logMessage(d.api.flight+": "+d.statuscodes.INVALID_INPUT,h);return}a.startDate=c}if("undefined"!==typeof a.endDate){c=d.utils.getUTCDate(a.endDate);if(null===c){k.publish("flightUrgency:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid EndDate",response:null,src:b});f.loggingAdapter.logMessage(d.api.flight+": "+d.statuscodes.INVALID_INPUT,h);return}a.endDate=c}d.utils.ajaxRequest({url:d.api.flightEndpoint,timeout:d.api.flightTimeout,dataType:"jsonp",data:a,success:function(a){var c;e(a,g)?c=d.statuscodes.SUCCESS_RESPONSE:(c=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.flight+": "+d.statuscodes.ERROR_RESPONSE,h));k.publish("flightUrgency:arrive",{status:c,response:a,src:b})},fail:function(){k.publish("flightUrgency:arrive",{status:d.statuscodes.AJAX_FAIL,response:null,src:b})}},d.api.flight)},getHotelPriceCalendar:function(a,c){var d=this,h=["api\x3dHotelPriceCalendar"],g,r=function(a){if("undefined"===typeof a||"undefined"===typeof a.hotelTicker||0===a.hotelTicker.length)return!1;a=a.hotelTicker[0];return"undefined"===typeof a.hotelPriceCalendar||0===a.hotelPriceCalendar.length||"undefined"===typeof a.hotelPriceCalendar.datedDetails||0===a.hotelPriceCalendar.datedDetails.length?!1:!0};a=b.extend(!0,{type:"hotelpricecalendar",hpcDuration:60,lob:"hotel"},a);h=h.concat(d.utils.objToStringArray(a,"request-"));if("undefined"!==typeof a.checkInDate){g=d.utils.getUTCDate(a.checkInDate);if(null===g){k.publish("hotelPriceCalendar:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkInDate=g}if("undefined"!==typeof a.checkOutDate){g=d.utils.getUTCDate(a.checkOutDate);if(null===g){k.publish("hotelPriceCalendar:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkOutDate=g}d.utils.ajaxRequest({url:d.api.hotelEndpoint,timeout:d.api.hotelTimeout,dataType:"jsonp",data:a,success:function(a){var b;e(a,r)?b=d.statuscodes.SUCCESS_RESPONSE:(b=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.ERROR_RESPONSE,h));k.publish("hotelPriceCalendar:arrive",{status:b,response:a,src:c})},fail:function(){k.publish("hotelPriceCalendar:arrive",{status:d.statuscodes.AJAX_FAIL,response:null,src:c})}},d.api.hotel)},getRegionCompression:function(a,b){var d=this,h=["api\x3dRegionCompression"],c=function(a){return a.regionTicker&&a.regionTicker.length&&a.regionTicker[0].regionLevelData&&a.regionTicker[0].regionLevelData.compressionSummary&&void 0!==a.regionTicker[0].regionLevelData.compressionSummary.score&&!isNaN(a.regionTicker[0].regionLevelData.compressionSummary.score)},
h=h.concat(d.utils.objToStringArray(a,"request-"));d.utils.ajaxRequest({url:d.api.regionEndpoint,timeout:d.api.regionTimeout,dataType:"jsonp",data:a,success:function(a){var g;e(a,c)?g=d.statuscodes.SUCCESS_RESPONSE:(g=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.region+": "+d.statuscodes.ERROR_RESPONSE,h));k.publish("regionCompression:arrive",{status:g,response:a,src:b})},fail:function(){k.publish("regionCompression:arrive",{status:d.statuscodes.AJAX_FAIL,response:null,src:b})}},d.api.region)},getHotelPriceTrend:function(a,c){var d=this,h=["api\x3dHotelPriceTrend"],g,r=function(a){return a&&a.hotelTicker&&0!==a.hotelTicker.length&&a.hotelTicker[0].datedPriceTrend?!0:!1};a=b.extend(!0,{type:"datedhotelpricetrends"},a);h=h.concat(d.utils.objToStringArray(a,"request-"));if("undefined"!==typeof a.checkinDate){g=d.utils.getUTCDate(a.checkinDate);if(null===g){k.publish("hotelPriceTrend:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkinDate=g}if("undefined"!==typeof a.checkoutDate){g=d.utils.getUTCDate(a.checkoutDate);if(null===g){k.publish("hotelPriceTrend:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkoutDate=g}d.utils.ajaxRequest({url:d.api.hotelEndpoint,timeout:d.api.hotelTimeout,dataType:"jsonp",data:a,success:function(a){var b;e(a,r)?b=d.statuscodes.SUCCESS_RESPONSE:(b=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.ERROR_RESPONSE,h));k.publish("hotelPriceTrend:arrive",{status:b,response:a,src:c})},fail:function(){k.publish("hotelPriceTrend:arrive",{status:d.statuscodes.AJAX_FAIL,response:null,src:c})}},d.api.hotel)},getJustBookedRatePlan:function(a){var c=this,d=["api\x3dJustBookedRatePlan"],h=function(a){return"undefined"===typeof a||"undefined"===typeof a.hotelTicker||0===a.hotelTicker.length?!1:!0};a=b.extend(!0,{type:"lastbookedrateplan",lob:"hotel"},a);d=d.concat(c.utils.objToStringArray(a,"request-"));c.utils.ajaxRequest({url:c.api.hotelEndpoint,timeout:c.api.hotelTimeout,dataType:"jsonp",data:a,success:function(a){var b;e(a,h)?b=c.statuscodes.SUCCESS_RESPONSE:(b=c.statuscodes.ERROR_RESPONSE,d=d.concat(c.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(c.api.hotel+": "+c.statuscodes.ERROR_RESPONSE,d));k.publish("rrpJustBooked:arrive",{status:b,response:a})},fail:function(){k.publish("rrpJustBooked:arrive",{status:c.statuscodes.AJAX_FAIL,response:null})}},c.api.hotel)},getBulkHotelBookingInfo:function(a,c,d){var h=this,g="lastbooked,view",l=["api\x3dHotelLastBookedTime"],p=function(a){return a&&a.hotelTicker&&a.hotelTicker.length},u,v={booking:{responseValidator:function(a){return void 0!==a.hotelTicker[0].bookingsCount?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].bookingsCount}},lastbooked:{responseValidator:function(a){return void 0!==a.hotelTicker[0].lastBookedTime?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].lastBookedTime}},views:{responseValidator:function(a){return void 0!==a.hotelTicker[0].viewsCount},responseExtractor:function(a){return a.hotelTicker[0].viewsCount}}};a&&c&&(g+=",booking");a=b.extend(!0,{type:g},a);0<d&&(a=b.extend(!0,{bookingDuration:d+"h"},a));u=a.type;l=l.concat(h.utils.objToStringArray(a,"request-"));h.utils.ajaxRequest({url:h.api.hotelEndpoint,timeout:h.api.hotelTimeout,dataType:"jsonp",data:a,success:function(a){try{var d="",b,c,g=[],m=[],A=[];if(e(a,p)){for(var t,n,B=u.split(","),y=!0,z=0;z<B.length;z++)t=B[z],v.hasOwnProperty(t)&&v[t]&&(n=v[t],"function"===typeof n.responseValidator&&(y=y&&n.responseValidator(a)));if(y){d=h.statuscodes.SUCCESS_RESPONSE;b=(new Date).getTime();m=a.hotelTicker;for(c=0;c<m.length;c++)g.push({hotelId:m[c].id,elapsedTimeMillisec:b-m[c].lastBookedTime,bookingCount:m[c].bookingsCount,viewsCount:m[c].viewsCount});A=g}else d=h.statuscodes.RESPONSE_PARSE_ERROR,l=l.concat(h.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(h.api.hotel+": "+h.statuscodes.RESPONSE_PARSE_ERROR,l)}else d=h.statuscodes.ERROR_RESPONSE,l=l.concat(h.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(h.api.hotel+": "+h.statuscodes.ERROR_RESPONSE,l);k.publish("hotelBookingInfo:arrive",{status:d,response:A})}catch(C){f.loggingAdapter.logError("UrgencyErrorSuccess",C)}},fail:function(){k.publish("hotelBookingInfo:arrive",{status:h.statuscodes.AJAX_FAIL,response:null});f.loggingAdapter.logError("UrgencyErrorFail")}},h.api.hotel)},getHotelCompression:function(a,c){var d=this,h=["api\x3dHotelCompression"],g,l=function(a){return"undefined"===typeof a||"undefined"===typeof a.hotelTicker||0===a.hotelTicker.length||"undefined"===typeof a.hotelTicker[0].almostSoldOutData?!1:!0};a=b.extend(!0,{type:"almostsoldout"},a);if("undefined"!==typeof a.checkinDate){g=d.utils.getUTCDate(a.checkinDate);if(null===g){k.publish("hotelCompression:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkinDate=g}if("undefined"!==typeof a.checkoutDate){g=d.utils.getUTCDate(a.checkoutDate);if(null===g){k.publish("hotelCompression:arrive",{status:d.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:c});f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.INVALID_INPUT,h);return}a.checkoutDate=g}h=h.concat(d.utils.objToStringArray(a,"request-"));d.utils.ajaxRequest({url:d.api.hotelEndpoint,timeout:d.api.hotelTimeout,dataType:"jsonp",data:a,success:function(a){var b;e(a,l)?b=d.statuscodes.SUCCESS_RESPONSE:(b=d.statuscodes.ERROR_RESPONSE,h=h.concat(d.utils.objToStringArray(a,"response-")),f.loggingAdapter.logMessage(d.api.hotel+": "+d.statuscodes.ERROR_RESPONSE,h));k.publish("hotelCompression:arrive",{status:b,response:a,src:c})},fail:function(){k.publish("hotelCompression:arrive",{status:d.statuscodes.AJAX_FAIL,response:null,src:c})}},d.api.hotel)},getRegionUrgency:function(a,c,d){var h=this,n=["api\x3dRegionUrgency"],r,p,u=b.extend(!0,{},a),v={compression:{topic:"regionCompression:arrive",responseValidator:function(a){return a.regionTicker[0].regionLevelData.compressionSummary&&void 0!==a.regionTicker[0].regionLevelData.compressionSummary.score?!0:!1},responseExtractor:function(a){return{regionLevelData:a.regionTicker[0].regionLevelData,regionId:a.regionTicker[0].id}}},datedregionpricetrends:{topic:"regionPriceTrend:arrive",responseValidator:function(a){return a.regionTicker[0].datedPriceTrend.trend?!0:!1},responseExtractor:function(a){return{datedPriceTrend:a.regionTicker[0].datedPriceTrend,regionId:a.regionTicker[0].id}}},"default":{topic:"regionUrgency:arrive",responseValidator:function(a){return a&&a.regionTicker&&a.regionTicker.length},responseExtractor:function(a){return a.regionTicker}},regionview:{topic:"regionView:arrive",responseValidator:function(a){return void 0!==a.regionTicker[0].viewsCount?!0:!1},responseExtractor:function(a){return a.regionTicker[0].viewsCount}}},q=function(a){return a&&a.regionTicker&&a.regionTicker.length},n=n.concat(h.utils.objToStringArray(u,"request-"));p=u.type?u.type:"default";if("undefined"!==typeof u.checkinDate){r=h.utils.getUTCDate(u.checkinDate);if(null===r){!0===d?k.publish("consolidatedRegionUrgency:arrive",{status:h.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:c,requestData:a}):g(p,null,c,h.statuscodes.INVALID_INPUT+"Invalid checkInDate",a);f.loggingAdapter.logMessage(h.api.hotel+": "+h.statuscodes.INVALID_INPUT,n);return}u.checkinDate=r}if("undefined"!==typeof u.checkoutDate){r=h.utils.getUTCDate(u.checkoutDate);if(null===r){!0===d?k.publish("consolidatedRegionUrgency:arrive",{status:h.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,
src:c,requestData:a}):g(p,null,c,h.statuscodes.INVALID_INPUT+"Invalid checkOutDate",a);f.loggingAdapter.logMessage(h.api.hotel+": "+h.statuscodes.INVALID_INPUT,n);return}u.checkoutDate=r}r=h.api.regionTimeout;"undefined"!==typeof u.timeout&&(r=u.timeout);h.utils.ajaxRequest({url:h.api.regionEndpoint,timeout:r,dataType:"jsonp",data:u,success:function(b){e(b,q)?!0===d?k.publish("consolidatedRegionUrgency:arrive",{status:h.statuscodes.SUCCESS_RESPONSE,response:b,src:c,requestData:a}):l(v,p,b,c,a):(n=n.concat(h.utils.objToStringArray(b,"response-")),f.loggingAdapter.logMessage(h.api.region+": "+h.statuscodes.ERROR_RESPONSE,n),!0===d?k.publish("consolidatedRegionUrgency:arrive",{status:h.statuscodes.ERROR_RESPONSE,response:b,src:c,requestData:a}):g(p,b,c,h.statuscodes.ERROR_RESPONSE,a))},fail:function(){!0===d?k.publish("consolidatedRegionUrgency:arrive",{status:h.statuscodes.AJAX_FAIL,response:null,src:c,requestData:a}):g(p,null,c,h.statuscodes.AJAX_FAIL,a)}},h.api.region)},getHotelUrgency:function(a,c,d){var b=this,n=["api\x3dHotelUrgency"],r,p,u={"default":{topic:"hotelUrgency:arrive",responseValidator:function(a){return a&&a.hotelTicker&&a.hotelTicker.length},responseExtractor:function(a){return a.hotelTicker}},view:{topic:"hotelView:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].viewsCount?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].viewsCount}},booking:{topic:"hotelBooking:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].bookingsCount?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].bookingsCount}},lastbooked:{topic:"hotelLastBooked:arrive",responseValidator:function(a){return void 0!==a.hotelTicker[0].lastBookedTime?!0:!1},responseExtractor:function(a){return a.hotelTicker[0].lastBookedTime}}},v=function(a){return a&&a.hotelTicker&&a.hotelTicker.length},n=n.concat(b.utils.objToStringArray(a,"request-"));p=a.type?a.type:"default";if("undefined"!==typeof a.checkinDate){r=b.utils.getUTCDate(a.checkinDate);if(null===r){f.loggingAdapter.logMessage(b.api.hotel+": "+b.statuscodes.INVALID_INPUT,n);!0===d?k.publish("consolidatedHotelUrgency:arrive",{status:b.statuscodes.INVALID_INPUT+"Invalid checkInDate",response:null,src:c,requestData:a}):g(p,null,c,b.statuscodes.INVALID_INPUT+"Invalid checkInDate",a);return}a.checkinDate=r}if("undefined"!==typeof a.checkoutDate){r=b.utils.getUTCDate(a.checkoutDate);if(null===r){f.loggingAdapter.logMessage(b.api.hotel+": "+b.statuscodes.INVALID_INPUT,n);!0===d?k.publish("consolidatedHotelUrgency:arrive",{status:b.statuscodes.INVALID_INPUT+"Invalid checkOutDate",response:null,src:c,requestData:a}):g(p,null,c,b.statuscodes.INVALID_INPUT+"Invalid checkOutDate",a);return}a.checkoutDate=r}b.utils.ajaxRequest({url:b.api.hotelEndpoint,timeout:b.api.hotelTimeout,dataType:"jsonp",data:a,success:function(q){e(q,v)?!0===d?k.publish("consolidatedHotelUrgency:arrive",{status:b.statuscodes.SUCCESS_RESPONSE,response:q,src:c,requestData:a}):l(u,p,q,c,a):(n=n.concat(b.utils.objToStringArray(q,"response-")),f.loggingAdapter.logMessage(b.api.hotel+": "+b.statuscodes.ERROR_RESPONSE,n),!0===d?k.publish("consolidatedHotelUrgency:arrive",{status:b.statuscodes.ERROR_RESPONSE,response:q,src:c,requestData:a}):g(p,q,c,b.statuscodes.ERROR_RESPONSE,a))},fail:function(){!0===d?k.publish("consolidatedHotelUrgency:arrive",{status:b.statuscodes.AJAX_FAIL,src:c,requestData:a}):g(p,null,c,b.statuscodes.AJAX_FAIL,a)}},b.api.hotel)}};return c});(function(b){if("function"===typeof define&&define.amd)try{define("urgency/experimentUtils",["dctk/dctk"],function(k){window.urgency.experimentUtils=b(k);return window.urgency.experimentUtils})}catch(k){}else window.urgency.experimentUtils=b(window.dctk)})(function(b){return{evaluateExperimentAndLog:function(k,f){b.onReady(function(){b.evaluateExperimentAndLog({id:k,callback:function(a){a&&"undefined"===typeof a.error?f({bucketValue:a.value}):f({bucketValue:void 0})}})})},evaluateExperiment:function(k,f){b.onReady(function(){b.evaluateExperiment({id:k,callback:function(a){a&&"undefined"===typeof a.error?f({bucketValue:a.value}):f({bucketValue:void 0})}})})},trackImpression:function(k){b.onReady(function(){b.trackImpression(k,{},"")})},logExperiment:function(k,f){b.onReady(function(){b.logExperiment({id:k,callback:function(a){a&&"undefined"===typeof a.error?f({bucketValue:a.value}):f({bucketValue:void 0})}})})}}});(function(b){try{define("urgency/notifier","jquery handlebars uitk modernizr urgency/experimentUtils animateWithCss uitk_hb_flex_card".split(" "),function(k,f,a,e,l){return b(k,f,a,e,l)})}catch(k){}})(function(b,k,f,a,e){function l(){h=!0}function g(){h=!1}function c(a){setTimeout(function(){h?c(a):a()},p.displayDuration)}function m(a){return function(d){var c=a.find(".notification-text").text();f.utils.liveAnnounce(c,"polite");a.find(".btn-close").attr("tabindex",0).on("click",function(){p.notificationClickHandler&&p.notificationClickHandler();h=!1;t(b(this).closest(".notification"))()}).on("focus",l).on("blur",g);a.css("pointer-events","auto")[r]({opacity:p.opacity},p.fadeTime,d)}}function t(a){return function(d){a.find(".btn-close").attr("tabindex",-1);a[r]({opacity:0},p.fadeTime,function(){a[r]({"min-height":0,height:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},p.fadeTime,d)})}}function d(){try{n&&(n.remove(),n=void 0)}catch(a){}}var h=!1,n,r=a.csstransitions?"animateWithCss":"animate",p={displayDuration:5E3,initialWait:!0,fadeTime:750,template:"urgencynotifier",opacity:.95,insert:function(a){a.prependTo("body")}},u={search:"people",booking:"clock",compression:"calendar",views:"people",pricetrends:"trend",event:"calendar",view:"people",lastbooked:"clock",almostsoldout:"trend"},v={template:function(){var a=k.templates,d=p.template;if(a&&d&&a[d])return a[d].apply(a,arguments);throw Error("template not implemented");},overrideConfig:function(){v.config.apply(arguments)},config:function(a){"object"===typeof a&&b.extend(p,a);return v},notify:function(){var a,f,h,e=[];b.each([].concat.apply([],arguments).reverse(),function(a,d){var c;(c="object"!==typeof d)||(c=d,c=Array.isArray?Array.isArray(c):"[object Array]"===Object.prototype.toString.call(c));c&&(d=b.trim(d));d&&e.push(d)});p.opacity=1;b.each(e,function(a,d){"object"===typeof d&&d.hasOwnProperty("type")&&(d.icon=u[d.type])});n&&d();n=b(this.template({notifications:e}));p.insert(n);f=b(n.find(".notification").get().reverse());n.on("mouseenter",l).on("mouseleave",g);p.initialWait&&n.queue(c);n.queue(m(f.eq(0))).queue(c);a=0;for(h=f.length;a<h;a++)n.queue(m(f.eq(a+1))).queue(c).queue(t(f.eq(a)));n.queue(c).queue(t(f.eq(h-1))).queue(d)}};return v});
(function(b,k){if("function"===typeof define&&define.amd)try{define("animateWithCss",["jquery"],k)}catch(f){}else k(window.jQuery)})(this,function(b){var k=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)},f=/([A-Z])/g;b.fn.stopCssAnimation=function(){this.each(function(){var a=b(this),e=a.data("cssAnimatedProps"),k=window.getComputedStyle(this,null),g={},c;for(c in e)c=c.replace(f,"-$1").toLowerCase(),g[c]=k.getPropertyValue(c);a.css({"transition-property":"none","transition-duration":"","transition-timing-function":""});for(c in g)a.css(c,g[c]);a.data("cssAnimatedProps",null);if(e=a.data("cssTimeoutId"))clearTimeout(e),a.data("cssTimeoutId",null)})};b.fn.animateWithCss=function(a,e,l,g){var c=this,m=jQuery.speed(e,l,g);if(jQuery.isEmptyObject(a))return this.each(m.complete);e={bounce:"cubic-bezier(0.0, 0.35, .5, 1.3)",linear:"linear",swing:"ease-in-out"};m.easing=m.easing||"swing";m.easing=e[m.easing]?e[m.easing]:m.easing;k(function(){c.each(function(){var d=b(this);d.data("cssAnimatedProps",a);var c=window.getComputedStyle(this,null),e;for(e in a)e=e.replace(f,"-$1").toLowerCase(),d.css(e,c.getPropertyValue(e))});c.css({"transition-property":"all","transition-duration":m.duration+"ms","transition-timing-function":m.easing});c.css(a);var e=setTimeout(function(){c.css({"transition-property":"none","transition-duration":"","transition-timing-function":""});c.data("cssAnimatedProps",null);c.data("cssTimeoutId",null);jQuery.isFunction(m.complete)&&m.complete.apply(c)},m.duration);c.data("cssTimeoutId",e)});return c};return b});
(function(b){try{define("hotelNotifier","jquery uitk dctk/dctk urgency/main urgency/notifier hotelNotifierConfig urgency/experimentUtils".split(" "),function(k,f,a,e,l,g,c){return b(k,f,a,e,l,g,c)})}catch(k){}})(function(b,k,f,a,e,l,g){function c(a){return a&&l&&l[a]}function m(a,d){if(a.type)switch(a.type){case "booking":a.clickTrackAttr=d.experiments.omniturePrefix+"Bookings.Click";break;case "view":a.clickTrackAttr=d.experiments.omniturePrefix+"Views.Click";break;case "lastbooked":a.clickTrackAttr=d.experiments.omniturePrefix+"Lastbooked.Click"}}function t(a,d){if(a.type)switch(a.type){case "booking":a.closeTrackAttr=d.experiments.omniturePrefix+"Bookings.Close";break;case "lastbooked":a.closeTrackAttr=d.experiments.omniturePrefix+"Lastbooked.Close";break;case "view":a.closeTrackAttr=d.experiments.omniturePrefix+"Views.Close"}}function d(a,d,c){var f=b.Deferred(),e;g.evaluateExperimentAndLog(c.reduceMessaging.abacusId,function(c){if(w&&void 0!==c.bucketValue){var b=new Date,b=w.getTime()-b.getTime();e=Math.floor(b/864E5);switch(c.bucketValue){case 1:0<=e&&1>=e&&(d=[]);break;case 2:0<=e&&2>=e&&(d=[]);break;case 3:0<=e&&3>=e&&(d=[])}}f.resolve(d,a,c.bucketValue)});return f}function h(d,c,f){var e=b.Deferred();g.evaluateExperiment(d.showFlyinOnPackageHIS.abacusId,function(a){"undefined"!==typeof a.bucketValue&&(c.viewDuration=2===a.bucketValue?"2h":c.viewDuration);e.resolve()});b.when.apply(b,[e]).then(function(){a.getHotelUrgency(c,f,!0)})}function n(a,d){var c,b=0,f,e=[];if(a)for(c=0;c<a.length;c++)f=a[c],f.type!==d&&(e[b]=f,b++);return e}function r(a,d,c,f){var e=b.Deferred();g.evaluateExperimentAndLog(c,function(c){if("undefined"!==typeof c.bucketValue)switch(c.bucketValue){case 0:e.resolve(n(a,f),d);break;case 1:case 2:e.resolve(a,d,c.bucketValue)}else e.resolve(n(a,f),d)});return e}function p(a,d,c,f){var e=b.Deferred();g.evaluateExperimentAndLog(c,function(c){if("undefined"!==typeof c.bucketValue){var b=!0,h=!0;switch(c.bucketValue){case 2:h=!1;break;case 1:b=!1}if(b){var g,l;if(a)for(b=0;b<a.length;b++)if(g=a[b],g.type===f){l=g;break}"undefined"!==typeof l&&k.publish("urgency.booking.message.complete",l)}h?e.resolve(a,d,c.bucketValue):e.resolve(n(a,f),d)}else e.resolve(n(a,f),d)});return e}function u(a,d){d&&d.omniturePrefix&&a&&a.length&&0<a.length&&d.omniturePrefix&&b.each(a,function(){if(this.type)switch(this.type){case "booking":this.count&&g.trackImpression(d.omniturePrefix+"BookingCount."+this.count);break;case "view":this.count&&g.trackImpression(d.omniturePrefix+"ViewCount."+this.count);break;case "lastbooked":this.timeElapsed&&g.trackImpression(d.omniturePrefix+"Lastbooked."+this.timeElapsed)}})}function v(a){var c=q.getClientExperiments(),f={experiments:c},h=b.Deferred(),g=h;q.clientData&&q.clientData.animation&&b.extend(f,q.clientData.animation);c&&c.reduceMessaging&&c.reduceMessaging.abacusId&&(h=h.then(function(a,b){return d(b,a,c)}));c&&c.showFlyinOnPackageHIS&&c.showFlyinOnPackageHIS.abacusId&&(h=h.then(function(a,d){return r(a,d,c.showFlyinOnPackageHIS.abacusId,"view")}));c&&c.showBookingFlyinOnPackageHIS&&c.showBookingFlyinOnPackageHIS.abacusId&&(h=h.then(function(a,d){return r(a,d,c.showBookingFlyinOnPackageHIS.abacusId,"booking")}));c&&c.showMostRecentFlyinOnPackageHIS&&c.showMostRecentFlyinOnPackageHIS.abacusId&&(h=h.then(function(a,d){return r(a,d,c.showMostRecentFlyinOnPackageHIS.abacusId,"lastbooked")}));c&&c.bookingMsgInLineVsNotifier&&c.bookingMsgInLineVsNotifier.abacusId&&(h=h.then(function(a,d){return p(a,d,c.bookingMsgInLineVsNotifier.abacusId,"booking")}));h.done(function(a,d){u(a,c);e.config(d).notify(a)});g.resolve(a,f)}var q={},w,x;q.notify=function(d){var f={},e;if(c(d.clientId)){q.clientData=l[d.clientId];f.clientId=d.clientId;a:{e=q.clientData.requiredParams;var g=f,k,n;for(k=0;k<e.length;k++)if(n=e[k],d.hasOwnProperty(n)&&d[n])g[n]=d[n];else{e=!1;break a}e=!0}e&&(d.checkinDate&&(w=new Date(d.checkinDate)),f=b.extend(!0,q.clientData.requestParams,f),(new Date).getTime(),q.initializePromises(),e=q.getClientExperiments(),e.showFlyinOnPackageHIS?h(e,f,d):a.getHotelUrgency(f,d,!0))}};q.init=function(a){a&&a.clientId&&c(a.clientId)&&(q.clientData=l[a.clientId]);a.checkinDate&&(w=new Date(a.checkinDate))};q.getClientExperiments=function(){return q.clientData&&q.clientData.experiments?q.clientData.experiments:{}};q.createViewsMessage=function(a,d){var c,b,f=a.view.messageType;if(d.hotelTicker&&d.hotelTicker.length&&void 0!==d.hotelTicker[0].viewsCount&&1<d.hotelTicker[0].viewsCount){c=d.hotelTicker[0].viewsCount;switch(f){case "othersViewing":b={variant:f,type:"view",count:c},m(b,a),t(b,a)}return b}};q.createBookingsMessage=function(a,d){var c,b,f=a.booking.messageType;if(d.hotelTicker&&d.hotelTicker.length&&void 0!==d.hotelTicker[0].bookingsCount&&1<d.hotelTicker[0].bookingsCount){c=d.hotelTicker[0].bookingsCount;switch(f){case "othersBooked":b={type:"booking",variant:f,count:c,bookingDuration:48},m(b,a),t(b,a)}return b}};q.createLastBookedMessage=function(a,d){var c,b,f;f=q.clientData;b=a.lastbooked.messageType;if(d.hotelTicker&&d.hotelTicker.length&&void 0!==d.hotelTicker[0].lastBookedTime&&"NA"!==d.hotelTicker[0].lastBookedTime){switch(b){case "recentBooking":if(!f.lastbooked.lastbookedThresholdHrs)return;b=(new Date).getTime()-d.hotelTicker[0].lastBookedTime;if(0>=b||b>36E5*f.lastbooked.lastbookedThresholdHrs)return;828E5<=b?(f=Math.ceil(b/864E5),b=1<f?"recentBookingDP":"recentBookingDS"):354E4<=b?(f=Math.ceil(b/36E5),b=1<f?"recentBookingHP":"recentBookingHS"):(f=Math.ceil(b/6E4),b=1<f?"recentBookingMP":"recentBookingMS");c={type:"lastbooked",variant:b,timeElapsed:f};m(c,a);t(c,a)}return c}};q.initializePromises=function(){x=b.Deferred();require(["almostsoldouthotel"],function(a){});b.when.apply(b,[x]).then(function(a){a.length&&v(a)})};q.subscribeToRenderEvents=function(){var d,c,b,f,e,h,g=this;k.subscribe("consolidatedHotelUrgency:arrive",function(k,l){f=q.clientData;b=[];e=[];if(q.hasOwnProperty("clientData")){f.requestParams&&f.requestParams.type&&(b=f.requestParams.type.split(","));if(l.src&&l.status===a.statuscodes.SUCCESS_RESPONSE)for(d=0;d<b.length;d++)if(c=b[d],f[c]&&f[c].messageType){h=null;switch(c){case "view":h=g.createViewsMessage(f,l.response,l.src);break;case "booking":h=g.createBookingsMessage(f,l.response,l.src);break;case "lastbooked":h=g.createLastBookedMessage(f,l.response,l.src)}h&&e.push(h)}x.resolve(e)}})};q.subscribeToRenderEvents();return q});(function(){var b={excludedTpids:[7]};try{define("urgencyCoreNotifierConfig",function(){return b})}catch(k){}})();
(function(){var b={hotelinfosite:{requiredParams:["ids"],requestParams:{bookingDuration:"48h",viewDuration:"30m",type:"lastbooked,view,booking"},view:{messageType:"othersViewing"},booking:{messageType:"othersBooked"},lastbooked:{messageType:"recentBooking",lastbookedThresholdHrs:"24"},almostsoldout:{messageType:"sellout_bookNow",minScore:30,maxScore:95},animation:{displayDuration:3500,initialWait:"true",fadeTime:625},experiments:{omniturePrefix:"HOT.HIS.",bookingMsgInLineVsNotifier:{abacusId:"13905"},reduceMessaging:{abacusId:"12328"}}},hotelsdetailpage:{requiredParams:["ids"],requestParams:{bookingDuration:"48h",viewDuration:"30m",type:"lastbooked,view,booking"},view:{messageType:"othersViewing"},booking:{messageType:"othersBooked"},lastbooked:{messageType:"recentBooking",lastbookedThresholdHrs:"24"},almostsoldout:{messageType:"sellout_bookNow",minScore:30,maxScore:95},animation:{displayDuration:3500,initialWait:"true",fadeTime:625},experiments:{omniturePrefix:"HOT.HIS.",bookingMsgInLineVsNotifier:{abacusId:"13905"},reduceMessaging:{abacusId:"12328"}}},pkghis:{requiredParams:["ids"],requestParams:{bookingDuration:"48h",viewDuration:"30m",type:"lastbooked,view,booking"},view:{messageType:"othersViewing"},booking:{messageType:"othersBooked"},lastbooked:{messageType:"recentBooking",lastbookedThresholdHrs:"24"},almostsoldout:{messageType:"sellout_bookNow",minScore:30,maxScore:95},animation:{displayDuration:3500,initialWait:"true",fadeTime:625},experiments:{omniturePrefix:"HOT.PHIS.",showFlyinOnPackageHIS:{abacusId:"13617"},showBookingFlyinOnPackageHIS:{abacusId:"13735"},showMostRecentFlyinOnPackageHIS:{abacusId:"13736"}}},test:{requiredParams:["ids"],requestParams:{bookingDuration:"48h",viewDuration:"30m",type:"lastbooked,view,booking"},view:{messageType:"othersViewing"},booking:{messageType:"othersBooked"},lastbooked:{messageType:"recentBooking",lastbookedThresholdHrs:"24"},animation:{displayDuration:3500,initialWait:"true",fadeTime:625},experiments:{omniturePrefix:"URG.TEST."}}};try{define("hotelNotifierConfig",function(){return b})}catch(k){}})();require(["handlebars"],function(b){var k=b.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(b,a,e,k,g){var c;return(null!=(c=(e.partial||a&&a.partial||e.helperMissing).call(null!=a?a:{},"text",{name:"partial",hash:{},fn:b.program(1,g,0),inverse:b.noop,data:g}))?c:"")+"\n"+(null!=(c=b.invokePartial(k.notifier_base,a,{name:"notifier_base",data:g,helpers:e,partials:k,decorators:b.decorators}))?c:"")},1:function(b,a,e,k,g){var c;return(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.type:a,"view",{name:"urgency_if_eq",hash:{},fn:b.program(2,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.type:a,"booking",{name:"urgency_if_eq",hash:{},fn:b.program(2,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.type:a,"lastbooked",{name:"urgency_if_eq",hash:{},fn:b.program(2,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.type:a,"almostsoldout",{name:"urgency_if_eq",hash:{},fn:b.program(4,g,0),inverse:b.noop,data:g}))?c:"")},2:function(b,a,e,k,g){return"        "+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},null!=a?a.variant:a,{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+"\n"},4:function(b,a,e,k,g){return'        \x3ch2 class\x3d"remove-margin"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"percentBooked",{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+"\x3c/h2\x3e\n        \x3cdiv\x3e"+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},null!=a?a.variant:a,{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+"\x3c/div\x3e\n"},usePartial:!0,useData:!0});b.templates=b.templates||{};b.templates.urgencynotifier=k;b.partials=b.partials||{};b.partials.urgencynotifier=k});require(["handlebars"],function(b){var k=b.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(b,a,e,k,g){var c;return'\x3cdiv class\x3d"notifier"\x3e\n'+(null!=(c=e.each.call(null!=a?a:{},null!=a?a.notifications:a,{name:"each",hash:{},fn:b.program(1,g,0),inverse:b.noop,data:g}))?c:"")+"\x3c/div\x3e"},1:function(b,a,e,k,g){var c;return'        \x3cdiv class\x3d"notification uitk-grid all-col-1-1" '+(null!=(c=e["if"].call(null!=a?a:{},null!=a?a.clickTrackAttr:a,{name:"if",hash:{},fn:b.program(2,g,0),inverse:b.noop,data:g}))?c:"")+"\x3e\n"+(null!=(c=(e.uitk_flexCard||a&&a.uitk_flexCard||e.helperMissing).call(null!=a?a:{},{name:"uitk_flexCard",hash:{format:"list"},fn:b.program(4,g,0),inverse:b.noop,data:g}))?c:"")+"        \x3c/div\x3e\n"},2:function(b,a,e,k,g){var c;return"data-track\x3d"+b.escapeExpression((c=null!=(c=e.clickTrackAttr||(null!=a?a.clickTrackAttr:a))?c:e.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"clickTrackAttr",hash:{},data:g}):c))},4:function(b,a,e,k,g){var c;return(null!=(c=e["if"].call(null!=a?a:{},null!=a?a.icon:a,{name:"if",hash:{},fn:b.program(5,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.uitk_flexCardContent||a&&a.uitk_flexCardContent||e.helperMissing).call(null!=a?a:{},{name:"uitk_flexCardContent",hash:{contentType:"primary"},fn:b.program(8,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.uitk_flexCardContent||a&&a.uitk_flexCardContent||e.helperMissing).call(null!=a?a:{},{name:"uitk_flexCardContent",hash:{contentType:"secondary"},fn:b.program(11,g,0),inverse:b.noop,data:g}))?c:"")},5:function(b,a,e,k,g){var c;return null!=(c=(e.uitk_flexCardContent||a&&a.uitk_flexCardContent||e.helperMissing).call(null!=a?a:{},{name:"uitk_flexCardContent",hash:{contentType:"figure"},fn:b.program(6,g,0),inverse:b.noop,data:g}))?c:""},6:function(b,a,e,k,g){var c;return'                        \x3cdiv class\x3d"icon '+b.escapeExpression((c=null!=(c=e.icon||(null!=a?a.icon:a))?c:e.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"icon",hash:{},data:g}):c))+'"\x3e\x3c/div\x3e\n'},8:function(b,a,e,k,g){var c;return null!=(c=(e.block||a&&a.block||e.helperMissing).call(null!=a?a:{},"text",{name:"block",hash:{},fn:b.program(9,g,0),inverse:b.noop,data:g}))?c:""},9:function(b,a,e,k,g){var c;return"                        "+(null!=(c=b.lambda(a,a))?c:"")+"\n"},11:function(b,a,e,k,g){var c,m;return'                    \x3cbutton type\x3d"button" class\x3d"btn-close btn-primary" tabindex\x3d"-1" '+(null!=(c=e["if"].call(null!=a?a:{},null!=a?a.closeTrackAttr:a,{name:"if",hash:{},fn:b.program(12,g,0),inverse:b.noop,data:g}))?c:"")+'\x3e\n                        \x3cspan class\x3d"icon icon-close" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n                        \x3cspan class\x3d"alt"\x3e'+b.escapeExpression((m=null!=(m=e.closeThisMessage||(null!=a?a.closeThisMessage:a))?m:e.helperMissing,"function"===typeof m?m.call(null!=a?a:{},{name:"closeThisMessage",hash:{},data:g}):m))+"\x3c/span\x3e\n                    \x3c/button\x3e\n"},12:function(b,a,e,k,g){var c;return"data-track\x3d"+b.escapeExpression((c=null!=(c=e.closeTrackAttr||(null!=a?a.closeTrackAttr:a))?c:e.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"closeTrackAttr",hash:{},data:g}):c))},useData:!0});b.templates=b.templates||{};b.templates.notifier_base=k;b.partials=b.partials||{};b.partials.notifier_base=k});
(function(){var b={hotelinfosite:{requiredParams:["ids","checkinDate","checkoutDate"],requestParams:{type:"almostsoldout"},messageType:"price_hike",minCompressionScore:60,maxCompressionScore:95,experiments:{optimizeCompression:{abacusId:"12333"}}},hotelsdetailpage:{requiredParams:["ids","checkinDate","checkoutDate"],requestParams:{type:"almostsoldout"},messageType:"price_hike",minCompressionScore:60,maxCompressionScore:95,experiments:{optimizeCompression:{abacusId:"12333"}}}};try{define("almostsoldouthotelConfig",function(){return b})}catch(k){}})();require(["handlebars"],function(b){var k=b.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(b,a,e,k,g){var c,m;return'\x3cdiv class\x3d"compressionAlert graphic" id\x3d"hotelCompressionAlert"\x3e\n    \x3cdiv class\x3d"scorebox"\x3e\n        '+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"hotelbooked",{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+'\n    \x3c/div\x3e\n    \x3cdiv class\x3d"alert alert-info"\x3e\n        \x3ch5 class\x3d"alert-message" role\x3d"alert"\x3e\n'+(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.message:a,"popular_dates",{name:"urgency_if_eq",hash:{},fn:b.program(1,g,0),inverse:b.noop,data:g}))?c:"")+(null!=(c=(e.urgency_if_eq||a&&a.urgency_if_eq||e.helperMissing).call(null!=a?a:{},null!=a?a.message:a,"price_hike",{name:"urgency_if_eq",hash:{},fn:b.program(3,g,0),inverse:b.noop,data:g}))?c:"")+'        \x3c/h5\x3e\n        \x3cbutton type\x3d"button" data-control\x3d"remove" data-track\x3d'+b.escapeExpression((m=null!=(m=e.closeTrack||(null!=a?a.closeTrack:a))?m:e.helperMissing,"function"===typeof m?m.call(null!=a?a:{},{name:"closeTrack",hash:{},data:g}):m))+' data-target-id\x3d"hotelCompressionAlert" class\x3d"btn-primary btn-close"\x3e\n            \x3cspan class\x3d"icon icon-close" aria-hidden\x3d"true"\x3e\x3c/span\x3e\x3cspan class\x3d"alt"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"closeThisMessage",{name:"urgency_loc",hash:{bundle:"urgency-messages_common"},data:g}))+"\x3c/span\x3e\n        \x3c/button\x3e\n    \x3c/div\x3e\n\x3c/div\x3e"},1:function(b,a,e,k,g){return'                \x3cspan class\x3d"title"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"popular_dates",{name:"urgency_loc",hash:{bundle:"urgency-messages_common"},data:g}))+'\x3c/span\x3e\n                \x3cspan class\x3d"linewrap"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"book_soon",{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+"\x3c/span\x3e\n"},3:function(b,a,e,k,g){return'                \x3cspan class\x3d"title"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"sellout",{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+'\x3c/span\x3e\n                \x3cspan class\x3d"linewrap"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},"price_hike",{name:"urgency_loc",hash:{bundle:"urgency-messages_hotel"},data:g}))+"\x3c/span\x3e\n"},useData:!0});b.templates=b.templates||{};b.templates.almostsoldoutalert_graphic=k;b.partials=b.partials||{};b.partials.almostsoldoutalert_graphic=k});(function(b){try{define("almostsoldouthotel","jquery uitk dctk/dctk urgency/main almostsoldouthotelConfig handlebars urgency/experimentUtils".split(" "),function(k,f,a,e,l,g,c){return b(k,f,a,e,l,g,c)})}catch(k){}})(function(b,k,f,a,e,l,g){function c(a){return a&&e&&e[a]}function m(a){var b=t.clientData.minCompressionScore||60,c=t.clientData.maxCompressionScore||95;return a.hotelTicker&&a.hotelTicker.length&&a.hotelTicker[0].almostSoldOutData&&a.hotelTicker[0].almostSoldOutData.numRoomsLeftConfidence&&"NA"!==a.hotelTicker[0].almostSoldOutData.numRoomsLeftConfidence&&a.hotelTicker[0].almostSoldOutData.score&&a.hotelTicker[0].almostSoldOutData.score>b&&a.hotelTicker[0].almostSoldOutData.score<c}var t={init:function(a){a&&a.clientId&&c(a.clientId)&&(t.clientData=e[a.clientId])},showAlert:function(d){var h={},f;f=d?!(d.hasOwnProperty("ids")&&d.hasOwnProperty("checkinDate")&&d.hasOwnProperty("checkoutDate")&&d.hasOwnProperty("clientcontainer")&&d.hasOwnProperty("clientId"))||d.clientcontainer instanceof b&&0===d.clientcontainer.length?!1:!0:!1;if(!f)console.log("invalid request");else if(c(d.clientId)){t.clientData=e[d.clientId];h.clientId=d.clientId;a:{f=t.clientData.requiredParams;var g=h,k,l;for(k=0;k<f.length;k++)if(l=f[k],d.hasOwnProperty(l)&&d[l])g[l]=d[l];else{f=!1;break a}f=!0}f&&(h=b.extend(!0,t.clientData.requestParams,h),a.getHotelCompression(h,d))}},subscribeToRenderEvents:function(){k.subscribe("hotelCompression:arrive",function(d,c){var e,g,k,u=b.Deferred();if(t.hasOwnProperty("clientData")&&c&&c.status&&c.status===a.statuscodes.SUCCESS_RESPONSE){if(!c.src||!c.src.clientcontainer)return f.loggingAdapter.logMessage(a.api.hotel+": "+self.statuscodes.INVALID_INPUT,"No clientcontainer provided"),!1;m(c.response)&&(e=c.response.hotelTicker[0].almostSoldOutData,g=t.clientData.messageType||"price_hike",u.done(function(a){a&&(k=l.templates.almostsoldoutalert_graphic({score:a.score,message:g,closeTrack:"HOT.HIS.Compression.Close"}),c.src.clientcontainer.append(k))}),u.resolve(e))}})}};b(function(){t.subscribeToRenderEvents()});return t});(function(){var b={hotelinfosite:{requiredParams:["ids","checkinDate","checkoutDate"],requestParams:{type:"datedhotelpricetrends"}},hotelsdetailpage:{requiredParams:["ids","checkinDate","checkoutDate"],requestParams:{type:"datedhotelpricetrends"}}};try{define("hotelpricetrendConfig",function(){return b})}catch(k){}})();require(["handlebars"],function(b){var k=b.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(b,a,e,k,g){var c;return'\x3cdiv class\x3d"alert alert-info " id\x3d"priceTrendAlert"\x3e\n    \x3cspan class\x3d"icon icon-deltadot '+b.escapeExpression((c=null!=(c=e.variant||(null!=a?a.variant:a))?c:e.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"variant",hash:{},data:g}):c))+'" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n    \x3ch5 class\x3d"alert-message" role\x3d"alert"\x3e'+b.escapeExpression((e.urgency_loc||a&&a.urgency_loc||e.helperMissing).call(null!=a?a:{},null!=a?a.variant:a,{name:"urgency_loc",hash:{bundle:"urgency-messages_common"},data:g}))+"\x3c/h5\x3e\n\x3c/div\x3e"},useData:!0});b.templates=b.templates||{};b.templates.priceTrendAlert=k;b.partials=b.partials||{};b.partials.priceTrendAlert=k});
(function(b){try{define("hotelpricetrend","jquery uitk dctk/dctk urgency/main hotelpricetrendConfig handlebars".split(" "),function(k,f,a,e,l,g){return b(k,f,a,e,l,g)})}catch(k){}})(function(b,k,f,a,e,l){function g(a){return a&&e&&e[a]}var c={},m=b("#priceTrendContainer");c.init=function(a){a&&a.clientId&&g(a.clientId)&&(c.clientData=e[a.clientId])};c.showAlert=function(f){var d={},h;h=f?f.hasOwnProperty("ids")&&f.hasOwnProperty("checkinDate")&&f.hasOwnProperty("checkoutDate")&&f.hasOwnProperty("clientId")&&0!==m.length?!0:!1:!1;if(!h)console.log("invalid request");else if(g(f.clientId)){c.clientData=e[f.clientId];d.clientId=f.clientId;a:{h=c.clientData.requiredParams;var k=d,l,p;for(l=0;l<h.length;l++)if(p=h[l],f.hasOwnProperty(p)&&f[p])k[p]=f[p];else{h=!1;break a}h=!0}h&&(d=b.extend(!0,c.clientData.requestParams,d),a.getHotelPriceTrend(d,f))}};c.subscribeToRenderEvents=function(){k.subscribe("hotelPriceTrend:arrive",function(b,c){var e;if(e=c.status===a.statuscodes.SUCCESS_RESPONSE&&c.response)e=c.response,e=(e.hotelTicker&&e.hotelTicker.length&&e.hotelTicker[0].datedPriceTrend&&e.hotelTicker[0].datedPriceTrend.trend&&e.hotelTicker[0].datedPriceTrend.days&&("HIGHEST"===e.hotelTicker[0].datedPriceTrend.trend||"LOWEST"===e.hotelTicker[0].datedPriceTrend.trend)&&1<e.hotelTicker[0].datedPriceTrend.days?!0:!1)&&l.templates&&"function"===typeof l.templates.priceTrendAlert;e&&(e=c.response.hotelTicker[0].datedPriceTrend,e=l.templates.priceTrendAlert({trendDays:e.days,trend:e.trend,variant:"HIGHEST"===e.trend?"priceTrendHigh":"priceTrendLow"}),m.empty().append(e))})};b(function(){c.subscribeToRenderEvents()});return c});
//# sourceMappingURL=hotelurgencyscripts.js.map